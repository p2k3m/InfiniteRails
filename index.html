<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Infinite Dimension ¬∑ Portals Reimagined</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg" />
  </head>
  <body data-color-mode="dark" data-color-mode-preference="auto">
    <div class="background-sheen"></div>
    <div class="manu-logo" id="logo" aria-hidden="false" data-hint="Created by Manu">
      <svg
        class="manu-logo__glyph"
        viewBox="0 0 48 48"
        role="img"
        aria-labelledby="logoTitle logoDesc"
      >
        <title id="logoTitle">Manu voxel monogram</title>
        <desc id="logoDesc">Stylised glowing M emblem rendered with a blue gradient.</desc>
        <defs>
          <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#00aaff"></stop>
            <stop offset="100%" stop-color="#0044ff"></stop>
          </linearGradient>
          <filter id="voxelGlow" x="-40%" y="-40%" width="180%" height="180%">
            <feGaussianBlur in="SourceGraphic" stdDeviation="2.6" result="blur"></feGaussianBlur>
            <feMerge>
              <feMergeNode in="blur"></feMergeNode>
              <feMergeNode in="SourceGraphic"></feMergeNode>
            </feMerge>
          </filter>
        </defs>
        <rect x="4" y="4" width="40" height="40" rx="10" fill="url(#grad)" filter="url(#voxelGlow)"></rect>
        <path
          d="M12 32V16l6 8l6-8v16"
          fill="none"
          stroke="rgba(255, 255, 255, 0.88)"
          stroke-width="4"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
        <path
          d="M24 16l6 8l6-8v16"
          fill="none"
          stroke="rgba(180, 220, 255, 0.82)"
          stroke-width="4"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
        <text
          x="24"
          y="32"
          text-anchor="middle"
          fill="white"
          font-family="'Chakra Petch', 'Exo 2', sans-serif"
          font-size="16"
          font-weight="700"
        >
          M
        </text>
      </svg>
      <span class="manu-logo__label" aria-hidden="true">Created by Manu</span>
      <span class="sr-only">Created by Manu</span>
    </div>
    <div class="score-sync-warning" id="scoreSyncWarning" role="status" aria-live="polite" hidden>
      <span class="score-sync-warning__icon" aria-hidden="true">‚ö†Ô∏è</span>
      <span class="score-sync-warning__message">
        Leaderboard offline ‚Äî runs stored locally until connection returns.
      </span>
    </div>
    <main class="main-layout">
      <aside
        class="objectives-panel"
        id="objectivesPanel"
        aria-label="Mission objectives"
        data-hint="Review mission objectives and lore."
      >
        <div class="logo-area objectives-panel__brand">
          <img src="assets/infinite-dimension-logo.svg" alt="Infinite Dimension logo" class="brand-logo" />
          <div class="brand-copy">
            <h1>Infinite Dimension</h1>
            <span class="subtitle">Portals Reimagined</span>
          </div>
        </div>
        <section class="objectives-panel__section" aria-live="polite">
          <header class="objectives-panel__header objectives-panel__header--alert">
            <h2>Browser Extensions</h2>
          </header>
          <div
            class="objectives-panel__card objectives-panel__card--alert"
            role="note"
            aria-label="Browser extension compatibility warning"
          >
            <h3 class="notice-card__title">Allow the experience to load</h3>
            <p>
              Ad blockers and privacy filters can block the renderer‚Äôs scripts, models, audio queues,
              or sign-in overlays. If the HUD appears without the world‚Äîor if assets never load‚Äîadd an
              exception for Infinite Dimension or temporarily disable those extensions before
              refreshing.
            </p>
            <p class="notice-card__tip">
              Most blockers expose an ‚Äúallow this site‚Äù toggle in their toolbar menu. Once paused,
              reload the page to restore the full sandbox.
            </p>
          </div>
        </section>
        <section class="objectives-panel__section" aria-live="polite">
          <header class="objectives-panel__header objectives-panel__header--primer">
            <h2>How to Play</h2>
          </header>
          <div
            class="objectives-panel__card objectives-panel__card--primer"
            data-hint="Follow these steps to stabilise the portal network."
          >
            <ul class="primer-list">
              <li class="primer-list__item">
                <span class="primer-list__icon" aria-hidden="true">‚öíÔ∏è</span>
                <div class="primer-list__content">
                  <h3>Gather with purpose</h3>
                  <p>
                    Face a resource tile and press
                    <strong data-keybinding-copy="harvest-jump">Space</strong>,
                    <strong data-keybinding-copy="harvest-interact">F</strong>, or tap to harvest wood, stone, and ore.
                    Watch the hint feed for biome-specific dangers.
                  </p>
                </div>
              </li>
              <li class="primer-list__item">
                <span class="primer-list__icon" aria-hidden="true">üß∞</span>
                <div class="primer-list__content">
                  <h3>Craft the essentials</h3>
                  <p>
                    Launch the <strong>hammer icon</strong> to open crafting. Build a Stone Pickaxe first to unlock
                    tougher recipes, then prepare blocks for your escape frame.
                  </p>
                </div>
              </li>
              <li class="primer-list__item">
                <span class="primer-list__icon" aria-hidden="true">üåÄ</span>
                <div class="primer-list__content">
                  <h3>Build the exit portal</h3>
                  <p>
                    Place blocks with <strong data-keybinding-copy="place-block">Q</strong> to form a
                    <strong>4√ó3 frame</strong>, ignite it with <strong data-keybinding-copy="ignite-portal">R</strong>,
                    and cross through before nightfall drains your hearts.
                  </p>
                </div>
              </li>
            </ul>
          </div>
        </section>
        <section class="objectives-panel__section" aria-live="polite">
          <header class="objectives-panel__header">
            <h2>Current Objectives</h2>
          </header>
          <div class="objectives-panel__card" data-hint="Current dimension intel and environmental traits.">
            <div class="overlay-panel" id="dimensionInfo" data-hint="Dimension briefing updates in real-time."></div>
          </div>
        </section>
        <section class="objectives-panel__section objectives-panel__section--hint" aria-live="polite">
          <header class="objectives-panel__header objectives-panel__header--hint">
            <h2>Guidance</h2>
          </header>
          <div class="objectives-panel__card objectives-panel__card--hint" data-hint="Helpful reminders for surviving each biome.">
            <div
              class="player-hint"
              id="playerHint"
              role="status"
              aria-live="assertive"
              tabindex="0"
              data-hint="Priority hint feed; focus to repeat guidance."
            ></div>
          </div>
        </section>
      </aside>
      <section class="primary-panel" data-hint="Central viewport where you explore each dimension.">
        <canvas
          id="gameCanvas"
          width="960"
          height="600"
          aria-label="Game world"
          data-hint="Navigate and interact with the voxel realm here."
        ></canvas>
        <div
          class="developer-stats"
          id="developerStatsPanel"
          role="status"
          aria-live="polite"
          hidden
        >
          <p class="developer-stats__title">Developer Stats</p>
          <dl class="developer-stats__metrics">
            <div class="developer-stats__metric">
              <dt>FPS</dt>
              <dd data-stat="fps">‚Äî</dd>
            </div>
            <div class="developer-stats__metric">
              <dt>Models</dt>
              <dd data-stat="models">‚Äî</dd>
            </div>
            <div class="developer-stats__metric">
              <dt>Textures</dt>
              <dd data-stat="textures">‚Äî</dd>
            </div>
            <div class="developer-stats__metric">
              <dt>Audio</dt>
              <dd data-stat="audio">‚Äî</dd>
            </div>
          </dl>
        </div>
        <div class="game-briefing" id="gameBriefing" role="region" aria-live="polite" hidden>
          <div class="game-briefing__content">
            <div class="game-briefing__header">
              <p class="game-briefing__eyebrow">Mission Briefing</p>
              <h2 class="game-briefing__title">Secure the Origin Rail</h2>
            </div>
            <ol class="game-briefing__steps" id="gameBriefingSteps">
              <li>Collect wood and stone with Space or a tap while facing a resource tile.</li>
              <li>Open the crafting terminal from the hammer icon and assemble a Stone Pickaxe.</li>
              <li>Build a 4√ó3 portal frame with Q, then ignite it with R to escape the biome.</li>
            </ol>
            <div class="game-briefing__controls" aria-label="Core controls">
              <div>
                <span class="game-briefing__label">Movement</span>
                <span class="game-briefing__keys" id="briefingMovementKeys">W ¬∑ A ¬∑ S ¬∑ D</span>
              </div>
              <div>
                <span class="game-briefing__label">Gather / Use</span>
                <span class="game-briefing__keys" id="briefingGatherKeys">Space ¬∑ Click ¬∑ F</span>
              </div>
              <div>
                <span class="game-briefing__label">Place / Portal</span>
                <span class="game-briefing__keys" id="briefingPlaceKeys">Q ¬∑ R</span>
              </div>
            </div>
            <button type="button" class="game-briefing__dismiss" id="dismissBriefing">Begin the run</button>
          </div>
        </div>
        <div
          class="first-run-tutorial"
          id="firstRunTutorial"
          role="dialog"
          aria-modal="true"
          aria-labelledby="firstRunTutorialTitle"
          hidden
        >
          <div class="first-run-tutorial__backdrop" id="firstRunTutorialBackdrop" aria-hidden="true"></div>
          <div class="first-run-tutorial__panel" role="document">
            <button
              type="button"
              class="first-run-tutorial__close"
              id="firstRunTutorialClose"
              aria-label="Dismiss tutorial"
            >
              <span aria-hidden="true">√ó</span>
            </button>
            <p class="first-run-tutorial__eyebrow">First Run Briefing</p>
            <h2 class="first-run-tutorial__title" id="firstRunTutorialTitle">Welcome to Infinite Rails</h2>
            <p class="first-run-tutorial__summary">
              Every expedition begins on a fractured rail. Master the basics, then watch for new systems coming online as the
              network stabilises.
            </p>
            <ul class="first-run-tutorial__list" aria-label="Tutorial steps">
              <li>
                <span class="first-run-tutorial__step-label">Move &amp; Look</span>
                <span class="first-run-tutorial__step-detail" id="firstRunTutorialMoveDetail"
                  >Use <strong>WASD</strong> or swipe to travel, and drag or move the mouse to survey the realm.</span
                >
              </li>
              <li>
                <span class="first-run-tutorial__step-label">Gather &amp; Interact</span>
                <span class="first-run-tutorial__step-detail" id="firstRunTutorialGatherDetail">
                  Face a resource tile, then press <strong>Space</strong>, <strong>Click</strong>, or <strong>F</strong> to harvest, open chests, and trigger switches.
                </span>
              </li>
              <li>
                <span class="first-run-tutorial__step-label">Craft &amp; Build</span>
                <span class="first-run-tutorial__step-detail" id="firstRunTutorialCraftDetail">
                  Tap the <strong>hammer</strong> icon or press <strong>E</strong> to craft. Place blocks with <strong>Q</strong> and ignite portals with <strong>R</strong> to stabilise the exit.
                </span>
              </li>
              <li>
                <span class="first-run-tutorial__step-label">Coming Online</span>
                <span class="first-run-tutorial__step-detail">
                  Live score sync, co-op expeditions, and seasonal rails are rolling out soon‚Äîwatch the log for system updates.
                </span>
              </li>
            </ul>
            <p class="first-run-tutorial__note" id="firstRunTutorialNote">
              Need a refresher later? Press <strong>?</strong> or tap the <strong>Tutorial</strong> button in the HUD.
            </p>
            <div class="first-run-tutorial__actions">
              <button type="button" class="primary" id="firstRunTutorialBegin">Let's explore</button>
            </div>
          </div>
        </div>
        <div class="hud-layer" id="gameHud">
        <div
          class="hud-alert"
          id="hudAlert"
          role="alert"
          aria-live="assertive"
          hidden
        >
          <span class="hud-alert__icon" aria-hidden="true"></span>
          <div class="hud-alert__content">
            <span class="hud-alert__title" id="hudAlertTitle"></span>
            <span class="hud-alert__message" id="hudAlertMessage"></span>
          </div>
        </div>
        <div
          class="lost-guidance-banner"
          id="lostGuidanceBanner"
          role="region"
          aria-live="polite"
          aria-labelledby="lostGuidanceTitle"
          hidden
        >
          <div class="lost-guidance-banner__body">
            <div class="lost-guidance-banner__header">
              <span class="lost-guidance-banner__icon" aria-hidden="true">üß≠</span>
              <div class="lost-guidance-banner__heading">
                <p class="lost-guidance-banner__eyebrow">Need a plan?</p>
                <h2 class="lost-guidance-banner__title" id="lostGuidanceTitle">
                  Here's how to get back on track
                </h2>
              </div>
            </div>
            <ul class="lost-guidance-banner__steps" aria-label="Getting started checklist">
              <li class="lost-guidance-banner__step">
                <span class="lost-guidance-banner__step-label">Move</span>
                <span class="lost-guidance-banner__step-detail">
                  Use <strong id="lostGuidanceMoveKeys">W ¬∑ A ¬∑ S ¬∑ D</strong> or drag to explore the rail.
                </span>
              </li>
              <li class="lost-guidance-banner__step">
                <span class="lost-guidance-banner__step-label">Gather &amp; craft</span>
                <span class="lost-guidance-banner__step-detail">
                  Collect wood and stone with <strong id="lostGuidanceGatherKeys">Space ¬∑ Click ¬∑ F</strong>, then open crafting
                  (<strong id="lostGuidanceCraftKey">E</strong>) to forge a Stone Pickaxe.
                </span>
              </li>
              <li class="lost-guidance-banner__step">
                <span class="lost-guidance-banner__step-label">Portal goal</span>
                <span class="lost-guidance-banner__step-detail">
                  Place blocks and ignite the frame with <strong id="lostGuidancePortalKeys">Q ¬∑ R</strong> to open your escape
                  portal.
                </span>
              </li>
            </ul>
            <button type="button" class="lost-guidance-banner__dismiss" id="lostGuidanceDismiss">
              Resume the run
            </button>
          </div>
        </div>
        <div class="hud-layer__corner hud-layer__corner--top-left">
          <div class="hud-card hud-card--status" data-hint="Monitor vitals and access crafting tools.">
            <div class="hud-status" aria-label="Player vitals" role="group" data-hint="Health, oxygen, and time remainers.">
              <div class="status-item hearts" id="hearts" data-hint="Current health hearts."></div>
              <div class="status-item bubbles" id="bubbles" data-hint="Breath remaining while underwater."></div>
                <div class="status-item time" id="timeOfDay" data-hint="Local dimension time."></div>
              </div>
              <button
                type="button"
                class="craft-launcher"
                id="openCrafting"
                aria-label="Open crafting interface"
                aria-haspopup="dialog"
                aria-controls="craftingModal"
                data-hint="Launch the portable crafting interface."
              >
                <span aria-hidden="true" class="craft-launcher__icon"></span>
                <span class="sr-only">Open crafting interface</span>
              </button>
            </div>
          </div>
          <div class="hud-layer__corner hud-layer__corner--top-right">
            <div
              class="score-overlay"
              id="scorePanel"
              role="status"
              aria-live="polite"
              data-hint="Real-time summary of your score and bonuses."
            >
              <span class="score-overlay__label">Score</span>
              <span class="score-overlay__value" id="scoreTotal">0</span>
              <ul class="score-overlay__breakdown">
                <li>
                  <span class="score-overlay__metric-label">Crafting</span>
                  <span class="score-overlay__metric-value" id="scoreRecipes">0 crafts (+0 pts)</span>
                </li>
                <li>
                  <span class="score-overlay__metric-label">Dimensions</span>
                  <span class="score-overlay__metric-value" id="scoreDimensions">1 (+0 pts)</span>
                </li>
                <li>
                  <span class="score-overlay__metric-label">Portals</span>
                  <span class="score-overlay__metric-value" id="scorePortals">0 events (+0 pts)</span>
                </li>
                <li>
                  <span class="score-overlay__metric-label">Combat</span>
                  <span class="score-overlay__metric-value" id="scoreCombat">0 victories (+0 pts)</span>
                </li>
                <li>
                  <span class="score-overlay__metric-label">Loot</span>
                  <span class="score-overlay__metric-value" id="scoreLoot">0 finds (+0 pts)</span>
                </li>
              </ul>
            </div>
            <div class="hud-card hud-card--actions" data-hint="Quick actions for leaderboards, guides, and settings.">
              <div class="hud-actions" role="group" aria-label="HUD controls">
                <button
                  type="button"
                  id="openLeaderboard"
                  class="leaderboard-toggle"
                  aria-haspopup="dialog"
                  aria-controls="leaderboardModal"
                  aria-expanded="false"
                  data-hint="View the multiverse leaderboard."
                >
                  <span class="leaderboard-toggle__icon" aria-hidden="true">
                    <span></span>
                    <span></span>
                    <span></span>
                  </span>
                  <span class="leaderboard-toggle__label">Leaderboard</span>
                </button>
                <button type="button" id="openTutorial" class="ghost" data-hint="Reopen the tutorial overlay for control reminders.">Tutorial</button>
                <button type="button" id="openGuide" class="ghost" data-hint="Open the survival guide.">Game Guide</button>
                <button
                  type="button"
                  id="openSettings"
                  class="ghost settings-toggle"
                  aria-haspopup="dialog"
                  aria-controls="settingsModal"
                  aria-expanded="false"
                  data-hint="Configure audio, visuals, and difficulty."
                >
                  <span class="settings-toggle__icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
                      <path
                        fill="currentColor"
                        d="M12 8.25a3.75 3.75 0 1 0 0 7.5a3.75 3.75 0 0 0 0-7.5Zm9.35 3.19l-1.57-.91a7.53 7.53 0 0 0-.41-1.02l.57-1.77a1 1 0 0 0-.23-1.04l-1.48-1.5a1 1 0 0 0-1.04-.23l-1.78.57c-.33-.14-.68-.27-1.03-.38L13.6 2.7a1 1 0 0 0-.97-.7h-2.26a1 1 0 0 0-.97.7l-.51 1.57c-.36.11-.7.24-1.04.38l-1.78-.57a1 1 0 0 0-1.04.23L3.55 5.51a1 1 0 0 0-.23 1.04l.57 1.77c-.15.34-.28.68-.4 1.03l-1.56.9A1 1 0 0 0 1.58 11v2a1 1 0 0 0 .55.9l1.57.91c.11.35.25.7.4 1.03l-.57 1.77a1 1 0 0 0 .23 1.04l1.48 1.5a1 1 0 0 0 1.04.23l1.78-.57c.33.14.68.27 1.03.38l.51 1.58a1 1 0 0 0 .97.7h2.26a1 1 0 0 0 .97-.7l.51-1.58c.35-.11.7-.24 1.03-.38l1.78.57a1 1 0 0 0 1.04-.23l1.48-1.5a1 1 0 0 0 .23-1.04l-.57-1.77c.15-.34.29-.68.4-1.03l1.57-.91a1 1 0 0 0 .55-.9v-2a1 1 0 0 0-.55-.9ZM20 12.74l-1.42.82a1 1 0 0 0-.48.62a6.04 6.04 0 0 1-.77 1.85a1 1 0 0 0-.05.83l.5 1.54l-.7.71l-1.55-.5a1 1 0 0 0-.84.1a6.2 6.2 0 0 1-1.83.76a1 1 0 0 0-.7.66l-.45 1.39h-1l-.45-1.39a1 1 0 0 0-.7-.66a6.24 6.24 0 0 1-1.83-.76a1 1 0 0 0-.84-.1l-1.55.5l-.7-.7l.5-1.54a1 1 0 0 0-.05-.83a6.04 6.04 0 0 1-.77-1.85a1 1 0 0 0-.48-.62L4 12.74v-1.48l1.42-.82a1 1 0 0 0 .48-.62a6.04 6.04 0 0 1 .77-1.85a1 1 0 0 0 .05-.83l-.5-1.54l.7-.7l1.55.5a1 1 0 0 0 .84-.1a6.2 6.2 0 0 1 1.83-.76a1 1 0 0 0 .7-.66l.45-1.4h1l.45 1.4a1 1 0 0 0 .7.66a6.24 6.24 0 0 1 1.83.76a1 1 0 0 0 .84.1l1.55-.5l.7.7l-.5 1.54a1 1 0 0 0 .05.83a6.04 6.04 0 0 1 .77 1.85a1 1 0 0 0 .48.62L20 11.26v1.48Z"
                      />
                    </svg>
                  </span>
                  <span class="settings-toggle__label">Settings</span>
                </button>
                <button
                  type="button"
                  id="toggleSidebar"
                  class="ghost mobile-sidebar-toggle"
                  aria-expanded="false"
                  aria-controls="sidePanel"
                  data-hint="Toggle the companion panels on smaller screens."
                >
                  Player Panels
                </button>
              </div>
              <div class="user-identity" aria-live="polite" data-hint="Profile data captured for this run.">
                <span class="user-name" id="headerUserName" data-hint="Current explorer alias.">Guest Explorer</span>
                <span class="user-location" id="headerUserLocation" data-hint="Last known co-ordinates.">Location unavailable</span>
              </div>
            </div>
          </div>
          <div class="hud-layer__bottom">
            <div
              class="portal-status"
              id="portalStatus"
              role="status"
              aria-live="assertive"
              data-state="inactive"
              data-hint="Shows whether the current portal is dormant, primed, or active."
            >
              <span class="portal-status__icon" aria-hidden="true"></span>
              <span class="portal-status__text">
                <span class="portal-status__state">Portal dormant</span>
                <span class="portal-status__detail">Awaiting ignition sequence</span>
              </span>
            </div>
            <div
              class="portal-progress"
              id="portalProgress"
              role="progressbar"
              aria-valuemin="0"
              aria-valuemax="100"
              aria-valuenow="0"
              data-hint="Stabilise portals by filling this progress bar."
            >
              <span class="label"></span>
              <span class="bar"></span>
            </div>
          </div>
        </div>
        <div class="crosshair" id="crosshair" aria-hidden="true" data-hint="Aiming reticle for interactions.">
          <span class="crosshair__horizontal"></span>
          <span class="crosshair__vertical"></span>
        </div>
        <div
          class="block-action-hud"
          id="blockActionHud"
          role="status"
          aria-live="assertive"
          aria-hidden="true"
          hidden
        ></div>
        <div
          class="pointer-hint"
          id="pointerHint"
          role="status"
          aria-live="polite"
          hidden
          data-hint="Reminder to capture the pointer for desktop controls."
        >
          Click the viewport to capture your mouse, then use WASD or the arrow keys to move and left-click to mine.
        </div>
        <div class="hand-overlay" id="handOverlay" aria-hidden="true" data-item="fist" data-hint="Currently equipped item.">
          <div
            class="hand-overlay__icon"
            id="handOverlayIcon"
            aria-hidden="true"
            data-item="fist"
            data-hint="Visual icon for your held tool."
          ></div>
          <span class="hand-overlay__label" id="handOverlayLabel" data-hint="Name of the held item.">Fist</span>
        </div>
        <section
          class="dimension-intro"
          id="dimensionIntro"
          role="status"
          aria-live="assertive"
          hidden
          data-hint="Displays the rules for the dimension you just entered."
        >
          <h2 class="dimension-intro__name" id="dimensionIntroName"></h2>
          <p class="dimension-intro__rules" id="dimensionIntroRules"></p>
        </section>
        <div
          class="subtitle-overlay"
          id="subtitleOverlay"
          role="status"
          aria-live="assertive"
          hidden
          data-hint="Dialogue and lore subtitles appear here."
        ></div>
        <div
          class="victory-banner"
          id="victoryBanner"
          role="status"
          aria-live="assertive"
          data-hint="Triumphant banner announcing your success."
        ></div>
        <div
          class="victory-celebration"
          id="victoryCelebration"
          hidden
          aria-hidden="true"
          data-hint="Animated celebration with stats and share tools."
        >
          <div class="victory-celebration__backdrop" aria-hidden="true"></div>
          <div class="victory-celebration__effects" aria-hidden="true">
            <div class="victory-confetti" id="victoryConfetti" aria-hidden="true"></div>
            <div class="victory-fireworks" id="victoryFireworks" aria-hidden="true"></div>
          </div>
          <div
            class="victory-celebration__content"
            role="dialog"
            aria-modal="true"
            aria-labelledby="victoryTitle"
            aria-describedby="victoryMessage victoryStats victoryShareStatus"
          >
            <span class="victory-celebration__eyebrow">Multiverse Secured</span>
            <h2 id="victoryTitle">Victory Achieved</h2>
            <p id="victoryMessage">
              You returned with the Eternal Ingot. The bridge between worlds is safe once more.
            </p>
            <dl class="victory-celebration__stats" id="victoryStats">
              <div>
                <dt>Final Score</dt>
                <dd>0</dd>
              </div>
              <div>
                <dt>Dimensions Stabilised</dt>
                <dd>0</dd>
              </div>
              <div>
                <dt>Run Time</dt>
                <dd>00:00</dd>
              </div>
            </dl>
            <div class="victory-celebration__actions">
              <button type="button" class="primary" id="victoryShareButton">Share your run</button>
              <button type="button" class="ghost" id="victoryCloseButton">Continue exploring</button>
            </div>
            <p class="victory-celebration__share-status" id="victoryShareStatus" role="status" aria-live="polite"></p>
          </div>
        </div>
        <div class="drowning-vignette" id="drowningVignette" aria-hidden="true"></div>
        <div class="tar-overlay" id="tarOverlay" aria-hidden="true"></div>
        <div class="dimension-transition" id="dimensionTransition" aria-hidden="true"></div>
        <div
          class="defeat-overlay"
          id="defeatOverlay"
          aria-hidden="true"
          tabindex="-1"
        >
          <div
            class="defeat-overlay__content"
            role="dialog"
            aria-modal="true"
            aria-labelledby="defeatTitle"
            aria-describedby="defeatMessage defeatCountdown"
          >
            <h3 id="defeatTitle">You Perished</h3>
            <p class="defeat-overlay__message" id="defeatMessage"></p>
            <div class="defeat-overlay__inventory" id="defeatInventory" aria-live="polite"></div>
            <p class="defeat-overlay__countdown" id="defeatCountdown" role="status" aria-live="assertive"></p>
            <div class="defeat-overlay__actions">
              <button type="button" class="defeat-overlay__respawn-button" id="defeatRespawn">
                Respawn Now
              </button>
            </div>
          </div>
        </div>
      </section>
      <aside class="side-panel" id="sidePanel" tabindex="-1" aria-hidden="true">
        <section class="player-panel" aria-label="Player profile">
          <header class="player-panel__header">
            <h2>Player Hub</h2>
            <button type="button" class="ghost small side-panel-close" data-close-sidebar aria-label="Close player panels">
              Close
            </button>
            <button type="button" id="googleSignOut" class="ghost small" data-google-sign-out hidden>
              Sign out
            </button>
          </header>
          <div class="player-panel__content">
            <div class="identity-pill" id="userNameDisplay">Guest Explorer</div>
            <div class="identity-meta">
              <span id="userLocationDisplay">Location unavailable</span>
              <span id="userDeviceDisplay">Device details pending</span>
            </div>
            <div class="gsi-container" data-google-button-container hidden></div>
            <button type="button" class="primary" data-google-fallback-signin>Sign in with Google</button>
            <p class="player-panel__hint">
              Sign in to capture your location badge, sync your device fingerprint, and compete on the Infinite Dimension scorecard.
            </p>
          </div>
        </section>
        <section class="inventory-panel">
          <h2>Inventory</h2>
          <div class="hotbar" id="hotbar"></div>
          <button
            class="toggle-extended"
            id="toggleExtended"
            aria-controls="extendedInventory"
            aria-expanded="false"
          >
            Expand Inventory
          </button>
          <div class="extended" id="extendedInventory" inert></div>
        </section>
        <section class="codex-panel" aria-label="Dimension codex">
          <header>
            <h2>Dimension Codex</h2>
          </header>
          <ul id="dimensionCodex"></ul>
        </section>
        <section class="log-panel" aria-live="polite">
          <header>
            <h2>Event Log</h2>
            <div class="log-panel__actions">
              <button
                type="button"
                class="ghost small log-panel__developer-toggle"
                id="developerStatsToggle"
                aria-pressed="false"
                aria-controls="developerStatsPanel"
                data-hint="Show developer performance metrics"
              >
                Show Developer Stats
              </button>
              <button
                type="button"
                class="ghost small log-panel__diagnostics-toggle"
                id="liveDiagnosticsToggle"
                aria-pressed="false"
                aria-controls="liveDiagnosticsPanel"
                data-hint="Enable debug mode to unlock live diagnostics"
              >
                Show Live Diagnostics
              </button>
              <button
                type="button"
                class="ghost small log-panel__debug-toggle"
                id="debugModeToggle"
                aria-pressed="false"
                data-hint="Enable verbose diagnostics"
              >
                Enable Debug Mode
              </button>
            </div>
          </header>
          <p class="log-panel__debug-status" id="debugModeStatus" role="status" aria-live="polite">
            Standard diagnostics active.
          </p>
          <ul id="eventLog"></ul>
          <div
            class="live-diagnostics"
            id="liveDiagnosticsPanel"
            role="region"
            aria-live="polite"
            aria-label="Live diagnostics log"
            hidden
          >
            <div class="live-diagnostics__header">
              <p class="live-diagnostics__title">Live Diagnostics</p>
              <button type="button" class="ghost small" id="liveDiagnosticsClear">Clear</button>
            </div>
            <p class="live-diagnostics__empty" id="liveDiagnosticsEmpty">No diagnostics recorded.</p>
            <ul class="live-diagnostics__entries" id="liveDiagnosticsList" role="list"></ul>
          </div>
        </section>
      </aside>
    </main>
    <div class="side-panel__scrim" id="sidePanelScrim" hidden></div>
    <footer class="footer">
      <div class="controls">
        <div>
          <h3>Desktop Controls</h3>
          <p id="desktopControlsSummary">
            WASD/Arrows move ¬∑ Space jump ¬∑ F interact ¬∑ Q place block ¬∑ R ignite portal ¬∑ E crafting ¬∑ I inventory ¬∑ T reset
            position ¬∑ V toggle view ¬∑ 1‚Äì0 hotbar ¬∑ Esc close menus
          </p>
        </div>
        <div>
          <h3>Mobile Controls</h3>
          <p>Swipe to move ¬∑ Tap hold to interact ¬∑ Tap buttons for craft/build</p>
        </div>
      </div>
    </footer>

    <div
      class="modal landing-modal"
      id="introModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="introTitle"
    >
      <div class="landing-modal__background" aria-hidden="true">
        <div class="landing-modal__stars landing-modal__stars--back"></div>
        <div class="landing-modal__stars landing-modal__stars--front"></div>
        <div class="landing-modal__glow"></div>
      </div>
      <div class="modal-content landing-modal__content" role="document">
        <div class="landing-modal__layout">
          <header class="landing-modal__header">
            <p class="landing-modal__eyebrow">Infinite Rails</p>
            <h1 id="introTitle" class="landing-modal__title">Portals of Dimension</h1>
            <p class="landing-modal__tagline">
              Stabilise shimmering tracks between realities before you brave the storm of fractured worlds.
            </p>
            <div class="landing-modal__actions">
              <button id="startButton" class="primary landing-modal__start">Start Expedition</button>
              <button type="button" class="ghost landing-modal__howto" id="landingGuideButton">How to Play</button>
            </div>
          </header>
          <div class="landing-modal__body">
            <section
              class="signin-callout landing-modal__signin"
              id="landingSignInPanel"
              aria-label="Link your explorer profile"
            >
              <h3>Sync your journey before you depart</h3>
              <p class="signin-callout__summary">
                Sign in with Google to unlock the shared scoreboard, capture your location badge, and mirror your progress across
                every device.
              </p>
              <div class="signin-callout__actions">
                <div class="gsi-container" data-google-button-container hidden></div>
                <button type="button" class="primary" data-google-fallback-signin>Sign in with Google</button>
                <p class="signin-callout__note">Prefer to explore as a guest? You can connect later from the Player Hub.</p>
              </div>
            </section>
            <ul class="landing-modal__highlights" aria-label="Highlights">
              <li>Build 4√ó3 portals with unique materials to unlock new rules.</li>
              <li>Craft using ordered sequences and uncover hidden recipes.</li>
              <li>Survive nightly assaults while protecting villagers and rails.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal settings-modal"
      id="settingsModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="settingsTitle"
      hidden
    >
      <div class="modal-content settings-modal__content">
        <header class="settings-modal__header">
          <h2 id="settingsTitle">Audio Settings</h2>
          <p>Balance the ambience of the rails before you depart.</p>
        </header>
        <form class="settings-modal__form" data-settings-form>
          <fieldset class="settings-modal__fieldset">
            <legend class="settings-modal__legend">Audio mix</legend>
            <div class="settings-modal__field">
              <div class="settings-modal__label-row">
                <label for="masterVolume">Master Volume</label>
                <span class="settings-modal__value" data-volume-label="master">80%</span>
              </div>
              <input
                type="range"
                id="masterVolume"
                name="master"
                min="0"
                max="100"
                value="80"
                class="settings-modal__range"
              />
            </div>
            <div class="settings-modal__field">
              <div class="settings-modal__label-row">
                <label for="musicVolume">Music</label>
                <span class="settings-modal__value" data-volume-label="music">60%</span>
              </div>
              <input
                type="range"
                id="musicVolume"
                name="music"
                min="0"
                max="100"
                value="60"
                class="settings-modal__range"
              />
            </div>
            <div class="settings-modal__field">
              <div class="settings-modal__label-row">
                <label for="effectsVolume">Effects</label>
                <span class="settings-modal__value" data-volume-label="effects">85%</span>
              </div>
              <input
                type="range"
                id="effectsVolume"
                name="effects"
                min="0"
                max="100"
                value="85"
                class="settings-modal__range"
              />
            </div>
            <p class="settings-modal__hint">Balance ambient loops and crafting cues independently.</p>
          </fieldset>
          <fieldset class="settings-modal__fieldset settings-modal__fieldset--keybindings">
            <legend class="settings-modal__legend">Key bindings</legend>
            <p class="settings-modal__hint settings-modal__hint--keys">
              Click a control, then press a key to remap it. Press Backspace to restore an individual default or reset all
              bindings below.
            </p>
            <div class="keybinding-warning" id="keyBindingWarning" role="alert" hidden></div>
            <div class="keybinding-groups" id="settingsKeyBindingsList"></div>
            <div class="settings-modal__key-actions">
              <button type="button" class="ghost small" id="resetKeyBindingsButton">Reset all to defaults</button>
            </div>
          </fieldset>
          <fieldset class="settings-modal__fieldset settings-modal__fieldset--toggles">
            <legend class="settings-modal__legend">Accessibility</legend>
            <section class="settings-modal__theme" aria-labelledby="themeToggleLabel" aria-describedby="themeToggleDescription">
              <div class="settings-modal__toggle-copy">
                <span id="themeToggleLabel" class="settings-modal__toggle-title">Interface theme</span>
                <span id="themeToggleDescription" class="settings-modal__toggle-description">
                  Switch between dark, light, or automatic contrast if your browser can't detect a preferred colour scheme.
                </span>
              </div>
              <div class="settings-modal__theme-options" role="radiogroup" aria-labelledby="themeToggleLabel">
                <label class="settings-modal__theme-option">
                  <input type="radio" name="colorMode" id="colorModeAuto" value="auto" aria-describedby="themeToggleDescription" />
                  <span>Auto</span>
                </label>
                <label class="settings-modal__theme-option">
                  <input type="radio" name="colorMode" id="colorModeLight" value="light" aria-describedby="themeToggleDescription" />
                  <span>Light</span>
                </label>
                <label class="settings-modal__theme-option">
                  <input type="radio" name="colorMode" id="colorModeDark" value="dark" aria-describedby="themeToggleDescription" />
                  <span>Dark</span>
                </label>
              </div>
            </section>
            <label class="settings-modal__toggle">
              <span class="settings-modal__toggle-copy">
                <span id="colorBlindModeLabel" class="settings-modal__toggle-title">Colour-blind assist</span>
                <span id="colorBlindModeDescription" class="settings-modal__toggle-description">
                  Boost HUD contrast and highlight critical effects with dual-spectrum colours.
                </span>
              </span>
              <span class="settings-modal__toggle-control">
                <input
                  type="checkbox"
                  id="colorBlindMode"
                  name="colorBlindMode"
                  class="toggle-switch__input"
                  aria-describedby="colorBlindModeDescription"
                  aria-labelledby="colorBlindModeLabel"
                />
                <span class="toggle-switch" aria-hidden="true"></span>
              </span>
            </label>
            <label class="settings-modal__toggle">
              <span class="settings-modal__toggle-copy">
                <span id="subtitleToggleLabel" class="settings-modal__toggle-title">Subtitles</span>
                <span id="subtitleToggleDescription" class="settings-modal__toggle-description">
                  Surface narrated log entries as large captions near the action.
                </span>
              </span>
              <span class="settings-modal__toggle-control">
                <input
                  type="checkbox"
                  id="subtitleToggle"
                  name="subtitleToggle"
                  class="toggle-switch__input"
                  aria-describedby="subtitleToggleDescription"
                  aria-labelledby="subtitleToggleLabel"
                />
                <span class="toggle-switch" aria-hidden="true"></span>
              </span>
            </label>
          </fieldset>
          <fieldset class="settings-modal__fieldset settings-modal__fieldset--account">
            <legend class="settings-modal__legend">Account</legend>
            <p class="settings-modal__note">Disconnect your synced explorer when you are ready to depart.</p>
            <button
              type="button"
              class="ghost settings-modal__logout"
              id="settingsLogout"
              data-google-sign-out
              hidden
            >
              Sign out of Google
            </button>
          </fieldset>
          <div class="settings-modal__actions">
            <button type="button" class="ghost" id="closeSettings">Close</button>
          </div>
        </form>
      </div>
    </div>

    <div
      class="modal crafting-modal"
      id="craftingModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="craftingTitle"
      hidden
    >
      <div class="modal-content crafting-modal__content">
        <button type="button" class="crafting-modal__close" id="closeCrafting" aria-label="Close crafting interface"></button>
        <header class="crafting-modal__header">
          <div>
            <p class="crafting-modal__eyebrow">Assembly Sequence</p>
            <h2 id="craftingTitle">Crafting Matrix</h2>
            <p class="crafting-modal__intro">
              Arrange resources across up to seven slots in the exact order. Known recipes can auto-fill from the library
              or the search suggestions below.
            </p>
          </div>
        </header>
        <div class="crafting-modal__grid">
          <section class="crafting-modal__inventory" aria-label="Satchel inventory">
            <header class="crafting-modal__inventory-header">
              <h3>Satchel</h3>
              <button type="button" class="ghost small" id="openCraftingSearch">Search Library</button>
            </header>
            <div class="crafting-inventory" id="craftingInventory" role="list"></div>
            <p class="crafting-inventory__hint">Drag resources to the sequence or tap to quick add.</p>
          </section>
          <section class="crafting-modal__sequence" aria-label="Crafting sequence">
            <div class="crafting-sequence" id="craftSequence" data-slot-count="7"></div>
            <div class="crafting-actions">
              <button type="button" class="primary" id="craftButton" disabled>Craft Item</button>
              <button type="button" class="ghost" id="clearCraft">Clear Sequence</button>
            </div>
            <p class="crafting-hint">
              Tip: Click ingredients from your satchel to queue them. Slots collapse to the left as you remove steps.
            </p>
            <div class="crafting-helper" id="craftingHelper" aria-live="polite">
              <p class="crafting-helper__title" id="craftingHelperTitle">Recipe Helper</p>
              <p class="crafting-helper__description" id="craftingHelperDescription">
                Queue materials to preview known recipes.
              </p>
              <ul class="crafting-helper__matches" id="craftingHelperMatches" data-empty="true"></ul>
            </div>
          </section>
          <section class="crafting-modal__recipes" aria-label="Recipe library">
            <label class="crafting-search" for="recipeSearch">
              Search library
              <span class="sr-only"> for recipes or ingredients</span>
            </label>
            <input type="search" id="recipeSearch" placeholder="Search recipes or ingredients" autocomplete="off" />
            <ul class="crafting-suggestions" id="craftSuggestions" role="listbox" aria-live="polite"></ul>
            <div class="recipe-list" id="recipeList" role="listbox" aria-live="polite"></div>
          </section>
        </div>
        <div class="crafting-confetti" id="craftConfetti" aria-hidden="true"></div>
        <div
          class="crafting-search-panel"
          id="craftingSearchPanel"
          role="dialog"
          aria-modal="true"
          aria-labelledby="craftingSearchTitle"
          hidden
        >
          <div class="crafting-search-panel__content" role="document">
            <header class="crafting-search-panel__header">
              <p class="crafting-search-panel__eyebrow">Recipe Library</p>
              <h3 id="craftingSearchTitle">Search combinations</h3>
              <p>Filter by ingredient, output, or recipe name to auto-fill the sequence.</p>
            </header>
            <div class="crafting-search-panel__input">
              <label for="craftingSearchInput" class="sr-only">Search recipes</label>
              <input
                type="search"
                id="craftingSearchInput"
                placeholder="Search for recipes or ingredients"
                autocomplete="off"
              />
            </div>
            <ul class="crafting-search-panel__results" id="craftingSearchResults" role="listbox" aria-live="polite"></ul>
            <div class="crafting-search-panel__actions">
              <button type="button" class="ghost" id="closeCraftingSearch">Close</button>
            </div>
          </div>
        </div>
    </div>
  </div>

    <div
      class="modal inventory-modal"
      id="inventoryModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="inventoryTitle"
      hidden
    >
      <div class="modal-content inventory-modal__content">
        <button
          type="button"
          class="inventory-modal__close"
          id="closeInventory"
          aria-label="Close inventory overlay"
        ></button>
        <header class="inventory-modal__header">
          <div>
            <p class="inventory-modal__eyebrow">Field Satchel</p>
            <h2 id="inventoryTitle">Inventory Overview</h2>
            <p class="inventory-modal__intro">
              Review every artifact you carry. Items are mirrored to your crafting library, and dragging leaves an
              aether trail to confirm the grab.
            </p>
          </div>
          <div class="inventory-modal__actions">
            <button
              type="button"
              class="ghost inventory-modal__sort"
              id="inventorySortButton"
              aria-pressed="false"
            >
              Sort (A‚ÜíZ)
            </button>
          </div>
        </header>
        <div class="inventory-modal__grid" id="inventoryGrid" role="grid" aria-label="Satchel storage grid"></div>
        <footer class="inventory-modal__footer">
          <p class="inventory-modal__hint">Drag items to your crafting sequence or rearrange your satchel layout.</p>
          <p class="inventory-modal__overflow" id="inventoryOverflow" hidden></p>
        </footer>
      </div>
    </div>

    <div
      class="modal guide-modal"
      id="guideModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="guideTitle"
      hidden
    >
      <article class="guide-content" data-guide-scroll>
        <header class="guide-header">
          <div>
            <p class="guide-eyebrow">Game Design Document &amp; User Manual</p>
            <h2 id="guideTitle">Infinite Dimension: Portals Reimagined</h2>
          </div>
          <button type="button" class="guide-close" data-close-guide aria-label="Close guide">
            <span aria-hidden="true">&times;</span>
          </button>
        </header>
        <section class="guide-section guide-carousel" data-guide-carousel aria-label="Interactive player guide">
          <div class="guide-carousel__viewport">
            <article class="guide-card" id="guideCarouselCard" data-guide-card role="group" aria-live="polite"></article>
          </div>
          <div class="guide-carousel__controls">
            <button type="button" class="guide-carousel__arrow" data-guide-prev aria-label="Previous guide card">
              <span aria-hidden="true">&#x2039;</span>
            </button>
            <div class="guide-carousel__dots" data-guide-dots></div>
            <button type="button" class="guide-carousel__arrow" data-guide-next aria-label="Next guide card">
              <span aria-hidden="true">&#x203A;</span>
            </button>
          </div>
        </section>
        <section class="guide-section">
          <h3>Game Overview</h3>
          <p>
            Infinite Dimension is a browser-based voxel survival puzzle. Gather resources, craft ordered recipes, and build
            precise 4√ó3 portals to leap between realms. Each portal material rewrites the physics and threats of the
            destination dimension.
          </p>
          <ul>
            <li>Portals are the only way to explore fresh territories.</li>
            <li>Every material introduces a bespoke challenge and reward loop.</li>
            <li>Crafting is performed by sequencing items rather than arranging them in a grid.</li>
          </ul>
        </section>
        <section class="guide-section">
          <h3>Look &amp; Feel</h3>
          <p>Each dimension features a distinct ambience, palette, and soundtrack cues:</p>
          <ul>
            <li><strong>Rock:</strong> rugged canyons with dense gravity and ore-rich chasms.</li>
            <li><strong>Stone:</strong> glowing monochrome rails that phase in rhythmic patterns.</li>
            <li><strong>Tar:</strong> a viscous, low-visibility swamp that slows movement.</li>
            <li><strong>Marble:</strong> mirror-bright courtyards where actions echo after five seconds.</li>
            <li><strong>Netherite:</strong> molten rails collapse behind every step ‚Äî the final gauntlet.</li>
          </ul>
        </section>
        <section class="guide-section">
          <h3>How to Play</h3>
          <ol>
            <li>Spawn on a quiet grass island. Search trees and stones for early materials.</li>
            <li>Use the craft circle next to your hearts to arrange items in the correct sequence.</li>
            <li>Build a 4√ó3 portal frame from a single material, leave the centre empty, and ignite it.</li>
            <li>Explore the new realm, solve its rail puzzle, and gather the unique loot inside.</li>
            <li>Survive the nightly zombie raids, protect villagers, and stabilise the rails.</li>
            <li>Repeat with higher-tier materials until you conquer the collapsing Netherite dimension.</li>
          </ol>
        </section>
        <section class="guide-section" id="movement">
          <h3>Movement Practice</h3>
          <p>
            Launch the mini sandbox to see how the explorer responds to your inputs. Use it to rehearse basic
            traversal before you dive into collapsing rails.
          </p>
        </section>
        <section class="guide-section" id="crafting">
          <h3>Crafting Practice</h3>
          <p>
            Drag sample materials into the crafting slots to lock in the proper sequence. Mastering the order keeps
            your real recipes fast and precise when a raid begins.
          </p>
        </section>
        <section class="guide-section">
          <h3>Control Reference</h3>
          <table class="guide-controls-table">
            <caption class="visually-hidden">Desktop and mobile control mapping</caption>
            <thead>
              <tr>
                <th scope="col">Action</th>
                <th scope="col">Desktop</th>
                <th scope="col">Mobile</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">Move &amp; swap rails</th>
                <td data-keybinding-table="movement"><kbd>WASD</kbd> or <kbd>Arrows</kbd></td>
                <td>Swipe ‚ü∑</td>
              </tr>
              <tr>
                <th scope="row">Jump</th>
                <td data-keybinding-table="jump"><kbd>Space</kbd></td>
                <td>Tap Jump</td>
              </tr>
              <tr>
                <th scope="row">Interact</th>
                <td data-keybinding-table="interact"><kbd>F</kbd> / <kbd>Mouse</kbd> click</td>
                <td>Tap interact icon</td>
              </tr>
              <tr>
                <th scope="row">Crafting</th>
                <td data-keybinding-table="toggleCrafting"><kbd>E</kbd></td>
                <td>Crafting button</td>
              </tr>
              <tr>
                <th scope="row">Inventory</th>
                <td data-keybinding-table="toggleInventory"><kbd>I</kbd></td>
                <td>Inventory button</td>
              </tr>
              <tr>
                <th scope="row">Place block</th>
                <td data-keybinding-table="placeBlock"><kbd>Q</kbd></td>
                <td>Tap build icon</td>
              </tr>
              <tr>
                <th scope="row">Toggle camera</th>
                <td data-keybinding-table="toggleCameraPerspective"><kbd>V</kbd></td>
                <td>&mdash;</td>
              </tr>
              <tr>
                <th scope="row">Reset position</th>
                <td data-keybinding-table="resetPosition"><kbd>R</kbd></td>
                <td>&mdash;</td>
              </tr>
              <tr>
                <th scope="row">Game guide</th>
                <td data-keybinding-table="openGuide"><kbd>F1</kbd></td>
                <td>&mdash;</td>
              </tr>
              <tr>
                <th scope="row">Settings</th>
                <td data-keybinding-table="openSettings"><kbd>F2</kbd></td>
                <td>&mdash;</td>
              </tr>
              <tr>
                <th scope="row">Leaderboard</th>
                <td data-keybinding-table="openLeaderboard"><kbd>F3</kbd></td>
                <td>&mdash;</td>
              </tr>
              <tr>
                <th scope="row">Quick deploy</th>
                <td data-keybinding-table="hotbar"><kbd>1</kbd>‚Äì<kbd>9</kbd> hotbar</td>
                <td>Hotbar tap</td>
              </tr>
            </tbody>
          </table>
        </section>
        <section class="guide-section guide-section--tips">
          <h3>Field Tips</h3>
          <ul class="guide-tips">
            <li>Blue cadence lights foreshadow collapsing rails ‚Äî reposition early.</li>
            <li>Sequencing an item twice stores it in the crafting suggestions list for fast reuse.</li>
            <li>Villagers reward you with buffs if their homes survive a raid streak.</li>
            <li>Place torches near portals to keep the ignition matrix stable overnight.</li>
          </ul>
        </section>
        <section class="guide-section guide-section--diagram">
          <h3>Portal Frame Blueprint</h3>
          <figure class="guide-portal-diagram">
            <svg viewBox="0 0 200 160" role="img" aria-labelledby="portalDiagramTitle">
              <title id="portalDiagramTitle">Four by three portal frame blueprint</title>
              <rect x="24" y="20" width="152" height="120" fill="none" stroke="rgba(73, 242, 255, 0.45)" stroke-width="8" rx="10" ry="10"></rect>
              <rect x="40" y="36" width="120" height="88" fill="rgba(73, 242, 255, 0.12)" stroke="rgba(73, 242, 255, 0.35)" stroke-width="2" stroke-dasharray="6 8" rx="8" ry="8"></rect>
              <line x1="40" y1="60" x2="160" y2="60" stroke="rgba(73, 242, 255, 0.2)" stroke-width="1.5" stroke-dasharray="4 6"></line>
              <line x1="40" y1="92" x2="160" y2="92" stroke="rgba(73, 242, 255, 0.2)" stroke-width="1.5" stroke-dasharray="4 6"></line>
              <line x1="40" y1="124" x2="160" y2="124" stroke="rgba(73, 242, 255, 0.2)" stroke-width="1.5" stroke-dasharray="4 6"></line>
              <line x1="72" y1="36" x2="72" y2="124" stroke="rgba(73, 242, 255, 0.2)" stroke-width="1.5" stroke-dasharray="4 6"></line>
              <line x1="104" y1="36" x2="104" y2="124" stroke="rgba(73, 242, 255, 0.2)" stroke-width="1.5" stroke-dasharray="4 6"></line>
              <line x1="136" y1="36" x2="136" y2="124" stroke="rgba(73, 242, 255, 0.2)" stroke-width="1.5" stroke-dasharray="4 6"></line>
              <text x="100" y="150" text-anchor="middle" fill="rgba(247, 183, 51, 0.85)" font-size="12" font-family="'Chakra Petch', sans-serif">Build 4√ó3, ignite centre</text>
            </svg>
            <figcaption>Keep the frame uniform ‚Äî mismatched materials destabilise the gateway.</figcaption>
          </figure>
        </section>
        <section class="guide-section">
          <h3>Dimensions &amp; Objectives</h3>
          <dl class="dimension-list">
            <div>
              <dt>Rock Portal</dt>
              <dd>Stronger gravity and sliding slopes. Rewards heavy ores and plating.</dd>
            </div>
            <div>
              <dt>Stone Portal</dt>
              <dd>Rails appear and vanish to a rhythm. Collect pattern crystals for sync tech.</dd>
            </div>
            <div>
              <dt>Tar Portal</dt>
              <dd>Movement is heavy and tar slugs pursue you. Gather sticky sacs for traps.</dd>
            </div>
            <div>
              <dt>Marble Portal</dt>
              <dd>Your actions echo after five seconds. Use the reverbs to solve mirrored puzzles.</dd>
            </div>
            <div>
              <dt>Netherite Portal</dt>
              <dd>Rails crumble behind you. Sprint, align collapsing tracks, and seize the Eternal Ingot.</dd>
            </div>
          </dl>
        </section>
        <section class="guide-section">
          <h3>Survival Cycle</h3>
          <p>
            Daytime is safe for crafting and exploration. When night falls, zombies swarm the rails and villagers risk
            conversion. Keep torches lit, stand your ground, and repair damage before dawn. Underwater exploration is
            limited by your bubbles: once they deplete, hearts drain rapidly.
          </p>
        </section>
        <section class="guide-section">
          <h3>Winning a Run</h3>
          <p>
            Reach the Netherite dimension, stabilise collapsing rails long enough to grab the Eternal Ingot, and return
            to the Grassland Threshold. Delivering the ingot home completes the run and logs your time on the leaderboards.
          </p>
        </section>
      </article>
    </div>

    <div
      class="modal leaderboard-modal"
      id="leaderboardModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="leaderboardTitle"
      hidden
    >
      <div class="modal-content leaderboard-modal__content">
        <header class="leaderboard-modal__header">
          <div>
            <p class="leaderboard-modal__eyebrow">Global Rankings</p>
            <h2 id="leaderboardTitle">Multiverse Scoreboard</h2>
          </div>
          <button type="button" class="ghost small" id="closeLeaderboard" aria-label="Close leaderboard">Close</button>
        </header>
        <p class="leaderboard-status" id="scoreboardStatus" aria-live="polite"></p>
        <div class="leaderboard-controls">
          <button type="button" id="refreshScores" class="ghost small leaderboard-refresh" data-loading="false">
            <span class="leaderboard-refresh__spinner" aria-hidden="true"></span>
            <span class="leaderboard-refresh__label">Refresh</span>
          </button>
        </div>
        <div class="leaderboard-table__container" id="leaderboardTable" data-empty="true">
          <table class="leaderboard-table">
            <thead>
              <tr>
                <th scope="col" class="leaderboard-col-rank">#</th>
                <th scope="col" class="leaderboard-sortable" data-sort-key="name" tabindex="0">Explorer</th>
                <th
                  scope="col"
                  class="leaderboard-sortable"
                  data-sort-key="score"
                  data-sort-direction="desc"
                  tabindex="0"
                >
                  Score
                </th>
                <th scope="col" class="leaderboard-sortable" data-sort-key="runTimeSeconds" tabindex="0">Run Time</th>
                <th scope="col" class="leaderboard-sortable" data-sort-key="dimensionCount" tabindex="0">Realms</th>
                <th scope="col" class="leaderboard-sortable" data-sort-key="inventoryCount" tabindex="0">Inventory</th>
                <th scope="col" class="leaderboard-sortable" data-sort-key="locationLabel" tabindex="0">Location</th>
                <th scope="col" class="leaderboard-sortable" data-sort-key="updatedAt" tabindex="0">Updated</th>
              </tr>
            </thead>
            <tbody id="scoreboardList"></tbody>
          </table>
          <p class="leaderboard-empty" id="leaderboardEmptyMessage">Sign in to publish your victories and see the live rankings.</p>
        </div>
        <div
          class="compose-overlay"
          id="leaderboardOverlay"
          hidden
          aria-hidden="true"
          data-mode="idle"
        >
          <div
            class="compose-overlay__dialog"
            id="leaderboardOverlayDialog"
            tabindex="-1"
            role="dialog"
            aria-modal="false"
            aria-labelledby="leaderboardOverlayTitle"
            aria-describedby="leaderboardOverlayMessage"
          >
            <div class="compose-overlay__spinner" id="leaderboardOverlaySpinner" aria-hidden="true"></div>
            <div class="compose-overlay__body">
              <h3 class="compose-overlay__title" id="leaderboardOverlayTitle">Syncing leaderboard</h3>
              <p class="compose-overlay__message" id="leaderboardOverlayMessage" aria-live="polite"></p>
              <div class="compose-overlay__actions" id="leaderboardOverlayActions"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="mobile-controls" id="mobileControls" data-active="false" inert>
      <div class="mobile-controls__cluster mobile-controls__cluster--movement" role="group" aria-label="Movement controls">
        <div class="virtual-joystick" id="virtualJoystick" inert aria-label="Analog movement joystick">
          <div class="virtual-joystick__thumb"></div>
        </div>
        <div class="mobile-controls__dpad" role="group" aria-label="Digital movement pad">
          <button
            type="button"
            class="mobile-controls__button mobile-controls__button--direction"
            data-action="up"
            aria-label="Move forward"
          >
            <span aria-hidden="true">‚ñ≤</span>
            <span class="sr-only">Move forward</span>
          </button>
          <button
            type="button"
            class="mobile-controls__button mobile-controls__button--direction"
            data-action="left"
            aria-label="Strafe left"
          >
            <span aria-hidden="true">‚óÄ</span>
            <span class="sr-only">Strafe left</span>
          </button>
          <button
            type="button"
            class="mobile-controls__button mobile-controls__button--direction"
            data-action="down"
            aria-label="Move backward"
          >
            <span aria-hidden="true">‚ñº</span>
            <span class="sr-only">Move backward</span>
          </button>
          <button
            type="button"
            class="mobile-controls__button mobile-controls__button--direction"
            data-action="right"
            aria-label="Strafe right"
          >
            <span aria-hidden="true">‚ñ∂</span>
            <span class="sr-only">Strafe right</span>
          </button>
        </div>
      </div>
      <div class="mobile-controls__cluster mobile-controls__cluster--actions" role="group" aria-label="Action controls">
        <button
          type="button"
          class="mobile-controls__button mobile-controls__button--primary accent"
          data-action="action"
          aria-label="Harvest or jump"
        >
          <span aria-hidden="true">‚ú¶</span>
          <span class="sr-only">Harvest or jump</span>
        </button>
        <button
          type="button"
          class="mobile-controls__button mobile-controls__button--primary accent"
          data-action="portal"
          aria-label="Open portal controls"
        >
          <span aria-hidden="true">‚ßâ</span>
          <span class="sr-only">Open portal controls</span>
        </button>
      </div>
    </div>

    <footer class="site-footer" aria-label="Creator attribution">
      <p>Made by Manu</p>
    </footer>

    <div
      class="compose-overlay compose-overlay--global"
      id="assetRecoveryOverlay"
      hidden
      aria-hidden="true"
      data-mode="error"
    >
      <div
        class="compose-overlay__dialog"
        id="assetRecoveryDialog"
        tabindex="-1"
        role="dialog"
        aria-modal="true"
        aria-labelledby="assetRecoveryTitle"
        aria-describedby="assetRecoveryMessage"
      >
        <div class="compose-overlay__body">
          <h3 class="compose-overlay__title" id="assetRecoveryTitle">Assets unavailable</h3>
          <p class="compose-overlay__message" id="assetRecoveryMessage">
            Critical models failed to stream in. Reload the page or retry the asset download to restore missing details.
          </p>
          <div class="compose-overlay__actions" id="assetRecoveryActions">
            <button type="button" class="ghost compose-overlay__action" id="assetRecoveryRetry">Retry Assets</button>
            <button type="button" class="ghost compose-overlay__action" id="assetRecoveryReload">Reload Page</button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="compose-overlay compose-overlay--global"
      id="globalOverlay"
      hidden
      aria-hidden="true"
      data-mode="idle"
    >
      <div
        class="compose-overlay__dialog"
        id="globalOverlayDialog"
        tabindex="-1"
        role="dialog"
        aria-modal="false"
        aria-labelledby="globalOverlayTitle"
        aria-describedby="globalOverlayMessage"
      >
        <div class="compose-overlay__spinner" id="globalOverlaySpinner" aria-hidden="true"></div>
        <div class="compose-overlay__body">
          <h3 class="compose-overlay__title" id="globalOverlayTitle">Working‚Ä¶</h3>
          <p class="compose-overlay__message" id="globalOverlayMessage" aria-live="polite"></p>
          <div class="compose-overlay__diagnostics" id="globalOverlayDiagnostics" aria-live="polite">
            <ul class="diagnostic-list" role="list">
              <li class="diagnostic-list__item" data-diagnostic="renderer" data-status="pending">
                <span class="diagnostic-list__label">Renderer</span>
                <span class="diagnostic-list__status" id="globalOverlayRendererStatus">Initialising renderer‚Ä¶</span>
              </li>
              <li class="diagnostic-list__item" data-diagnostic="assets" data-status="pending">
                <span class="diagnostic-list__label">Assets</span>
                <span class="diagnostic-list__status" id="globalOverlayAssetsStatus">Streaming core assets‚Ä¶</span>
              </li>
              <li class="diagnostic-list__item" data-diagnostic="backend" data-status="pending">
                <span class="diagnostic-list__label">Backend</span>
                <span class="diagnostic-list__status" id="globalOverlayBackendStatus">Checking leaderboard service‚Ä¶</span>
              </li>
            </ul>
          </div>
          <div class="compose-overlay__log" id="globalOverlayLog" aria-live="polite" aria-atomic="false">
            <p class="compose-overlay__log-empty" id="globalOverlayLogEmpty">Waiting for diagnostic events‚Ä¶</p>
            <ul class="compose-overlay__log-list" id="globalOverlayLogList" role="log"></ul>
          </div>
          <div class="compose-overlay__support" id="globalOverlaySupport">
            <a
              class="compose-overlay__support-link"
              id="globalOverlaySupportLink"
              href="https://support.infiniterails.app/diagnostics"
              target="_blank"
              rel="noreferrer noopener"
            >
              Need help? Visit support
            </a>
            <button type="button" class="compose-overlay__support-action" id="globalOverlayDownloadLogs">
              Download logs
            </button>
          </div>
          <div class="compose-overlay__actions" id="globalOverlayActions" hidden>
            <button
              type="button"
              class="compose-overlay__action compose-overlay__action--primary"
              id="globalOverlayRecoveryButton"
              hidden
            >
              Diagnostics Help
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function setupBootstrapFallback() {
        var doc = document;
        var timer = null;
        var fallbackActive = false;
        var originalTitle = null;
        var originalMessage = null;

        function restoreOverlayContent() {
          var title = doc.getElementById('globalOverlayTitle');
          if (title && originalTitle !== null) {
            title.textContent = originalTitle;
          }
          var message = doc.getElementById('globalOverlayMessage');
          if (message && originalMessage !== null) {
            message.textContent = originalMessage;
          }
        }

        function showOverlayFallback() {
          var overlay = doc.getElementById('globalOverlay');
          if (!overlay) {
            return false;
          }
          var dialog = doc.getElementById('globalOverlayDialog');
          var spinner = doc.getElementById('globalOverlaySpinner');
          var title = doc.getElementById('globalOverlayTitle');
          var message = doc.getElementById('globalOverlayMessage');

          overlay.hidden = false;
          overlay.removeAttribute('hidden');
          overlay.setAttribute('aria-hidden', 'false');
          overlay.setAttribute('data-mode', 'loading');
          overlay.setAttribute('data-fallback-active', 'true');

          if (dialog) {
            dialog.setAttribute('aria-busy', 'true');
          }
          if (spinner) {
            spinner.removeAttribute('aria-hidden');
          }
          if (title) {
            if (originalTitle === null) {
              originalTitle = title.textContent;
            }
            title.textContent = 'Preparing experience‚Ä¶';
          }
          if (message) {
            if (originalMessage === null) {
              originalMessage = message.textContent;
            }
            message.textContent = 'Still loading ‚Äî please check your connection if this persists.';
          }
          return true;
        }

        function ensureFallbackVisible() {
          if (fallbackActive) {
            return;
          }
          fallbackActive = showOverlayFallback();
          if (fallbackActive) {
            return;
          }

          var basicFallback = doc.getElementById('bootstrapFallbackMessage');
          if (!basicFallback) {
            basicFallback = doc.createElement('div');
            basicFallback.id = 'bootstrapFallbackMessage';
            basicFallback.setAttribute('role', 'status');
            basicFallback.setAttribute('aria-live', 'assertive');
            basicFallback.style.position = 'fixed';
            basicFallback.style.inset = '0';
            basicFallback.style.display = 'grid';
            basicFallback.style.placeItems = 'center';
            basicFallback.style.background = 'rgba(4, 18, 29, 0.86)';
            basicFallback.style.color = '#e8f6ff';
            basicFallback.style.fontFamily = "'Chakra Petch', 'Exo 2', sans-serif";
            basicFallback.style.fontSize = '1.25rem';
            basicFallback.style.textAlign = 'center';
            basicFallback.style.padding = '2rem';
            basicFallback.textContent = 'Preparing experience‚Ä¶ Still loading ‚Äî please check your connection if this persists.';
            doc.body.appendChild(basicFallback);
          }
          fallbackActive = true;
        }

        function hideFallback() {
          if (timer) {
            clearTimeout(timer);
            timer = null;
          }
          if (!fallbackActive) {
            return;
          }
          var overlay = doc.getElementById('globalOverlay');
          if (overlay && overlay.getAttribute('data-fallback-active') === 'true') {
            var dialog = doc.getElementById('globalOverlayDialog');
            var previouslyFocused = doc.activeElement;
            if (dialog && previouslyFocused && dialog.contains(previouslyFocused)) {
              if (typeof previouslyFocused.blur === 'function') {
                previouslyFocused.blur();
              }
              var focusTarget = doc.body;
              if (focusTarget) {
                var originalTabIndex = focusTarget.getAttribute('tabindex');
                if (originalTabIndex === null) {
                  focusTarget.setAttribute('tabindex', '-1');
                }
                if (typeof focusTarget.focus === 'function') {
                  focusTarget.focus();
                }
                if (originalTabIndex === null) {
                  focusTarget.removeAttribute('tabindex');
                }
              }
            }

            overlay.setAttribute('aria-hidden', 'true');
            overlay.setAttribute('data-mode', 'idle');
            overlay.removeAttribute('data-fallback-active');
            overlay.setAttribute('hidden', '');
            overlay.hidden = true;

            if (dialog) {
              dialog.removeAttribute('aria-busy');
            }
            var spinner = doc.getElementById('globalOverlaySpinner');
            if (spinner) {
              spinner.setAttribute('aria-hidden', 'true');
            }
            restoreOverlayContent();
          }

          var basicFallback = doc.getElementById('bootstrapFallbackMessage');
          if (basicFallback && basicFallback.parentNode) {
            basicFallback.parentNode.removeChild(basicFallback);
          }

          fallbackActive = false;
        }

        timer = setTimeout(ensureFallbackVisible, 2000);

        window.__infiniteRailsBootstrapFallback = {
          cancel: hideFallback,
          timer: timer,
        };
      })();
    </script>

    <footer
      class="made-by-manu"
      id="siteFooter"
      role="contentinfo"
      aria-live="polite"
      data-hint="Made by Manu footer with live run summary."
    >
      <span class="made-by-manu__label" aria-hidden="true">Made by Manu</span>
      <span class="sr-only">Experience crafted by Manu</span>
      <span class="made-by-manu__summary">
        Score
        <span id="footerScore" class="made-by-manu__metric" aria-label="Current score">0</span>
        ¬∑ Dimension
        <span id="footerDimension" class="made-by-manu__metric" aria-label="Current dimension"
          >Origin Grassland</span
        >
        <span id="footerStatus" class="made-by-manu__status" aria-label="Status message"
          >Stabilising the Origin rail.</span
        >
      </span>
    </footer>

    <script src="vendor/howler-stub.js" defer></script>
    <script>
      window.APP_CONFIG = Object.assign(
        {
          enableAdvancedExperience: true,
          preferAdvanced: true,
          defaultMode: 'advanced',
          forceAdvanced: true,
          forceSimpleMode: false,
          supportsAdvancedMobile: false,
          assetBaseUrl: (function () {
            if (typeof window === 'undefined' || !window.location?.href) {
              return null;
            }
            try {
              return new URL('./', window.location.href).href;
            } catch (error) {
              return null;
            }
          })(),
        },
        window.APP_CONFIG || {},
      );

      (function ensureDefaultTextureManifest(scope) {
        if (!scope || typeof scope.APP_CONFIG !== 'object') {
          return;
        }
        var defaults = {
          grass:
            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAGUlEQVR4nGOMn2/KQApgIkn1qIZRDUNKAwDeMQFTRB/l3QAAAABJRU5ErkJggg==',
          dirt:
            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAGUlEQVR4nGNsS3BmIAUwkaR6VMOohiGlAQC/vgFJA9SUHwAAAABJRU5ErkJggg==',
          stone:
            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAGUlEQVR4nGNsaGhgIAUwkaR6VMOohiGlAQDJTAGgLgFHggAAAABJRU5ErkJggg==',
          rails:
            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAaElEQVR4nGPUkhH4zzCAgHHnxln/5eWVGJZOboALnr30DM7Or6lgoKU8CzZXff35C6+rqSnPhFclHQDjaBrA5qrRNEBXB4ymAbwq6QBG08BoGhhNA6NpYDQNjKaB0TQwmgZG08BoGgAA0SM0+BZHEZkAAAAASUVORK5CYII=',
        };
        var manifest = scope.APP_CONFIG.textureManifest;
        if (!manifest || typeof manifest !== 'object') {
          manifest = {};
        }
        Object.keys(defaults).forEach(function (key) {
          var current = manifest[key];
          if (typeof current === 'string' && current.trim()) {
            return;
          }
          if (Array.isArray(current) && current.some(function (value) {
            return typeof value === 'string' && value.trim();
          })) {
            return;
          }
          manifest[key] = defaults[key];
        });
        scope.APP_CONFIG.textureManifest = manifest;
      })(typeof window !== 'undefined' ? window : typeof globalThis !== 'undefined' ? globalThis : null);
    </script>
    <script>
      (function loadOptionalGoogleScripts() {
        if (window.location && window.location.protocol === 'file:') {
          return;
        }
        var urls = [
          'https://apis.google.com/js/api.js',
          'https://accounts.google.com/gsi/client',
          'https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js',
        ];
        urls.forEach(function (src) {
          var script = document.createElement('script');
          script.src = src;
          script.async = false;
          document.head.appendChild(script);
        });
      })();
    </script>
    <script src="vendor/three.min.js" data-preload-three="true" defer></script>
    <script src="asset-resolver.js" defer></script>
    <script src="assets/offline-assets.js" defer></script>
    <script src="audio-aliases.js" defer></script>
    <script src="audio-captions.js" defer></script>
    <script src="scoreboard-utils.js" defer></script>
    <script src="portal-mechanics.js" defer></script>
    <script src="simple-experience.js" defer></script>
    <script src="script.js" defer></script>
    <div class="caption-layer" id="captionOverlay" role="status" aria-live="assertive" aria-atomic="true" hidden>
      <p class="caption-layer__text" id="captionOverlayText"></p>
    </div>
    <div class="sr-only" id="captionLiveRegion" aria-live="assertive" aria-atomic="true"></div>
  </body>
</html>
