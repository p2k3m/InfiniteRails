:root {
  color-scheme: dark;
  --bg-primary: #060b18;
  --bg-secondary: #0e172a;
  --bg-tertiary: rgba(18, 32, 54, 0.92);
  --accent: #4da4ff;
  --accent-strong: #ffb657;
  --accent-soft: rgba(77, 164, 255, 0.28);
  --primary: #52e0a3;
  --bg-dark: #2f4d1b;
  --glow: 0 0 14px rgba(82, 224, 163, 0.65);
  --dimension-primary: var(--accent);
  --dimension-glow: rgba(77, 164, 255, 0.4);
  --logo-size-min: 36px;
  --logo-size-max: 72px;
  --logo-opacity: 0.85;
  --tooltip-bg: rgba(5, 12, 28, 0.92);
  --tooltip-text: #f5f7fb;
  --text-primary: #f7fbe9;
  --text-secondary: rgba(233, 245, 220, 0.82);
  --danger: #ff5b7a;
  --success: #34d399;
  --grid-line: rgba(77, 164, 255, 0.1);
  --card-shadow: 0 18px 0 rgba(12, 18, 9, 0.4), 0 28px 56px rgba(5, 10, 6, 0.55);
  --manu-logo-max-size: 220px;
  --page-background: linear-gradient(
      180deg,
      #8fd6ff 0%,
      #9fe0ff 40%,
      #cbefff 62%,
      #7cc769 78%,
      #4f8a34 88%,
      #2f4d1b 100%
    );
  --panel-border-outer: #2f4820;
  --panel-border-highlight: rgba(116, 195, 101, 0.32);
  --panel-surface: rgba(32, 52, 28, 0.94);
  --panel-surface-alt: rgba(24, 39, 22, 0.94);
  --viewport-border: #3d5a27;
  --viewport-shadow: 0 22px 0 rgba(15, 24, 12, 0.55), 0 30px 64px rgba(10, 16, 9, 0.6);
  --time-phase: 0;
  --hud-panel-border: rgba(71, 111, 54, 0.75);
  --hud-panel-shadow: 0 14px 0 rgba(18, 26, 14, 0.6), 0 26px 56px rgba(8, 14, 7, 0.6);
  --hud-panel-bg: rgba(38, 60, 32, 0.94);
  --hud-panel-bg-alt: rgba(28, 46, 26, 0.94);
  --hud-heart-color: #ff6767;
  --hud-heart-glow: rgba(255, 103, 103, 0.45);
  --hud-bubble-color: #7ad4ff;
  --hud-bubble-color-rgb: 122, 212, 255;
  --hud-bubble-highlight: rgba(255, 255, 255, 0.88);
  --hud-score-gradient: linear-gradient(180deg, rgba(40, 66, 32, 0.95), rgba(28, 44, 26, 0.95));
  --hud-score-text: #f6fbe9;
  --hud-progress-track: rgba(116, 195, 101, 0.28);
  --hud-progress-glow: rgba(210, 255, 168, 0.55);
  font-size: 16px;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

[hidden] {
  display: none !important;
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

[data-hint] {
  position: relative;
}

[data-hint]::after {
  content: attr(data-hint);
  position: absolute;
  left: 50%;
  bottom: calc(100% + 12px);
  transform: translateX(-50%);
  padding: 0.35rem 0.55rem;
  background: var(--tooltip-bg);
  color: var(--tooltip-text);
  border-radius: 6px;
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.45);
  opacity: 0;
  pointer-events: none;
  white-space: nowrap;
  font-size: 0.75rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  transition: opacity 0.2s ease, transform 0.2s ease;
  z-index: 150;
}

[data-hint]:hover::after,
[data-hint]:focus-visible::after {
  opacity: 1;
  transform: translateX(-50%) translateY(-4px);
}

[data-hint]::before {
  content: '';
  position: absolute;
  left: 50%;
  bottom: calc(100% + 6px);
  transform: translateX(-50%);
  width: 10px;
  height: 10px;
  background: var(--tooltip-bg);
  opacity: 0;
  clip-path: polygon(50% 100%, 0 0, 100% 0);
  transition: opacity 0.2s ease, transform 0.2s ease;
  z-index: 149;
}

[data-hint]:hover::before,
[data-hint]:focus-visible::before {
  opacity: 1;
  transform: translateX(-50%) translateY(-2px);
}

body {
  font-family: 'Exo 2', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--page-background);
  background-color: var(--bg-dark);
  color: var(--text-primary);
  min-height: 100vh;
  display: grid;
  grid-template-rows: 1fr auto;
  transition: background 1s ease;
  overflow-x: hidden;
}

body.theme-grassland {
  --primary: #63d483;
  --glow: 0 0 14px rgba(99, 212, 131, 0.5);
  --dimension-primary: #63d483;
  --dimension-glow: rgba(99, 212, 131, 0.4);
  --hud-panel-border: rgba(82, 132, 60, 0.85);
  --hud-panel-shadow: 0 14px 0 rgba(18, 28, 16, 0.55), 0 24px 48px rgba(10, 16, 9, 0.5);
  --hud-panel-bg: rgba(40, 66, 34, 0.94);
  --hud-panel-bg-alt: rgba(32, 54, 30, 0.94);
  --hud-bubble-color: #7ad4ff;
  --hud-bubble-color-rgb: 122, 212, 255;
  --hud-progress-track: rgba(116, 195, 101, 0.3);
  --hud-progress-glow: rgba(210, 255, 168, 0.55);
}

body.theme-netherite {
  --primary: #ff7043;
  --glow: 0 0 14px rgba(255, 112, 67, 0.55);
  --dimension-primary: #ff7043;
  --dimension-glow: rgba(255, 112, 67, 0.45);
  --hud-panel-border: rgba(134, 56, 32, 0.85);
  --hud-panel-shadow: 0 14px 0 rgba(62, 24, 16, 0.55), 0 24px 48px rgba(40, 16, 10, 0.5);
  --hud-panel-bg: rgba(68, 32, 22, 0.94);
  --hud-panel-bg-alt: rgba(54, 26, 18, 0.94);
  --hud-heart-glow: rgba(255, 135, 102, 0.55);
  --hud-bubble-color: #ffb27d;
  --hud-bubble-color-rgb: 255, 178, 125;
  --hud-bubble-highlight: rgba(255, 239, 220, 0.9);
  --hud-score-gradient: linear-gradient(180deg, rgba(68, 32, 22, 0.95), rgba(48, 22, 16, 0.95));
  --hud-progress-track: rgba(255, 178, 125, 0.32);
  --hud-progress-glow: rgba(255, 214, 168, 0.55);
}

body.game-active {
  grid-template-rows: 1fr;
  min-height: 100vh;
}

.manu-logo,
#logo {
  position: fixed;
  inset: auto clamp(12px, 3vw, 28px) clamp(12px, 3vw, 28px) auto;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  padding: 0.25rem 0.5rem;
  color: var(--dimension-primary);
  font-family: 'Chakra Petch', 'Exo 2', sans-serif;
  font-size: clamp(0.65rem, 1.2vw, 0.85rem);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  text-shadow: 0 0 10px rgba(0, 0, 0, 0.65), 0 0 18px var(--dimension-glow);
  z-index: 120;
  opacity: var(--logo-opacity);
  transition: transform 0.35s ease, opacity 0.3s ease;
  cursor: default;
}

.manu-logo:hover,
.manu-logo:focus-visible,
#logo:hover,
#logo:focus-visible {
  transform: scale(1.05);
  opacity: 1;
  outline: none;
}

.manu-logo__glyph {
  display: block;
  width: clamp(var(--logo-size-min), 9vw, var(--logo-size-max));
  height: auto;
  filter: drop-shadow(0 0 10px rgba(7, 135, 240, 0.4));
  transition: transform 0.35s ease, filter 0.35s ease;
}

.manu-logo:hover .manu-logo__glyph,
.manu-logo:focus-visible .manu-logo__glyph,
#logo:hover .manu-logo__glyph,
#logo:focus-visible .manu-logo__glyph {
  filter: drop-shadow(0 0 20px var(--dimension-glow));
}

.manu-logo__label {
  color: var(--text-secondary);
  letter-spacing: 0.32em;
  text-shadow: 0 0 12px rgba(0, 0, 0, 0.55);
  white-space: nowrap;
}

@media (max-width: 768px) {
  .manu-logo {
    gap: 0.35rem;
  }

  .manu-logo__glyph {
    width: clamp(32px, 10vw, 56px);
  }
}

body:not(.game-active) .main-layout,
body:not(.game-active) .footer,
body:not(.game-active) .objectives-panel,
body:not(.game-active) .side-panel,
body:not(.game-active) .side-panel__scrim,
body:not(.game-active) .manu-logo {
  display: none;
}

.landing-modal {
  padding: clamp(2rem, 6vw, 4rem);
  background: radial-gradient(circle at 50% 20%, rgba(73, 242, 255, 0.2), rgba(5, 9, 18, 0.9));
  overflow: hidden;
}

.landing-modal__background {
  position: absolute;
  inset: -15% -15%;
  pointer-events: none;
  z-index: 0;
}

.landing-modal__stars {
  position: absolute;
  inset: 0;
  background-image:
    radial-gradient(2px 2px at 18% 22%, rgba(255, 255, 255, 0.8), transparent 55%),
    radial-gradient(1.5px 1.5px at 74% 38%, rgba(73, 242, 255, 0.85), transparent 60%),
    radial-gradient(1px 1px at 32% 68%, rgba(247, 183, 51, 0.65), transparent 60%),
    radial-gradient(1.2px 1.2px at 86% 72%, rgba(255, 255, 255, 0.75), transparent 60%),
    radial-gradient(1.1px 1.1px at 44% 44%, rgba(73, 242, 255, 0.65), transparent 60%),
    radial-gradient(0.8px 0.8px at 12% 74%, rgba(255, 255, 255, 0.6), transparent 50%);
  background-size: 220px 220px;
  animation: landing-star-drift 52s linear infinite;
  opacity: 0.6;
  transform-origin: center;
}

.landing-modal__stars--front {
  animation-duration: 28s;
  opacity: 0.9;
  transform: scale(1.05);
}

.landing-modal__stars--back {
  animation-duration: 68s;
  filter: blur(0.5px);
  opacity: 0.45;
  transform: scale(1.15);
}

.landing-modal__glow {
  position: absolute;
  inset: -20% -10% -15% -10%;
  background: radial-gradient(circle at 20% 25%, rgba(73, 242, 255, 0.35), transparent 55%),
    radial-gradient(circle at 80% 15%, rgba(247, 183, 51, 0.28), transparent 60%),
    radial-gradient(circle at 50% 70%, rgba(73, 242, 255, 0.18), transparent 65%);
  mix-blend-mode: screen;
  opacity: 0.65;
  animation: landing-glow-pulse 18s ease-in-out infinite;
}

.landing-modal__content {
  position: relative;
  z-index: 1;
  max-width: clamp(720px, 86vw, 980px);
  padding: clamp(2.5rem, 5vw, 3.5rem);
  border-radius: 28px;
  background: rgba(5, 13, 26, 0.82);
  border: 1px solid rgba(73, 242, 255, 0.3);
  box-shadow: 0 40px 100px rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(20px);
  overflow: hidden;
}

.landing-modal__content::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  border: 1px solid rgba(255, 255, 255, 0.05);
  opacity: 0.8;
  pointer-events: none;
}

.landing-modal__layout {
  position: relative;
  display: grid;
  gap: clamp(2rem, 4vw, 2.75rem);
  text-align: center;
}

.landing-modal__header {
  display: grid;
  gap: 1rem;
  justify-items: center;
}

.landing-modal__eyebrow {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.32em;
  font-size: clamp(0.75rem, 1.6vw, 0.85rem);
  color: rgba(255, 255, 255, 0.75);
}

.landing-modal__title {
  font-family: 'Chakra Petch', sans-serif;
  font-size: clamp(2.2rem, 6vw, 3.6rem);
  line-height: 1.1;
  text-transform: uppercase;
  letter-spacing: 0.16em;
  background: linear-gradient(120deg, #ffffff 10%, #49f2ff 40%, #f7b733 60%, #ffffff 90%);
  background-size: 220% 220%;
  -webkit-background-clip: text;
  color: transparent;
  animation: landing-title-shimmer 7s ease-in-out infinite;
}

.landing-modal__tagline {
  max-width: 38ch;
  color: rgba(242, 245, 250, 0.78);
  font-size: clamp(1rem, 1.9vw, 1.15rem);
  line-height: 1.6;
}

.landing-modal__actions {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.9rem;
  margin-top: 0.75rem;
}

.landing-modal__start {
  font-size: 1rem;
  padding: 0.85rem 1.75rem;
  box-shadow: 0 18px 40px rgba(73, 242, 255, 0.35);
}

.landing-modal__howto {
  border-color: rgba(73, 242, 255, 0.45);
  color: var(--text-primary);
  padding: 0.85rem 1.75rem;
  background: rgba(6, 18, 34, 0.6);
  transition: background 0.3s ease, border-color 0.3s ease;
}

.landing-modal__howto:hover,
.landing-modal__howto:focus-visible {
  background: rgba(73, 242, 255, 0.12);
  border-color: rgba(247, 183, 51, 0.7);
}

.landing-modal__body {
  display: grid;
  gap: clamp(1.5rem, 3vw, 1.85rem);
}

.landing-modal__signin {
  margin: 0;
  width: 100%;
}

.landing-modal__highlights {
  list-style: none;
  display: grid;
  gap: 0.9rem;
  padding: 1.6rem 1.75rem;
  border-radius: 20px;
  border: 1px solid rgba(73, 242, 255, 0.18);
  background: linear-gradient(150deg, rgba(6, 18, 34, 0.85), rgba(6, 18, 34, 0.65));
  box-shadow: 0 24px 50px rgba(0, 0, 0, 0.38);
  text-align: left;
}

.landing-modal__highlights li {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  color: rgba(242, 245, 250, 0.78);
  line-height: 1.6;
  font-size: 0.95rem;
}

.landing-modal__highlights li::before {
  content: '✦';
  color: var(--accent-strong);
  font-size: 0.9rem;
  margin-top: 0.1rem;
}

@media (min-width: 900px) {
  .landing-modal__layout {
    grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
    align-items: center;
    text-align: left;
  }

  .landing-modal__header {
    justify-items: flex-start;
    gap: 1.1rem;
  }

  .landing-modal__actions {
    justify-content: flex-start;
  }
}

@keyframes landing-star-drift {
  0% {
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% {
    transform: translate3d(3%, -4%, 0) scale(1.02);
  }
  100% {
    transform: translate3d(-2%, 5%, 0) scale(1);
  }
}

@keyframes landing-title-shimmer {
  0%,
  100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

@keyframes landing-glow-pulse {
  0%,
  100% {
    opacity: 0.55;
    transform: scale(1);
  }
  50% {
    opacity: 0.85;
    transform: scale(1.04);
  }
}


.background-sheen {
  display: none;
}

body::after {
  content: none;
}

@keyframes pulse {
  0%,
  100% {
    transform: scale(1);
    opacity: 0.6;
  }
  50% {
    transform: scale(1.08);
    opacity: 0.85;
  }
}

@keyframes overlay-pop {
  0% {
    opacity: 0;
    transform: translateY(-18px);
  }
  60% {
    opacity: 1;
    transform: translateY(4px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes meter-damage {
  0% {
    transform: scale(1);
    filter: saturate(1);
  }
  45% {
    transform: scale(0.86);
    filter: saturate(0.5);
  }
  100% {
    transform: scale(1);
    filter: saturate(1);
  }
}

@keyframes meter-regen {
  0% {
    transform: scale(0.9);
    filter: saturate(0.7);
  }
  50% {
    transform: scale(1.1);
    filter: saturate(1.15);
  }
  100% {
    transform: scale(1);
    filter: saturate(1);
  }
}

@keyframes meter-critical {
  0%,
  100% {
    transform: scale(1);
    filter: brightness(1);
  }
  50% {
    transform: scale(1.12);
    filter: brightness(1.35);
  }
}

@keyframes meter-low {
  0%,
  100% {
    transform: translateY(0);
    opacity: 1;
  }
  50% {
    transform: translateY(-2px);
    opacity: 0.7;
  }
}

@keyframes meter-drowning {
  0% {
    transform: scale(1);
  }
  45% {
    transform: scale(0.8) rotate(-6deg);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes drowning-flash {
  0% {
    opacity: 0;
  }
  40% {
    opacity: 0.6;
  }
  100% {
    opacity: 0;
  }
}

.logo-area {
  display: flex;
  align-items: center;
  gap: 1.25rem;
}

.brand-logo {
  width: clamp(140px, 18vw, 200px);
  height: auto;
  filter: drop-shadow(0 12px 30px rgba(73, 242, 255, 0.25));
}

.brand-copy {
  display: grid;
  gap: 0.2rem;
}

.objectives-panel {
  display: grid;
  gap: clamp(1.25rem, 2.2vw, 1.75rem);
  align-content: start;
  align-self: start;
  padding: clamp(1.35rem, 2.4vw, 1.9rem);
  border-radius: 12px;
  background: linear-gradient(180deg, var(--panel-surface), var(--panel-surface-alt));
  border: 3px solid var(--panel-border-outer);
  box-shadow: var(--viewport-shadow), inset 0 0 0 2px var(--panel-border-highlight);
  backdrop-filter: none;
  position: sticky;
  top: clamp(1rem, 3vh, 2.25rem);
  max-height: calc(100vh - clamp(2rem, 6vh, 3.5rem));
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: rgba(122, 183, 86, 0.55) transparent;
}

.objectives-panel::-webkit-scrollbar {
  width: 6px;
}

.objectives-panel::-webkit-scrollbar-thumb {
  background: rgba(122, 183, 86, 0.55);
  border-radius: 999px;
}

.objectives-panel__brand {
  align-items: flex-start;
}

.objectives-panel__brand .brand-logo {
  width: clamp(120px, 16vw, 180px);
}

.objectives-panel__section {
  display: grid;
  gap: 0.75rem;
}

.objectives-panel__header h2 {
  font-family: 'Press Start 2P', 'Chakra Petch', sans-serif;
  font-size: 0.85rem;
  letter-spacing: 0.28em;
  text-transform: uppercase;
  color: #f1f6e9;
  text-shadow: 0 0 6px rgba(9, 16, 9, 0.6);
}

.objectives-panel__header--hint h2 {
  color: #ffe28f;
}

.objectives-panel__card {
  background: linear-gradient(180deg, rgba(42, 68, 36, 0.96), rgba(30, 50, 28, 0.96));
  border-radius: 10px;
  border: 2px solid rgba(71, 111, 54, 0.85);
  padding: 1.1rem 1.25rem;
  box-shadow: 0 10px 0 rgba(15, 25, 12, 0.55);
  backdrop-filter: none;
  display: grid;
  gap: 0.75rem;
  color: #f6fbe9;
}

.objectives-panel__card--primer {
  padding: 1.25rem 1.4rem;
  background: linear-gradient(180deg, rgba(58, 97, 42, 0.96), rgba(40, 67, 32, 0.96));
  border: 2px solid rgba(112, 168, 79, 0.75);
  gap: 1.1rem;
}

.primer-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 1.15rem;
}

.primer-list__item {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: start;
  gap: 0.9rem;
}

.primer-list__icon {
  display: grid;
  place-items: center;
  width: 2.6rem;
  height: 2.6rem;
  border-radius: 10px;
  background: rgba(122, 183, 86, 0.22);
  box-shadow: inset 0 0 0 1px rgba(122, 183, 86, 0.5), 0 8px 18px rgba(18, 28, 14, 0.4);
  color: #ffe28f;
  font-size: 1.35rem;
}

.primer-list__content h3 {
  margin: 0 0 0.35rem;
  font-size: 1rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: #f8fceb;
}

.primer-list__content p {
  margin: 0;
  font-size: 0.9rem;
  line-height: 1.6;
  color: rgba(245, 255, 231, 0.78);
}

.primer-list__content strong {
  color: #ffe28f;
}

.objectives-panel__card--hint {
  padding: 0;
  background: transparent;
  border: none;
  box-shadow: none;
}

.objectives-panel__header--primer h2 {
  color: var(--text-primary);
}

.logo-area h1 {
  font-family: 'Chakra Petch', sans-serif;
  font-weight: 700;
  letter-spacing: 0.2rem;
  text-transform: uppercase;
  margin-bottom: 0.1rem;
  color: var(--accent);
}

.logo-area .subtitle {
  font-size: 0.85rem;
  text-transform: uppercase;
  color: var(--text-secondary);
  letter-spacing: 0.25rem;
}

.user-identity {
  display: grid;
  gap: 0.1rem;
  text-align: right;
  min-width: 160px;
}

.user-identity .user-name {
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent);
}

.user-identity .user-location {
  font-size: 0.75rem;
  color: var(--text-secondary);
  letter-spacing: 0.08em;
}

.craft-launcher {
  width: 46px;
  height: 46px;
  border-radius: 50%;
  border: 2px solid rgba(77, 164, 255, 0.45);
  background: radial-gradient(circle at 30% 30%, rgba(77, 164, 255, 0.32), rgba(77, 164, 255, 0.1));
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  position: relative;
  box-shadow: 0 10px 25px rgba(6, 14, 28, 0.45);
  transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
}

.craft-launcher::after {
  content: '';
  position: absolute;
  inset: -6px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(77, 164, 255, 0.1), transparent 70%);
  opacity: 0;
  transition: opacity 0.2s ease;
  pointer-events: none;
}

.craft-launcher__icon {
  width: 22px;
  height: 22px;
  position: relative;
}

.craft-launcher__icon::before,
.craft-launcher__icon::after {
  content: '';
  position: absolute;
  border-radius: 4px;
  transition: background 0.2s ease;
}

.craft-launcher__icon::before {
  width: 7px;
  height: 16px;
  background: var(--accent);
  transform: rotate(45deg) translate(6px, -2px);
  box-shadow: 0 0 10px rgba(73, 242, 255, 0.45);
}

.craft-launcher__icon::after {
  width: 16px;
  height: 7px;
  background: var(--accent-strong);
  transform: rotate(45deg) translate(-2px, -6px);
  box-shadow: 0 0 12px rgba(247, 183, 51, 0.45);
}

.craft-launcher:hover,
.craft-launcher:focus-visible {
  transform: translateY(-1px) scale(1.02);
  border-color: var(--accent);
  background: radial-gradient(circle at 40% 40%, rgba(73, 242, 255, 0.42), rgba(73, 242, 255, 0.12));
  box-shadow: 0 14px 32px rgba(73, 242, 255, 0.25);
}

.craft-launcher:focus-visible {
  outline: 2px solid rgba(73, 242, 255, 0.6);
  outline-offset: 3px;
}

.craft-launcher[data-sequence='active'] {
  border-color: var(--accent-strong);
  box-shadow: 0 0 0 3px rgba(247, 183, 51, 0.25), 0 18px 46px rgba(73, 242, 255, 0.3);
}

.craft-launcher[data-sequence='active']::after {
  opacity: 1;
}

.craft-launcher[data-sequence='active'] .craft-launcher__icon::before {
  background: var(--accent-strong);
}

.craft-launcher[data-sequence='active'] .craft-launcher__icon::after {
  background: var(--accent);
}

.leaderboard-toggle {
  display: inline-flex;
  align-items: center;
  gap: 0.85rem;
  padding: 0.65rem 1.5rem;
  border-radius: 999px;
  border: 1px solid rgba(73, 242, 255, 0.35);
  background: rgba(6, 18, 36, 0.65);
  color: var(--text-primary);
  font-family: 'Chakra Petch', sans-serif;
  font-size: 0.95rem;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  cursor: pointer;
  position: relative;
  transition: border-color 0.2s ease, background 0.2s ease, transform 0.2s ease;
  white-space: nowrap;
}

.leaderboard-toggle:hover,
.leaderboard-toggle:focus-visible {
  border-color: var(--accent);
  background: rgba(10, 26, 48, 0.85);
  transform: translateY(-1px);
}

.leaderboard-toggle:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 4px;
}

.leaderboard-toggle[disabled] {
  opacity: 0.45;
  cursor: not-allowed;
  transform: none;
}

.leaderboard-toggle__icon {
  display: inline-flex;
  flex-direction: column;
  gap: 0.28rem;
  width: 1.25rem;
}

.leaderboard-toggle__icon span {
  display: block;
  height: 0.18rem;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--accent-strong), var(--accent));
}

.leaderboard-toggle__label {
  font-weight: 600;
}

.mobile-sidebar-toggle {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
}


.status-item {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  font-weight: 600;
  letter-spacing: 0.05em;
  color: var(--text-secondary);
}

.status-item .meter {
  display: grid;
  grid-template-columns: repeat(5, minmax(0, 18px));
  gap: 0.2rem 0.35rem;
  align-items: center;
}

.status-item .meter.meter--stacked {
  justify-items: center;
}

.status-item .meter.meter--damage .heart:not(.empty),
.status-item .meter.meter--damage .bubble:not(.empty) {
  animation: meter-damage 0.6s ease;
}

.status-item .meter.meter--regen .heart:not(.empty),
.status-item .meter.meter--regen .bubble:not(.empty) {
  animation: meter-regen 0.8s ease;
}

.status-item .meter.meter--critical .heart:not(.empty) {
  animation: meter-critical 1.1s ease-in-out infinite;
}

.status-item .meter.meter--low .bubble:not(.empty) {
  animation: meter-low 1.2s ease-in-out infinite;
}

.status-item .meter.meter--drowning .bubble {
  animation: meter-drowning 0.75s ease;
}


.hud-hearts {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: 0.45rem;
  align-items: flex-start;
}

.hud-hearts__row {
  display: flex;
  gap: 0.35rem;
  flex-wrap: wrap;
}

.hud-hearts .heart-icon {
  width: 24px;
  height: 24px;
  filter: drop-shadow(0 0 6px var(--hud-heart-glow));
  transition: transform 0.3s ease, filter 0.3s ease;
}

.hud-hearts .heart-icon.is-empty {
  filter: none;
  opacity: 0.28;
}

.hud-hearts .heart-icon.is-partial {
  opacity: 0.7;
}

.heart-icon__outline {
  fill: rgba(255, 255, 255, 0.1);
  stroke: rgba(255, 255, 255, 0.45);
  stroke-width: 1.05;
}

.heart-icon__fill {
  fill: var(--hud-heart-color);
  transition: fill-opacity 0.3s ease;
}

.hud-hearts.is-damaged .heart-icon {
  animation: heart-hit 0.6s ease;
  animation-delay: calc(var(--heart-index, 0) * 45ms);
}

.hud-hearts.is-healing .heart-icon {
  animation: heart-regen 0.8s ease;
  animation-delay: calc(var(--heart-index, 0) * 45ms);
}

.hud-hearts.is-critical .heart-icon__fill {
  filter: drop-shadow(0 0 8px rgba(255, 84, 84, 0.75));
}

@keyframes heart-hit {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.22);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes heart-regen {
  0% {
    transform: scale(0.92);
  }
  50% {
    transform: scale(1.08);
  }
  100% {
    transform: scale(1);
  }
}

.hud-bubbles {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

.hud-bubbles__frame {
  display: inline-flex;
  padding: 0.55rem 0.65rem;
  border-radius: 6px;
  background: linear-gradient(180deg, rgba(8, 34, 54, 0.55), rgba(4, 22, 38, 0.6));
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.06), 0 0 16px rgba(0, 188, 255, 0.16);
}

.hud-bubbles__stack {
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
  align-items: center;
}

.bubble-indicator {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, var(--hud-bubble-highlight), rgba(var(--hud-bubble-color-rgb, 46, 199, 255), 0.35));
  box-shadow: 0 0 12px rgba(46, 199, 255, 0.45);
  opacity: var(--opacity-level, 1);
  transition: opacity 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
  will-change: transform, opacity;
}

.bubble-indicator.is-empty {
  opacity: 0.18;
  box-shadow: none;
  filter: saturate(0.4);
}

.bubble-indicator.is-partial {
  opacity: 0.45;
}

.hud-bubbles.is-losing .bubble-indicator:not(.is-empty) {
  animation: bubble-pop 0.45s ease;
  animation-delay: calc(var(--bubble-index, 0) * 40ms);
}

.hud-bubbles.is-low .bubble-indicator:not(.is-empty) {
  box-shadow: 0 0 14px rgba(255, 189, 92, 0.45);
  filter: saturate(1.1);
}

.hud-bubbles.is-gaining .bubble-indicator:not(.is-empty) {
  animation: bubble-rise 0.6s ease;
  animation-delay: calc(var(--bubble-index, 0) * 40ms);
}

.hud-bubbles.is-drowning .bubble-indicator {
  animation: bubble-alert 0.8s ease-in-out infinite alternate;
}

@keyframes bubble-pop {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.25);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes bubble-rise {
  0% {
    transform: translateY(8px);
    opacity: 0;
  }
  100% {
    transform: translateY(0);
    opacity: var(--opacity-level, 1);
  }
}

@keyframes bubble-alert {
  0% {
    box-shadow: 0 0 10px rgba(46, 199, 255, 0.35);
  }
  100% {
    box-shadow: 0 0 14px rgba(255, 92, 92, 0.55);
  }
}

.time-track {
  display: flex;
  align-items: center;
  gap: 0.45rem;
}

.time-track span {
  font-size: 0.75rem;
  color: var(--text-secondary);
  letter-spacing: 0.08em;
}

.time-track .bar {
  position: relative;
  width: 140px;
  height: 8px;
  border-radius: 999px;
  background: rgba(73, 242, 255, 0.16);
  overflow: hidden;
}

.time-track .bar::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(73, 242, 255, 0.6), rgba(247, 183, 51, 0.7));
  transform: scaleX(var(--progress, 0));
  transform-origin: left;
  transition: transform 0.3s ease;
}

.status-item::before {
  content: '';
  display: inline-block;
  width: 28px;
  height: 28px;
  border-radius: 8px;
  background: rgba(73, 242, 255, 0.18);
  border: 1px solid rgba(73, 242, 255, 0.35);
  box-shadow: inset 0 0 10px rgba(73, 242, 255, 0.3);
}

#hearts::before,
#bubbles::before,
#timeOfDay::before {
  display: none;
}

.status-item.hearts::before {
  background: radial-gradient(circle at 50% 40%, var(--danger), rgba(255, 73, 118, 0.4));
}

.status-item.bubbles::before {
  background: radial-gradient(circle at 50% 40%, var(--accent), rgba(73, 242, 255, 0.3));
}

.status-item.time::before {
  background: radial-gradient(circle at 50% 40%, var(--accent-strong), rgba(247, 183, 51, 0.4));
}

.main-layout {
  display: grid;
  grid-template-columns: minmax(240px, 320px) minmax(0, 1fr);
  gap: clamp(1rem, 2.5vw, 2rem);
  padding: clamp(1rem, 2.5vw, 2.5rem);
  height: 100%;
  align-items: start;
  position: relative;
}

body.game-active .footer,
body.game-active .side-panel,
body.game-active .objectives-panel {
  display: none;
}

body.game-active .main-layout {
  grid-template-columns: 1fr;
  padding: 0;
  height: 100vh;
}

body.game-active .primary-panel {
  border-radius: 0;
  box-shadow: none;
  border: none;
  min-height: 100vh;
  height: 100vh;
}

body.game-active #gameCanvas {
  width: 100vw;
  height: 100vh;
}

.primary-panel {
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: var(--viewport-shadow), inset 0 0 0 3px var(--panel-border-highlight);
  background: linear-gradient(180deg, rgba(58, 97, 42, 0.94), rgba(28, 47, 26, 0.96));
  border: 4px solid var(--viewport-border);
  display: grid;
  grid-template-areas: 'viewport';
  grid-template-rows: minmax(0, 1fr);
  min-height: var(--primary-panel-min-height, clamp(420px, 70vh, 820px));
  height: var(--primary-panel-min-height, auto);
  transition: min-height 0.3s ease;
}

#gameCanvas {
  grid-area: viewport;
  width: 100%;
  height: 100%;
  display: block;
  background: linear-gradient(180deg, rgba(143, 214, 255, 0.95) 0%, rgba(128, 206, 255, 0.88) 36%, rgba(118, 190, 104, 0.95) 76%, rgba(88, 132, 62, 0.98) 100%);
}

#gameCanvas:focus {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

.game-briefing {
  position: absolute;
  top: clamp(1.5rem, 5vh, 3rem);
  left: 50%;
  transform: translate(-50%, 1.25rem);
  width: min(92%, 520px);
  z-index: 60;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.32s ease, transform 0.4s cubic-bezier(0.22, 0.61, 0.36, 1);
}

.game-briefing.is-visible {
  opacity: 1;
  transform: translate(-50%, 0);
  pointer-events: auto;
}

.game-briefing__content {
  background: linear-gradient(180deg, rgba(5, 12, 28, 0.94), rgba(8, 22, 40, 0.96));
  border: 1px solid rgba(73, 242, 255, 0.28);
  box-shadow: 0 28px 70px rgba(0, 0, 0, 0.45);
  border-radius: 24px;
  padding: clamp(1.25rem, 2vw, 1.75rem) clamp(1.25rem, 2.2vw, 2rem);
  display: grid;
  gap: 1.1rem;
}

.game-briefing__header {
  display: grid;
  gap: 0.25rem;
}

.game-briefing__eyebrow {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.26em;
  color: var(--accent);
  font-weight: 600;
}

.game-briefing__title {
  font-size: clamp(1.25rem, 2.4vw, 1.8rem);
  font-weight: 700;
  color: var(--text-primary);
}

.game-briefing__steps {
  margin-left: 1.1rem;
  display: grid;
  gap: 0.65rem;
  font-size: 0.95rem;
  color: var(--text-secondary);
}

.game-briefing__steps li {
  line-height: 1.55;
}

.game-briefing__controls {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 0.75rem;
  padding: 0.85rem 1rem;
  border-radius: 18px;
  background: rgba(9, 24, 42, 0.72);
  border: 1px solid rgba(73, 242, 255, 0.18);
}

.game-briefing__label {
  display: block;
  font-size: 0.75rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(242, 245, 250, 0.68);
  margin-bottom: 0.35rem;
}

.game-briefing__keys {
  font-family: 'Chakra Petch', 'Exo 2', sans-serif;
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--text-primary);
  display: inline-flex;
  gap: 0.35rem;
}

.game-briefing__dismiss {
  justify-self: start;
  border: none;
  border-radius: 999px;
  padding: 0.65rem 1.4rem;
  background: linear-gradient(120deg, var(--accent) 0%, var(--primary) 100%);
  color: #02070f;
  font-weight: 700;
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.16em;
  cursor: pointer;
  box-shadow: 0 18px 36px rgba(0, 0, 0, 0.35);
  transition: transform 0.18s ease, box-shadow 0.18s ease, opacity 0.18s ease;
}

.game-briefing__dismiss:hover,
.game-briefing__dismiss:focus-visible {
  transform: translateY(-1px);
  box-shadow: 0 26px 50px rgba(0, 0, 0, 0.4);
  outline: none;
}

.game-briefing__dismiss:focus-visible {
  opacity: 0.95;
}

@media (max-width: 720px) {
  .game-briefing {
    top: clamp(1rem, 4vh, 2rem);
    width: min(96%, 420px);
  }

  .game-briefing__content {
    gap: 0.9rem;
  }

  .game-briefing__controls {
    grid-template-columns: minmax(0, 1fr);
  }

  .game-briefing__keys {
    font-size: 0.85rem;
  }

  .primer-list__item {
    grid-template-columns: minmax(0, 1fr);
    gap: 0.75rem;
  }

  .primer-list__icon {
    width: 2.4rem;
    height: 2.4rem;
    font-size: 1.2rem;
  }
}


.overlay-panel {
  position: relative;
  padding: 0;
  color: var(--text-secondary);
  font-size: 0.9rem;
  line-height: 1.5;
  display: grid;
  gap: 0.4rem;
  opacity: 0;
  transform: translateY(-8px);
  pointer-events: none;
  transition: opacity 0.35s ease, transform 0.35s ease;
}

.overlay-panel.visible {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.overlay-panel.pop {
  animation: overlay-pop 0.45s ease;
}

.overlay-panel strong {
  color: var(--accent);
  font-weight: 700;
}

.overlay-panel ul {
  list-style: none;
  display: grid;
  gap: 0.35rem;
  padding-left: 0.75rem;
}

.overlay-panel li {
  position: relative;
  color: var(--text-primary);
}

.overlay-panel li::before {
  content: '';
  position: absolute;
  left: -0.75rem;
  top: 0.55rem;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--accent-strong);
  box-shadow: 0 0 8px rgba(247, 183, 51, 0.6);
}

.overlay-panel__heading {
  display: grid;
  gap: 0.25rem;
}

.overlay-panel__description {
  font-size: 0.85rem;
  color: var(--text-secondary);
  line-height: 1.45;
}

.overlay-panel__tasks {
  display: grid;
  gap: 0.4rem;
}

.overlay-panel__subheading {
  font-size: 0.7rem;
  letter-spacing: 0.24em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.58);
}

.overlay-panel__task-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.35rem;
}

.overlay-panel__task-list li {
  padding-left: 1.1rem;
  color: var(--text-primary);
}

.overlay-panel__task-list li::before {
  left: 0;
  top: 0.5rem;
  width: 0.45rem;
  height: 0.45rem;
  background: rgba(73, 242, 255, 0.4);
  box-shadow: 0 0 10px rgba(73, 242, 255, 0.35);
}

.objective-checklist {
  display: grid;
  gap: 0.55rem;
  margin-top: 0.45rem;
}

.objective-checklist__title {
  font-size: 0.72rem;
  letter-spacing: 0.26em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.64);
}

.objective-checklist__list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.45rem;
}

.objective-item {
  position: relative;
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: center;
  gap: 0.55rem;
  padding: 0.55rem 0.75rem;
  background: rgba(9, 20, 36, 0.45);
  border-radius: 16px;
  overflow: visible;
  transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
}

.objective-item::before {
  content: none;
}

.objective-item__status {
  display: grid;
  place-items: center;
  width: 1.65rem;
  height: 1.65rem;
  border-radius: 999px;
  border: 1px solid rgba(73, 242, 255, 0.45);
  font-size: 0.95rem;
  font-weight: 700;
  letter-spacing: 0.08em;
  color: var(--accent);
  background: rgba(73, 242, 255, 0.12);
  box-shadow: inset 0 0 12px rgba(73, 242, 255, 0.25);
  transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}

.objective-item__label {
  font-size: 0.9rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  color: var(--text-primary);
}

.objective-item--complete {
  background: rgba(73, 242, 255, 0.12);
  box-shadow: 0 16px 32px rgba(0, 196, 255, 0.16);
}

.objective-item--complete .objective-item__status {
  border-color: transparent;
  background: var(--accent);
  color: #031222;
  box-shadow: 0 0 16px rgba(73, 242, 255, 0.4);
}

.objective-item--complete .objective-item__label {
  color: var(--accent);
}

.objective-item--celebrate {
  transform: translateY(-2px);
}

.objective-item__confetti-piece {
  position: absolute;
  top: 50%;
  left: 1.4rem;
  width: 6px;
  height: 6px;
  border-radius: 2px;
  background: hsl(var(--hue, 200), 85%, 62%);
  opacity: 0;
  pointer-events: none;
  transform: translate(-50%, -50%) scale(1);
  animation: objective-confetti-piece 0.8s ease-out forwards;
}

@keyframes objective-confetti-piece {
  0% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(calc(-50% + var(--offset-x)), calc(-50% + var(--offset-y))) scale(0.6);
  }
}

.score-overlay {
  position: relative;
  display: grid;
  gap: 0.4rem;
  padding: 1rem 1.25rem;
  border-radius: 8px;
  background: var(--hud-score-gradient);
  border: 1px solid rgba(77, 164, 255, 0.18);
  box-shadow: 0 24px 50px rgba(4, 10, 24, 0.55);
  backdrop-filter: blur(12px);
  color: var(--hud-score-text);
  min-width: 240px;
  z-index: 6;
  pointer-events: none;
  transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.3s ease;
}

.score-overlay__label {
  text-transform: uppercase;
  letter-spacing: 0.32em;
  font-size: 0.72rem;
  color: rgba(255, 255, 255, 0.7);
}

.score-overlay__value {
  font-size: clamp(1.6rem, 3vw, 1.75rem);
  font-weight: 700;
  color: var(--hud-score-text);
  text-shadow: 0 10px 24px rgba(0, 0, 0, 0.55);
  font-variant-numeric: tabular-nums;
  line-height: 1;
}

.score-overlay__value--ready {
  display: inline-flex;
  gap: 0.15em;
}

.score-digit-slot {
  position: relative;
  display: inline-block;
  width: var(--score-digit-width, 0.72em);
  height: 1.1em;
  perspective: 700px;
}

.score-digit {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  transform-style: preserve-3d;
  backface-visibility: hidden;
  will-change: transform, opacity;
}

.score-digit--enter {
  transform-origin: center bottom;
  animation: score-digit-flip-in 0.58s cubic-bezier(0.24, 0.74, 0.43, 1) forwards;
  animation-delay: calc(var(--digit-index, 0) * 45ms);
}

.score-digit--exit {
  transform-origin: center top;
  animation: score-digit-flip-out 0.48s cubic-bezier(0.55, 0.09, 0.68, 0.53) forwards;
  animation-delay: calc(var(--digit-index, 0) * 45ms);
}

@keyframes score-digit-flip-in {
  0% {
    transform: rotateX(-90deg);
    opacity: 0;
  }
  55% {
    transform: rotateX(12deg);
    opacity: 1;
  }
  100% {
    transform: rotateX(0deg);
    opacity: 1;
  }
}

@keyframes score-digit-flip-out {
  0% {
    transform: rotateX(0deg);
    opacity: 1;
  }
  100% {
    transform: rotateX(90deg);
    opacity: 0;
  }
}

.score-overlay__breakdown {
  list-style: none;
  display: grid;
  gap: 0.35rem;
  font-size: 0.85rem;
  line-height: 1.3;
  padding: 0;
  margin: 0;
}

.score-overlay__breakdown li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.5rem;
}

.score-overlay__metric-label {
  font-size: 0.78rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.6);
}

.score-overlay__metric-label::after {
  content: ':';
  margin-left: 0.15rem;
  opacity: 0.6;
}

.score-overlay__metric-value {
  font-weight: 600;
  color: rgba(255, 255, 255, 0.92);
  white-space: nowrap;
  display: inline-block;
  will-change: transform, opacity;
}

.score-overlay--flash {
  animation: score-overlay-flash 0.65s ease;
}

@keyframes score-overlay-flash {
  0% {
    transform: scale(1);
    box-shadow: var(--hud-panel-shadow);
  }
  35% {
    transform: scale(1.04);
    box-shadow: 0 26px 60px rgba(0, 196, 255, 0.28);
  }
  100% {
    transform: scale(1);
    box-shadow: var(--hud-panel-shadow);
  }
}

.score-overlay.flip {
  animation: score-overlay-flip 0.5s ease;
  transform-origin: center top;
}

@keyframes score-overlay-flip {
  0% {
    transform: rotateX(0deg);
  }
  40% {
    transform: rotateX(18deg);
  }
  100% {
    transform: rotateX(0deg);
  }
}

.portal-progress {
  position: relative;
  width: min(720px, 82%);
  padding: 0.9rem 1.4rem;
  background: linear-gradient(160deg, rgba(2, 22, 34, 0.78), rgba(0, 14, 26, 0.68));
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.08);
  display: none;
  align-items: center;
  gap: 1rem;
  box-shadow: 0 18px 48px rgba(0, 0, 0, 0.45), 0 0 24px rgba(0, 196, 255, 0.18);
  backdrop-filter: blur(10px);
  overflow: hidden;
}

.portal-progress.visible {
  display: grid;
  grid-template-columns: auto 1fr;
}

.portal-progress .label {
  font-size: 0.82rem;
  letter-spacing: 0.32em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.72);
  white-space: nowrap;
}

.portal-progress .bar {
  position: relative;
  display: block;
  height: 10px;
  width: 100%;
  border-radius: 999px;
  background: var(--hud-progress-track);
  overflow: hidden;
}

.portal-progress .bar::after {
  content: '';
  position: absolute;
  inset: 0;
  transform-origin: left;
  transform: scaleX(var(--progress, 0));
  background: linear-gradient(90deg, rgba(0, 212, 255, 0.95), rgba(0, 132, 230, 0.95));
  transition: transform 0.45s ease;
  border-radius: inherit;
  box-shadow: 0 0 18px var(--hud-progress-glow);
}

.portal-status {
  display: inline-flex;
  align-items: center;
  gap: 0.6rem;
  padding: 0.55rem 1.25rem;
  border-radius: 999px;
  background: rgba(6, 10, 24, 0.7);
  color: #f4f7ff;
  font-size: 0.78rem;
  font-weight: 600;
  box-shadow: 0 16px 36px rgba(0, 0, 0, 0.4), 0 0 16px rgba(90, 115, 255, 0.25);
  pointer-events: none;
  transition: background 0.35s ease, box-shadow 0.35s ease, transform 0.35s ease,
    opacity 0.35s ease, color 0.35s ease;
  backdrop-filter: blur(10px);
  max-width: min(30rem, 92vw);
}

.portal-status--flash {
  animation: portal-status-flash 0.62s ease-out;
}

.portal-status__text {
  display: flex;
  flex-direction: column;
  gap: 0.08rem;
  white-space: normal;
  line-height: 1.05;
  letter-spacing: normal;
  text-transform: none;
  max-width: 100%;
}

.portal-status__state {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.32em;
  line-height: 1;
}

.portal-status__detail {
  font-size: 0.74rem;
  letter-spacing: 0.08em;
  text-transform: none;
  opacity: 0.88;
  white-space: normal;
  line-height: 1.15;
}

.portal-status__icon {
  position: relative;
  display: inline-flex;
  width: 0.85rem;
  height: 0.85rem;
  border-radius: 50%;
  background: linear-gradient(180deg, rgba(120, 138, 255, 0.9), rgba(92, 112, 238, 0.9));
  box-shadow: 0 0 12px rgba(126, 147, 255, 0.45);
  transition: transform 0.35s ease, box-shadow 0.35s ease, background 0.35s ease,
    opacity 0.35s ease;
}

.portal-status__icon::before {
  content: '';
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  font-size: 0.66rem;
  line-height: 1;
  color: rgba(8, 12, 24, 0.82);
  text-shadow: 0 0 6px rgba(255, 255, 255, 0.35);
}

.portal-status__icon::after {
  content: '';
  position: absolute;
  inset: -6px;
  border-radius: 50%;
  border: 2px solid transparent;
  opacity: 0;
  transform: scale(0.6);
  transition: opacity 0.45s ease, transform 0.45s ease, border-color 0.45s ease;
  pointer-events: none;
}

.portal-status__icon[data-state='inactive']::after {
  opacity: 0.4;
  border-color: rgba(140, 145, 168, 0.35);
  transform: scale(0.78);
}

.portal-status__icon[data-state='inactive']::before {
  content: '⏳';
}

.portal-status__icon[data-state='building']::after {
  opacity: 0.6;
  border-color: rgba(0, 176, 255, 0.4);
  transform: scale(0.86);
}

.portal-status__icon[data-state='building']::before {
  content: '🛠️';
  font-size: 0.62rem;
}

.portal-status__icon[data-state='ready']::after {
  opacity: 0.75;
  border-color: rgba(0, 212, 255, 0.6);
  animation: portal-status-ripple 2.1s ease-in-out infinite;
}

.portal-status__icon[data-state='ready']::before {
  content: '🔥';
}

.portal-status__icon[data-state='active']::after {
  opacity: 0.95;
  border-color: rgba(204, 132, 255, 0.75);
  animation: portal-status-ripple 1.6s ease-out infinite;
}

.portal-status__icon[data-state='active']::before {
  content: '🌀';
}

.portal-status__icon[data-state='blocked']::after {
  opacity: 0.8;
  border-color: rgba(255, 110, 110, 0.65);
  transform: scale(0.9);
}

.portal-status__icon[data-state='blocked']::before {
  content: '⛔';
}

.portal-status__icon[data-state='victory']::after {
  opacity: 0.9;
  border-color: rgba(255, 193, 94, 0.7);
  animation: portal-status-ripple 2.8s ease-in-out infinite;
}

.portal-status__icon[data-state='victory']::before {
  content: '🏆';
}

@keyframes portal-status-pulse {
  0% {
    transform: scale(1);
    box-shadow: 0 0 12px rgba(140, 113, 255, 0.6), 0 0 26px rgba(84, 230, 255, 0.45);
  }
  50% {
    transform: scale(1.18);
    box-shadow: 0 0 20px rgba(140, 113, 255, 0.85), 0 0 36px rgba(84, 230, 255, 0.6);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 12px rgba(140, 113, 255, 0.6), 0 0 26px rgba(84, 230, 255, 0.45);
  }
}

@keyframes portal-status-ripple {
  0% {
    opacity: 0.05;
    transform: scale(0.6);
  }
  35% {
    opacity: 0.9;
  }
  100% {
    opacity: 0;
    transform: scale(1.25);
  }
}

@keyframes portal-status-flash {
  0% {
    transform: translateY(0) scale(0.94);
    box-shadow: 0 18px 36px rgba(0, 0, 0, 0.4), 0 0 18px rgba(90, 115, 255, 0.3);
  }
  40% {
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 26px 54px rgba(0, 0, 0, 0.45), 0 0 24px rgba(150, 90, 255, 0.55);
  }
  100% {
    transform: translateY(0) scale(1);
    box-shadow: 0 16px 36px rgba(0, 0, 0, 0.4), 0 0 16px rgba(90, 115, 255, 0.25);
  }
}

.portal-status[data-state='inactive'] {
  opacity: 0.72;
  box-shadow: 0 10px 22px rgba(0, 0, 0, 0.32), 0 0 10px rgba(120, 132, 170, 0.22);
}

.portal-status[data-state='inactive'] .portal-status__icon {
  background: linear-gradient(180deg, rgba(140, 145, 168, 0.6), rgba(90, 95, 120, 0.6));
  box-shadow: 0 0 8px rgba(130, 136, 162, 0.3);
}

.portal-status[data-state='building'] {
  opacity: 0.88;
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.38), 0 0 18px rgba(65, 180, 255, 0.3);
}

.portal-status[data-state='building'] .portal-status__icon {
  background: linear-gradient(180deg, rgba(0, 190, 255, 0.85), rgba(0, 150, 220, 0.85));
  box-shadow: 0 0 16px rgba(0, 190, 255, 0.55);
}

.portal-status[data-state='ready'] {
  background: rgba(12, 30, 52, 0.82);
  box-shadow: 0 18px 40px rgba(0, 32, 62, 0.45), 0 0 24px rgba(0, 196, 255, 0.45);
  opacity: 1;
}

.portal-status[data-state='ready'] .portal-status__icon {
  background: linear-gradient(180deg, rgba(0, 212, 255, 0.95), rgba(0, 158, 237, 0.95));
  box-shadow: 0 0 20px rgba(0, 196, 255, 0.6);
  animation: portal-status-pulse 2.4s ease-in-out infinite;
}

.portal-status[data-state='active'] {
  background: rgba(28, 8, 64, 0.88);
  box-shadow: 0 22px 48px rgba(14, 0, 35, 0.55), 0 0 32px rgba(150, 90, 255, 0.6);
  transform: translateY(-2px);
}

.portal-status[data-state='active'] .portal-status__icon {
  background: linear-gradient(180deg, rgba(204, 132, 255, 0.95), rgba(104, 208, 255, 0.95));
  animation: portal-status-pulse 1.6s ease-in-out infinite;
}

.portal-status[data-state='blocked'] {
  background: rgba(66, 10, 16, 0.9);
  color: #ffdede;
  box-shadow: 0 18px 38px rgba(32, 0, 6, 0.5), 0 0 24px rgba(240, 72, 72, 0.45);
}

.portal-status[data-state='blocked'] .portal-status__icon {
  background: linear-gradient(180deg, rgba(255, 126, 126, 0.95), rgba(200, 46, 46, 0.95));
  box-shadow: 0 0 18px rgba(255, 94, 94, 0.5);
}

.portal-status[data-state='victory'] {
  background: rgba(48, 28, 8, 0.9);
  color: #ffecc3;
  box-shadow: 0 22px 48px rgba(30, 18, 6, 0.55), 0 0 24px rgba(255, 190, 92, 0.45);
}

.portal-status[data-state='victory'] .portal-status__icon {
  background: linear-gradient(180deg, rgba(255, 203, 112, 0.95), rgba(255, 165, 62, 0.95));
  box-shadow: 0 0 20px rgba(255, 193, 94, 0.55);
}

#gameHud {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 12;
}

.hud-layer {
  position: relative;
  width: 100%;
  height: 100%;
  transition: transform 0.35s ease;
}

.hud-layer__corner {
  position: absolute;
  display: flex;
  flex-direction: column;
  gap: clamp(0.75rem, 2vw, 1.1rem);
  pointer-events: none;
}

.hud-layer__corner--top-left {
  top: clamp(1rem, 2.2vw, 1.5rem);
  left: clamp(1rem, 2.2vw, 1.5rem);
  align-items: flex-start;
}

.hud-layer__corner--top-right {
  top: clamp(1rem, 2.2vw, 1.5rem);
  right: clamp(1rem, 2.2vw, 1.5rem);
  align-items: flex-end;
}

.hud-layer__bottom {
  position: absolute;
  left: 0;
  right: 0;
  bottom: clamp(1rem, 2.2vw, 1.5rem);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(0.6rem, 1.2vw, 0.9rem);
  justify-content: center;
  pointer-events: none;
}

@media (max-width: 768px) {
  .hud-layer {
    transform: scale(0.8);
    transform-origin: top center;
  }

  .hud-layer__corner {
    gap: 0.6rem;
  }

  .hud-layer__corner--top-left,
  .hud-layer__corner--top-right {
    top: 0.85rem;
  }

  .hud-layer__corner--top-left {
    left: 0.85rem;
  }

  .hud-layer__corner--top-right {
    right: 0.85rem;
  }

  .hud-layer__bottom {
    bottom: 0.85rem;
  }
}

.hud-card {
  display: grid;
  gap: 0.75rem;
  padding: 0.9rem 1.1rem;
  border-radius: 10px;
  background: linear-gradient(180deg, var(--hud-panel-bg), var(--hud-panel-bg-alt));
  border: 2px solid var(--hud-panel-border);
  box-shadow: var(--hud-panel-shadow), inset 0 0 0 1px rgba(255, 255, 255, 0.05);
  backdrop-filter: none;
  pointer-events: auto;
  min-width: clamp(220px, 24vw, 320px);
  position: relative;
  isolation: isolate;
}

.hud-card--status {
  justify-items: flex-start;
  gap: clamp(0.75rem, 1.8vw, 1.1rem);
}

.hud-card--status .hud-status {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  align-items: flex-start;
  width: 100%;
}

.hud-card--status .craft-launcher {
  justify-self: flex-start;
}

.hud-card--actions {
  text-align: right;
  align-items: flex-end;
}

.hud-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.6rem;
  justify-content: flex-end;
}

.hud-actions .ghost {
  padding: 0.55rem 1.1rem;
}

.settings-toggle {
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
  letter-spacing: 0.08em;
}

.settings-toggle__icon {
  display: inline-flex;
  width: 20px;
  height: 20px;
  color: var(--accent);
}

.settings-toggle__icon svg {
  width: 100%;
  height: 100%;
}

.settings-toggle__label {
  display: inline-block;
}

#gameHud .leaderboard-toggle {
  padding: 0.55rem 1.35rem;
}

#gameHud .user-identity {
  min-width: 0;
}

#gameHud .score-overlay {
  position: relative;
  top: 0;
  right: 0;
  margin-bottom: clamp(0.65rem, 1.8vw, 1rem);
  pointer-events: none;
}

#gameHud .status-item {
  gap: 0.65rem;
}

#gameHud .craft-launcher {
  width: 48px;
  height: 48px;
}

#gameHud .craft-launcher .craft-launcher__icon {
  width: 24px;
  height: 24px;
}

#gameHud,
.objectives-panel {
  transition: opacity 0.35s ease;
}

body.hud-inactive #gameHud,
body.hud-inactive .objectives-panel {
  opacity: 0.12;
}

body.hud-inactive #gameHud .hud-card,
body.hud-inactive #gameHud .hud-actions button,
body.hud-inactive #gameHud .craft-launcher {
  pointer-events: none;
}

.victory-banner {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  padding: 1rem 1.25rem;
  border-radius: 18px;
  background: linear-gradient(145deg, rgba(12, 22, 42, 0.9), rgba(12, 22, 42, 0.6));
  border: 1px solid rgba(247, 183, 51, 0.35);
  color: var(--text-primary);
  box-shadow: 0 16px 45px rgba(0, 0, 0, 0.35);
  display: none;
  gap: 0.35rem;
  max-width: 260px;
  text-align: right;
}

.victory-banner.visible {
  display: grid;
}

.victory-banner h3 {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.3em;
  font-size: 0.85rem;
  color: var(--accent-strong);
}

.victory-banner p {
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.victory-celebration {
  position: fixed;
  inset: 0;
  display: none;
  place-items: center;
  z-index: 60;
  pointer-events: none;
}

.victory-celebration.active {
  display: grid;
  pointer-events: auto;
}

.victory-celebration__backdrop {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at top, rgba(16, 32, 64, 0.85), rgba(5, 12, 28, 0.94));
  backdrop-filter: blur(18px) saturate(130%);
  opacity: 0;
  transition: opacity 0.45s ease;
}

.victory-celebration.active .victory-celebration__backdrop {
  opacity: 1;
}

.victory-celebration__effects {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
}

.victory-confetti,
.victory-fireworks {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.victory-confetti__piece {
  position: absolute;
  top: -12vh;
  left: var(--x, 50%);
  width: 0.65rem;
  height: 1.35rem;
  border-radius: 8px;
  opacity: 0;
  transform: translate3d(0, 0, 0) rotate(0deg);
  background: var(--color, #ffffff);
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.2);
  animation: victoryConfettiFall var(--duration, 2.8s) linear var(--delay, 0s) forwards;
}

@keyframes victoryConfettiFall {
  0% {
    transform: translate3d(0, -6vh, 0) rotate(0deg);
    opacity: 0;
  }
  12% {
    opacity: 1;
  }
  100% {
    transform: translate3d(var(--offset-x, 0), 110vh, 0) rotate(var(--rotation, 360deg));
    opacity: 0;
  }
}

.victory-firework {
  position: absolute;
  bottom: -10vh;
  left: var(--left, 50%);
  width: 0.55rem;
  height: 3rem;
  border-radius: 999px;
  background: linear-gradient(to top, hsla(var(--hue, 210), 90%, 72%, 0.6), rgba(255, 255, 255, 0));
  box-shadow: 0 -8px 16px rgba(255, 255, 255, 0.35);
  opacity: 0;
  transform: translate(-50%, 0) scaleY(0.6);
  animation: victoryFireworkLaunch var(--duration, 1.8s) ease-out var(--delay, 0s) forwards;
}

.victory-firework__burst {
  position: absolute;
  top: 0;
  left: 50%;
  width: clamp(8rem, 26vw, 12rem);
  aspect-ratio: 1 / 1;
  transform: translate(-50%, -50%) scale(0.25);
  opacity: 0;
  border-radius: 50%;
  background: conic-gradient(
      from 0deg,
      hsla(var(--hue, 210), 100%, 72%, 0.95) 0deg,
      hsla(var(--hue, 210), 100%, 70%, 0) 55deg,
      hsla(var(--hue, 210), 100%, 70%, 0.8) 90deg,
      hsla(var(--hue, 210), 100%, 70%, 0) 140deg,
      hsla(var(--hue, 210), 100%, 72%, 0.9) 180deg,
      hsla(var(--hue, 210), 100%, 70%, 0) 230deg,
      hsla(var(--hue, 210), 100%, 70%, 0.8) 280deg,
      hsla(var(--hue, 210), 100%, 70%, 0) 330deg,
      hsla(var(--hue, 210), 100%, 72%, 0.95) 360deg
    );
  filter: drop-shadow(0 0 18px hsla(var(--hue, 210), 100%, 72%, 0.7));
  mask-image: radial-gradient(circle, rgba(0, 0, 0, 1) 45%, rgba(0, 0, 0, 0) 70%);
  transition: transform 0.55s ease-out, opacity 0.55s ease-out;
}

.victory-firework.burst .victory-firework__burst {
  opacity: 0.95;
  transform: translate(-50%, -50%) scale(1);
}

@keyframes victoryFireworkLaunch {
  0% {
    transform: translate(-50%, 10vh) scaleY(0.5);
    opacity: 0;
  }
  15% {
    opacity: 1;
  }
  100% {
    transform: translate(-50%, var(--travel, -45vh)) scaleY(1.05);
    opacity: 0;
  }
}

.victory-celebration__content {
  position: relative;
  z-index: 1;
  width: min(520px, 88vw);
  padding: clamp(2.25rem, 4vw, 2.85rem);
  border-radius: 32px;
  background: linear-gradient(160deg, rgba(12, 26, 48, 0.92), rgba(11, 20, 38, 0.82));
  border: 1px solid rgba(73, 242, 255, 0.35);
  box-shadow: 0 45px 120px rgba(0, 0, 0, 0.55);
  display: grid;
  gap: 1.5rem;
  text-align: center;
}

.victory-celebration__eyebrow {
  font-family: 'Chakra Petch', sans-serif;
  letter-spacing: 0.42em;
  text-transform: uppercase;
  font-size: 0.75rem;
  color: rgba(73, 242, 255, 0.7);
}

.victory-celebration__content h2 {
  font-size: clamp(2.35rem, 6vw, 3rem);
  color: var(--accent-strong);
  margin: 0;
}

.victory-celebration__content p {
  margin: 0;
  color: var(--text-primary);
  font-size: 1.05rem;
}

.victory-celebration__stats {
  display: grid;
  gap: 0.85rem;
  margin: 0;
}

.victory-celebration__stats div {
  display: grid;
  gap: 0.25rem;
}

.victory-celebration__stats dt {
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.26em;
  color: rgba(231, 240, 255, 0.55);
}

.victory-celebration__stats dd {
  margin: 0;
  font-size: clamp(1.35rem, 3.4vw, 1.75rem);
  font-weight: 600;
  color: var(--text-primary);
}

.victory-celebration__actions {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.75rem;
}

.victory-celebration__share-status {
  min-height: 1.25rem;
  font-size: 0.9rem;
  color: rgba(231, 240, 255, 0.7);
}

body.victory-celebration-active {
  overflow: hidden;
}

@media (max-width: 720px) {
  .victory-celebration__content {
    padding: clamp(1.75rem, 6vw, 2.25rem);
    gap: 1.25rem;
  }

  .victory-celebration__content p {
    font-size: 0.95rem;
  }

  .victory-celebration__stats dd {
    font-size: clamp(1.2rem, 5vw, 1.55rem);
  }
}

@media (prefers-reduced-motion: reduce) {
  .victory-confetti__piece,
  .victory-firework {
    animation-duration: 1ms !important;
    animation-iteration-count: 1 !important;
  }

  .victory-firework__burst {
    transition-duration: 1ms;
  }
}

.side-panel {
  position: fixed;
  top: 50%;
  right: clamp(1rem, 4vw, 1.75rem);
  transform: translate(115%, -50%);
  width: min(360px, 90vw);
  max-height: calc(100vh - clamp(3rem, 10vh, 5rem));
  display: grid;
  gap: 1.25rem;
  padding: 1.35rem 1.6rem;
  border-radius: 24px;
  background: linear-gradient(160deg, rgba(6, 14, 28, 0.95), rgba(6, 14, 28, 0.72));
  border: 1px solid rgba(73, 242, 255, 0.2);
  box-shadow: 0 30px 70px rgba(0, 0, 0, 0.55);
  backdrop-filter: blur(14px);
  overflow-y: auto;
  opacity: 0;
  pointer-events: none;
  z-index: 28;
  transition: transform 0.4s ease, opacity 0.3s ease;
}

.side-panel.open {
  transform: translate(0, -50%);
  opacity: 1;
  pointer-events: auto;
}

.side-panel-close {
  display: none;
}

.side-panel__scrim {
  position: fixed;
  inset: 0;
  background: rgba(2, 6, 16, 0.65);
  backdrop-filter: blur(4px);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 24;
}

body.sidebar-open .side-panel__scrim {
  opacity: 1;
  pointer-events: auto;
}

body.sidebar-open {
  overflow: hidden;
}

body.sidebar-open .mobile-controls {
  opacity: 0;
  pointer-events: none;
}

body.sidebar-open .player-hint {
  opacity: 0;
  pointer-events: none;
}

.side-panel section {
  background: rgba(7, 12, 25, 0.7);
  border-radius: 22px;
  padding: 1.25rem;
  border: 1px solid rgba(73, 242, 255, 0.1);
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);
  backdrop-filter: blur(10px);
}

.codex-panel ul {
  list-style: none;
  display: grid;
  gap: 0.75rem;
}

.codex-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.65rem 0.85rem;
  border-radius: 14px;
  background: linear-gradient(135deg, rgba(10, 16, 30, 0.8), rgba(10, 16, 30, 0.55));
  border: 1px solid rgba(73, 242, 255, 0.12);
  transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.codex-item strong {
  font-size: 0.95rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.codex-item span {
  font-size: 0.75rem;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--text-secondary);
}

.codex-item::before {
  content: '';
  width: 10px;
  height: 10px;
  border-radius: 50%;
  margin-right: 0.85rem;
  background: rgba(73, 242, 255, 0.35);
  box-shadow: 0 0 10px rgba(73, 242, 255, 0.35);
}

.codex-item.active {
  border-color: rgba(247, 183, 51, 0.45);
  box-shadow: 0 12px 30px rgba(247, 183, 51, 0.18);
  transform: translateY(-2px);
}

.codex-item.active::before {
  background: var(--accent-strong);
  box-shadow: 0 0 16px rgba(247, 183, 51, 0.6);
}

.codex-item.complete::before {
  background: var(--success);
  box-shadow: 0 0 16px rgba(43, 194, 107, 0.5);
}

.codex-item.locked {
  opacity: 0.45;
}

.codex-item.locked::before {
  background: rgba(255, 255, 255, 0.1);
  box-shadow: none;
}

.codex-item.final strong {
  color: var(--accent-strong);
}

.side-panel h2 {
  font-family: 'Chakra Petch', sans-serif;
  font-size: 1rem;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--accent);
  margin-bottom: 0.75rem;
}

.player-panel {
  display: grid;
  gap: 0.85rem;
}

.player-panel__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
}

.player-panel__content {
  display: grid;
  gap: 0.75rem;
}

.identity-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.65rem 1.1rem;
  border-radius: 999px;
  background: linear-gradient(135deg, rgba(73, 242, 255, 0.15), rgba(73, 242, 255, 0.05));
  border: 1px solid rgba(73, 242, 255, 0.25);
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--accent);
}

.identity-meta {
  display: grid;
  gap: 0.4rem;
  font-size: 0.8rem;
  color: var(--text-secondary);
  letter-spacing: 0.08em;
}

.gsi-container {
  display: flex;
  justify-content: center;
}

.player-panel__hint {
  font-size: 0.75rem;
  color: var(--text-secondary);
  line-height: 1.5;
}

.leaderboard-modal__content {
  max-width: min(960px, 95vw);
  width: 100%;
  text-align: left;
  display: grid;
  gap: 1.5rem;
  position: relative;
  overflow: hidden;
}

.leaderboard-modal__header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1.25rem;
}

.leaderboard-modal__eyebrow {
  text-transform: uppercase;
  letter-spacing: 0.35em;
  color: var(--text-secondary);
  font-size: 0.75rem;
  margin: 0 0 0.35rem;
}

.leaderboard-status {
  font-size: 0.8rem;
  color: var(--text-secondary);
  letter-spacing: 0.08em;
  margin: 0;
  min-height: 1.25rem;
}

.leaderboard-controls {
  display: flex;
  justify-content: flex-end;
}

.leaderboard-refresh {
  display: inline-flex;
  align-items: center;
  gap: 0.6rem;
  position: relative;
  padding-inline: 1.25rem;
}

.leaderboard-refresh[disabled] {
  opacity: 0.6;
  cursor: not-allowed;
}

.leaderboard-refresh__spinner {
  width: 1rem;
  height: 1rem;
  border-radius: 50%;
  border: 2px solid transparent;
  border-top-color: var(--accent);
  border-right-color: var(--accent);
  opacity: 0;
  animation: leaderboard-spin 0.9s linear infinite;
  transform: translateZ(0);
}

.leaderboard-refresh[data-loading='true'] .leaderboard-refresh__spinner {
  opacity: 1;
}

.leaderboard-refresh[data-loading='true'] .leaderboard-refresh__label {
  opacity: 0.65;
}

.leaderboard-table__container {
  border-radius: 24px;
  border: 1px solid rgba(73, 242, 255, 0.18);
  background: linear-gradient(145deg, rgba(8, 18, 35, 0.92), rgba(8, 18, 35, 0.72));
  box-shadow: 0 30px 70px rgba(0, 0, 0, 0.35);
  padding: clamp(1.25rem, 3vw, 1.75rem);
  overflow: auto;
  max-height: min(70vh, 620px);
  position: relative;
}

.leaderboard-table {
  width: 100%;
  border-collapse: collapse;
  min-width: 720px;
}

.leaderboard-table thead th {
  text-align: left;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.22em;
  color: var(--text-secondary);
  padding-bottom: 0.75rem;
  position: sticky;
  top: 0;
  background: rgba(8, 18, 35, 0.95);
  z-index: 1;
}

.leaderboard-table thead th:first-child {
  text-align: center;
}

.leaderboard-table thead th:nth-child(3),
.leaderboard-table thead th:nth-child(4),
.leaderboard-table thead th:nth-child(5),
.leaderboard-table thead th:nth-child(6) {
  text-align: right;
}

.leaderboard-table tbody tr {
  border-bottom: 1px solid rgba(73, 242, 255, 0.14);
  transition: background 0.2s ease;
}

.leaderboard-table tbody tr.leaderboard-row--new,
.leaderboard-table tbody tr.leaderboard-row--updated {
  position: relative;
  background-color: var(--leaderboard-row-highlight, rgba(73, 242, 255, 0.24));
}

.leaderboard-table tbody tr.leaderboard-row--player {
  border-left: 3px solid rgba(44, 182, 125, 0.6);
  background: linear-gradient(90deg, rgba(44, 182, 125, 0.18), rgba(44, 182, 125, 0));
}

.leaderboard-player-tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 0.45rem;
  padding: 0.1rem 0.45rem;
  border-radius: 999px;
  font-size: 0.55rem;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  background: rgba(44, 182, 125, 0.28);
  color: rgba(202, 255, 230, 0.92);
  box-shadow: 0 0 0 1px rgba(44, 182, 125, 0.32);
}

.leaderboard-table tbody tr.leaderboard-row--new {
  --leaderboard-row-highlight: rgba(73, 242, 255, 0.24);
  --leaderboard-row-shadow: rgba(73, 242, 255, 0.45);
}

.leaderboard-table tbody tr.leaderboard-row--updated {
  --leaderboard-row-highlight: rgba(255, 196, 106, 0.28);
  --leaderboard-row-shadow: rgba(255, 196, 106, 0.45);
}

.leaderboard-table tbody tr.leaderboard-row--animate {
  animation: leaderboard-row-flash 1.35s ease-out;
}

.leaderboard-table tbody tr:hover {
  background: rgba(73, 242, 255, 0.08);
}

.leaderboard-table tbody tr:last-child {
  border-bottom: none;
}

.leaderboard-table th,
.leaderboard-table td {
  padding: 0.65rem 0.85rem;
  vertical-align: middle;
}

.leaderboard-table td {
  font-size: 0.85rem;
  letter-spacing: 0.04em;
}

.leaderboard-table td strong {
  font-size: 0.95rem;
  letter-spacing: 0.08em;
  color: var(--text-primary);
}

.leaderboard-col-rank {
  width: 3rem;
  font-family: 'Chakra Petch', sans-serif;
  color: var(--accent-strong);
}

.leaderboard-sortable {
  cursor: pointer;
  padding-right: 1.75rem;
}

.leaderboard-sortable:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 4px;
}

.leaderboard-sortable::after {
  content: '';
  position: absolute;
  right: 0.75rem;
  top: 50%;
  width: 0.55rem;
  height: 0.55rem;
  border-right: 2px solid var(--accent);
  border-bottom: 2px solid var(--accent);
  transform: translateY(-50%) rotate(45deg);
  opacity: 0;
  transition: opacity 0.2s ease, transform 0.2s ease;
}

.leaderboard-sortable[data-sort-direction='asc']::after {
  opacity: 1;
  transform: translateY(-50%) rotate(-135deg);
}

.leaderboard-sortable[data-sort-direction='desc']::after {
  opacity: 1;
  transform: translateY(-50%) rotate(45deg);
}

.leaderboard-sortable[data-sort-direction='asc'],
.leaderboard-sortable[data-sort-direction='desc'] {
  color: var(--accent);
}

.leaderboard-table tbody td {
  color: rgba(242, 245, 250, 0.78);
}

.leaderboard-table tbody td:nth-child(1) {
  text-align: center;
}

.leaderboard-table tbody td:nth-child(3),
.leaderboard-table tbody td:nth-child(4),
.leaderboard-table tbody td:nth-child(5),
.leaderboard-table tbody td:nth-child(6) {
  text-align: right;
}

.leaderboard-table tbody td[data-cell='location'] {
  font-size: 0.75rem;
  color: var(--text-secondary);
}

.leaderboard-table tbody td[data-cell='dimensions'] {
  white-space: normal;
}

.leaderboard-dimension-count {
  display: block;
  font-weight: 600;
}

.leaderboard-dimension-list {
  display: block;
  margin-top: 0.15rem;
  font-size: 0.75rem;
  line-height: 1.2;
  color: rgba(245, 247, 251, 0.7);
}

.leaderboard-dimension-badges {
  margin: 0.2rem 0 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-wrap: wrap;
  gap: 0.25rem 0.4rem;
}

.leaderboard-dimension-badges__item {
  margin: 0;
}

.leaderboard-dimension-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  padding: 0.15rem 0.55rem;
  border-radius: 999px;
  background: rgba(245, 247, 251, 0.08);
  font-size: 0.72rem;
  line-height: 1.1;
  color: rgba(245, 247, 251, 0.88);
  letter-spacing: 0.01em;
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.05);
}

.leaderboard-dimension-badge__icon {
  font-size: 0.9rem;
  transform: translateY(-1px);
}

.leaderboard-dimension-badge__label {
  white-space: nowrap;
}

.leaderboard-dimension-badges__item--empty .leaderboard-dimension-badge {
  opacity: 0.6;
}

.leaderboard-table tbody td[data-cell='updated'] {
  font-size: 0.72rem;
  color: rgba(242, 245, 250, 0.6);
}

@keyframes leaderboard-row-flash {
  0% {
    background-color: var(--leaderboard-row-highlight, rgba(73, 242, 255, 0.24));
    box-shadow: 0 0 0 0 var(--leaderboard-row-shadow, rgba(73, 242, 255, 0.45));
  }
  55% {
    background-color: rgba(73, 242, 255, 0.08);
    box-shadow: 0 0 0 14px rgba(73, 242, 255, 0);
  }
  100% {
    background-color: transparent;
    box-shadow: 0 0 0 0 rgba(73, 242, 255, 0);
  }
}

@media (prefers-reduced-motion: reduce) {
  .leaderboard-table tbody tr.leaderboard-row--animate {
    animation: none;
  }
}

.leaderboard-table__container[data-empty='true'] .leaderboard-table {
  display: none;
}

.leaderboard-empty {
  display: none;
  margin: 1.5rem 0 0;
  text-align: center;
  color: var(--text-secondary);
  font-size: 0.85rem;
  letter-spacing: 0.08em;
}

.leaderboard-table__container[data-empty='true'] .leaderboard-empty {
  display: block;
}

@keyframes leaderboard-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.compose-overlay {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  padding: 1.5rem;
  background: rgba(6, 12, 26, 0.74);
  backdrop-filter: blur(7px);
  z-index: 15;
}

.compose-overlay--global {
  position: fixed;
  z-index: 1200;
}

.compose-overlay__dialog {
  width: min(360px, 100%);
  border-radius: 16px;
  padding: 1.75rem 1.5rem;
  background: rgba(9, 17, 34, 0.96);
  box-shadow: 0 28px 48px rgba(2, 6, 18, 0.55);
  outline: none;
  display: grid;
  gap: 1rem;
  justify-items: center;
  text-align: center;
  color: var(--text-primary, #f5f7fb);
}

.compose-overlay__body {
  display: grid;
  gap: 0.75rem;
  justify-items: center;
}

.compose-overlay__title {
  margin: 0;
  font-size: 1.2rem;
  font-weight: 600;
  letter-spacing: 0.04em;
}

.compose-overlay__message {
  margin: 0;
  font-size: 0.95rem;
  line-height: 1.5;
  color: var(--text-secondary);
}

.compose-overlay__spinner {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  border: 3px solid rgba(73, 242, 255, 0.26);
  border-top-color: #49f2ff;
  animation: compose-spin 0.9s linear infinite;
}

.compose-overlay__actions {
  display: flex;
  gap: 0.75rem;
  margin-top: 0.25rem;
}

.compose-overlay__actions[hidden] {
  display: none;
}

.compose-overlay__action {
  min-width: 96px;
}

.compose-overlay[data-mode='error'] .compose-overlay__spinner {
  display: none;
}

@keyframes compose-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.hotbar {
  display: grid;
  grid-template-columns: repeat(5, minmax(48px, 1fr));
  gap: 0.5rem;
}

.hotbar-slot {
  border-radius: 14px;
  border: 1px solid rgba(73, 242, 255, 0.2);
  background: rgba(6, 14, 28, 0.8);
  aspect-ratio: 1;
  display: grid;
  place-items: center;
  font-size: 0.85rem;
  font-weight: 600;
  letter-spacing: 0.01em;
  color: rgba(255, 255, 255, 0.92);
  transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
  cursor: pointer;
  user-select: none;
  padding: 0.35rem;
  text-align: center;
  background-clip: padding-box;
}

.hotbar-slot:hover,
.hotbar-slot:focus-visible {
  transform: translateY(-2px);
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(73, 242, 255, 0.25);
}

.hotbar-slot:focus-visible {
  outline: none;
}

.hotbar-slot[draggable='true'] {
  cursor: grab;
}

.hotbar-slot.dragging {
  opacity: 0.7;
  cursor: grabbing;
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(73, 242, 255, 0.35);
}

.hotbar-slot.drag-over {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(73, 242, 255, 0.35);
}

.hotbar-slot[data-active='true'] {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(73, 242, 255, 0.35);
}

.inventory-slot {
  border-radius: 14px;
  border: 1px solid rgba(73, 242, 255, 0.2);
  background: rgba(6, 14, 28, 0.8);
  aspect-ratio: 1;
  padding: 0.25rem;
  position: relative;
  display: grid;
  place-items: center;
  transition: transform 0.2s ease, border-color 0.2s ease;
  cursor: pointer;
}

.inventory-slot:hover {
  transform: translateY(-2px);
  border-color: var(--accent);
}

.inventory-slot.dragging {
  opacity: 0.65;
  border-color: var(--accent);
}

.inventory-slot.drag-over {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(73, 242, 255, 0.35);
}

.inventory-slot span {
  font-size: 0.75rem;
  text-align: center;
  line-height: 1.2;
}

.inventory-slot .quantity {
  position: absolute;
  bottom: 0.25rem;
  right: 0.35rem;
  font-size: 0.65rem;
  color: var(--accent-strong);
  font-weight: 700;
}

.inventory-slot.active {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(73, 242, 255, 0.35);
}

.toggle-extended {
  margin-top: 0.75rem;
  width: 100%;
}

.extended {
  display: none;
  margin-top: 0.75rem;
  border-top: 1px solid rgba(73, 242, 255, 0.12);
  padding-top: 0.75rem;
  grid-template-columns: repeat(5, minmax(48px, 1fr));
  gap: 0.5rem;
}

.extended[data-visible='true'] {
  display: grid;
}

.extended.open {
  display: grid;
}

.inventory-extended__empty {
  grid-column: 1 / -1;
  margin: 0;
  padding: 0.75rem;
  text-align: center;
  font-size: 0.8rem;
  color: rgba(255, 255, 255, 0.7);
  border: 1px dashed rgba(73, 242, 255, 0.22);
  border-radius: 12px;
  background: rgba(6, 14, 28, 0.6);
}

.inventory-modal {
  padding: clamp(1.5rem, 4vw, 3rem);
}

.inventory-modal__content {
  position: relative;
  width: min(80vw, 1080px);
  max-width: 1080px;
  max-height: min(88vh, 760px);
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: clamp(1.5rem, 2vw, 2.2rem);
  padding: clamp(1.75rem, 3vw, 2.75rem);
  background: radial-gradient(circle at 20% 10%, rgba(73, 242, 255, 0.25), transparent 60%),
    radial-gradient(circle at 80% 0%, rgba(247, 183, 51, 0.18), transparent 65%),
    linear-gradient(155deg, rgba(6, 14, 28, 0.94), rgba(6, 18, 34, 0.92));
  border: 1px solid rgba(73, 242, 255, 0.32);
  box-shadow: 0 40px 120px rgba(0, 0, 0, 0.6);
  text-align: left;
  overflow: hidden;
}

.inventory-modal__content::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  border-radius: 26px;
  border: 1px solid rgba(255, 255, 255, 0.05);
  opacity: 0.75;
}

.inventory-modal__content > * {
  position: relative;
  z-index: 1;
}

.inventory-modal__close {
  position: absolute;
  top: 1.25rem;
  right: 1.25rem;
  width: 34px;
  height: 34px;
  border-radius: 50%;
  border: 1px solid rgba(73, 242, 255, 0.35);
  background: rgba(6, 14, 28, 0.68);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.inventory-modal__close::before,
.inventory-modal__close::after {
  content: '';
  position: absolute;
  width: 16px;
  height: 2px;
  border-radius: 999px;
  background: var(--accent);
}

.inventory-modal__close::before {
  transform: rotate(45deg);
}

.inventory-modal__close::after {
  transform: rotate(-45deg);
}

.inventory-modal__close:hover,
.inventory-modal__close:focus-visible {
  border-color: var(--accent);
  box-shadow: 0 12px 36px rgba(73, 242, 255, 0.28);
}

.inventory-modal__header {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  justify-content: space-between;
  gap: 1.25rem;
}

.inventory-modal__eyebrow {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.32em;
  font-size: clamp(0.7rem, 1.4vw, 0.85rem);
  color: rgba(255, 255, 255, 0.7);
  margin-bottom: 0.35rem;
}

.inventory-modal__intro {
  color: rgba(242, 245, 250, 0.72);
  margin-top: 0.65rem;
  max-width: 46ch;
  line-height: 1.6;
}

.inventory-modal__actions {
  display: flex;
  gap: 0.75rem;
  align-items: center;
}

.inventory-modal__sort {
  white-space: nowrap;
}

.inventory-modal__sort[aria-pressed='true'] {
  border-color: var(--accent);
  color: var(--accent);
}

.inventory-modal__grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: clamp(1rem, 2vw, 1.5rem);
}

.inventory-modal__slot {
  position: relative;
  display: grid;
  place-items: center;
  text-align: center;
  min-height: clamp(132px, 22vh, 180px);
  padding: clamp(1.1rem, 2vw, 1.6rem);
  border-radius: 22px;
  border: 1px solid rgba(73, 242, 255, 0.28);
  background: linear-gradient(160deg, rgba(6, 16, 30, 0.92), rgba(6, 20, 36, 0.85));
  color: var(--text-primary);
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

.inventory-modal__slot::before {
  content: '';
  position: absolute;
  inset: 8px;
  border-radius: 18px;
  border: 1px solid rgba(73, 242, 255, 0.1);
  pointer-events: none;
}

.inventory-modal__slot:hover,
.inventory-modal__slot:focus-visible,
.inventory-modal__slot[data-active='true'] {
  transform: translateY(-4px);
  border-color: rgba(73, 242, 255, 0.55);
  box-shadow: 0 18px 40px rgba(0, 0, 0, 0.45), 0 0 22px rgba(73, 242, 255, 0.25);
  outline: none;
}

.inventory-modal__slot--empty {
  border-style: dashed;
  border-color: rgba(73, 242, 255, 0.2);
  color: rgba(242, 245, 250, 0.3);
  background: linear-gradient(160deg, rgba(6, 14, 28, 0.55), rgba(6, 18, 34, 0.45));
}

.inventory-modal__slot--empty::before {
  border-style: dashed;
  border-color: rgba(73, 242, 255, 0.12);
}

.inventory-modal__item-name {
  font-family: 'Chakra Petch', sans-serif;
  font-size: clamp(1rem, 2vw, 1.25rem);
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.inventory-modal__item-quantity {
  font-size: clamp(0.75rem, 1.6vw, 0.85rem);
  letter-spacing: 0.32em;
  text-transform: uppercase;
  color: rgba(73, 242, 255, 0.75);
  margin-top: 0.5rem;
}

.inventory-modal__footer {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 0.75rem 1.25rem;
  align-items: center;
}

.inventory-modal__hint {
  color: rgba(242, 245, 250, 0.7);
  font-size: 0.9rem;
}

.inventory-modal__overflow {
  color: rgba(73, 242, 255, 0.75);
  font-size: 0.85rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
}

@media (max-width: 960px) {
  .inventory-modal__grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

@media (max-width: 640px) {
  .inventory-modal__content {
    width: min(92vw, 520px);
    padding: 1.5rem;
    gap: 1.5rem;
  }

  .inventory-modal__grid {
    grid-template-columns: minmax(0, 1fr);
  }

  .inventory-modal__slot {
    min-height: 120px;
  }
}

.crafting-modal__content {
  max-width: min(1180px, calc(100vw - 3rem));
  min-height: min(680px, calc(100vh - 3rem));
  width: 100%;
  text-align: left;
  padding: clamp(1.75rem, 2.5vw, 2.5rem);
  display: grid;
  grid-template-rows: auto 1fr;
  gap: clamp(1.5rem, 2vw, 2.25rem);
  position: relative;
  overflow: hidden;
}

.crafting-modal__content::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 20% 10%, rgba(73, 242, 255, 0.12), transparent 55%),
    radial-gradient(circle at 80% 0%, rgba(247, 183, 51, 0.12), transparent 65%);
  opacity: 0.6;
  pointer-events: none;
}

.crafting-modal__content > * {
  position: relative;
  z-index: 1;
}

.crafting-modal__close {
  position: absolute;
  top: 1.25rem;
  right: 1.25rem;
  width: 34px;
  height: 34px;
  border-radius: 50%;
  border: 1px solid rgba(73, 242, 255, 0.35);
  background: rgba(6, 14, 28, 0.65);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.crafting-modal__close::before,
.crafting-modal__close::after {
  content: '';
  position: absolute;
  width: 16px;
  height: 2px;
  border-radius: 999px;
  background: var(--accent);
}

.crafting-modal__close::before {
  transform: rotate(45deg);
}

.crafting-modal__close::after {
  transform: rotate(-45deg);
}

.crafting-modal__close:hover,
.crafting-modal__close:focus-visible {
  border-color: var(--accent);
  box-shadow: 0 12px 32px rgba(73, 242, 255, 0.25);
}

.crafting-modal__header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1.5rem;
}

.crafting-modal__eyebrow {
  text-transform: uppercase;
  letter-spacing: 0.28em;
  font-size: 0.68rem;
  color: rgba(247, 183, 51, 0.75);
  margin-bottom: 0.4rem;
}

.crafting-modal__intro {
  color: var(--text-secondary);
  font-size: 0.85rem;
  line-height: 1.6;
  margin-top: 0.5rem;
}

.crafting-modal__grid {
  display: grid;
  gap: clamp(1.5rem, 2vw, 2.25rem);
  grid-template-columns: minmax(220px, 1fr) minmax(280px, 1fr) minmax(280px, 1.05fr);
  align-items: start;
}

.crafting-modal__inventory {
  display: grid;
  gap: 0.75rem;
  align-content: start;
}

.crafting-modal__inventory-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.75rem;
}

.crafting-modal__inventory-header h3 {
  font-size: 0.85rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(73, 242, 255, 0.75);
}

.crafting-inventory {
  display: grid;
  gap: 0.5rem;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
}

.crafting-inventory__item {
  border-radius: 14px;
  border: 1px solid rgba(73, 242, 255, 0.2);
  background: rgba(6, 14, 28, 0.78);
  color: var(--text-primary);
  padding: 0.6rem 0.65rem;
  display: grid;
  gap: 0.35rem;
  text-align: left;
  position: relative;
  cursor: grab;
  transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.crafting-inventory__item:focus-visible {
  outline: 2px solid rgba(73, 242, 255, 0.6);
  outline-offset: 3px;
}

.crafting-inventory__item:hover,
.crafting-inventory__item[data-active='true'] {
  border-color: rgba(73, 242, 255, 0.6);
  box-shadow: 0 12px 28px rgba(73, 242, 255, 0.16);
  transform: translateY(-2px);
}

.crafting-inventory__item-title {
  font-size: 0.85rem;
  font-weight: 600;
}

.crafting-inventory__item-quantity {
  font-size: 0.7rem;
  color: rgba(73, 242, 255, 0.75);
  text-transform: uppercase;
  letter-spacing: 0.2em;
}

.crafting-inventory__hint {
  font-size: 0.7rem;
  color: var(--text-secondary);
  line-height: 1.4;
}

.crafting-inventory__empty {
  font-size: 0.78rem;
  color: var(--text-secondary);
  border: 1px dashed rgba(73, 242, 255, 0.25);
  padding: 0.85rem 0.9rem;
  border-radius: 14px;
  text-align: center;
}

.crafting-modal__sequence {
  display: grid;
  gap: 1.25rem;
}

.crafting-sequence {
  display: grid;
  gap: 0.8rem;
  grid-template-columns: repeat(7, minmax(88px, 1fr));
}

.craft-slot {
  border-radius: 18px;
  border: 1px dashed rgba(73, 242, 255, 0.28);
  background: rgba(6, 14, 28, 0.62);
  min-height: 88px;
  padding: 0.85rem 0.75rem;
  display: grid;
  place-items: center;
  text-align: center;
  gap: 0.45rem;
  transition: border-color 0.2s ease, background 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
}

.craft-slot .craft-slot__index {
  font-size: 0.68rem;
  letter-spacing: 0.3em;
  text-transform: uppercase;
  color: rgba(73, 242, 255, 0.6);
}

.craft-slot .craft-slot__label {
  font-size: 0.82rem;
  color: var(--text-secondary);
  line-height: 1.25;
}

.craft-slot:hover,
.craft-slot:focus-visible {
  border-color: rgba(73, 242, 255, 0.55);
  background: rgba(6, 14, 28, 0.85);
  transform: translateY(-1px);
}

.craft-slot--target {
  border-color: rgba(73, 242, 255, 0.85);
  box-shadow: 0 0 0 2px rgba(73, 242, 255, 0.35);
  background: rgba(6, 22, 44, 0.82);
}

.craft-slot:focus-visible {
  outline: 2px solid rgba(73, 242, 255, 0.45);
  outline-offset: 3px;
}

.craft-slot.filled {
  border-style: solid;
  border-color: rgba(247, 183, 51, 0.45);
  background: rgba(73, 242, 255, 0.18);
  box-shadow: 0 16px 38px rgba(73, 242, 255, 0.22);
}

.craft-slot.filled .craft-slot__index {
  color: rgba(247, 183, 51, 0.9);
}

.craft-slot.filled .craft-slot__label {
  color: var(--text-primary);
  font-weight: 600;
}

.crafting-sequence.full .craft-slot.empty {
  border-color: rgba(255, 73, 118, 0.45);
}

.crafting-sequence--error {
  border-radius: 18px;
  box-shadow: 0 0 0 2px rgba(255, 73, 118, 0.35);
}

.crafting-sequence--shake {
  animation: crafting-shake 0.4s ease both;
}

.crafting-actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
  gap: 0.9rem;
}

.crafting-actions button {
  height: 52px;
}

.crafting-hint {
  font-size: 0.75rem;
  color: var(--text-secondary);
  line-height: 1.6;
}

.crafting-helper {
  border-radius: 18px;
  border: 1px solid rgba(73, 242, 255, 0.22);
  background: rgba(6, 14, 28, 0.72);
  padding: 1rem 1.1rem;
  display: grid;
  gap: 0.65rem;
  transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
}

.crafting-helper[data-state='active'] {
  border-color: rgba(73, 242, 255, 0.45);
  background: rgba(6, 20, 40, 0.82);
  box-shadow: 0 12px 28px rgba(73, 242, 255, 0.18);
}

.crafting-helper[data-state='focused'] {
  border-color: rgba(247, 183, 51, 0.55);
  background: rgba(26, 36, 18, 0.9);
  box-shadow: 0 16px 34px rgba(247, 183, 51, 0.18);
}

.crafting-helper__title {
  font-size: 0.78rem;
  letter-spacing: 0.24em;
  text-transform: uppercase;
  color: rgba(73, 242, 255, 0.7);
}

.crafting-helper__description {
  font-size: 0.75rem;
  line-height: 1.6;
  color: var(--text-primary);
}

.crafting-helper__matches {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.45rem;
}

.crafting-helper__matches[data-empty='true'] {
  display: none;
}

.crafting-helper__matches li {
  font-size: 0.72rem;
  line-height: 1.5;
  color: var(--text-secondary);
  position: relative;
  padding-left: 1rem;
}

.crafting-helper__matches li::before {
  content: '•';
  position: absolute;
  left: 0;
  top: 0;
  color: rgba(73, 242, 255, 0.75);
}

@media (max-width: 720px) {
  .crafting-sequence {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
}

@media (max-width: 1100px) {
  .crafting-modal__grid {
    grid-template-columns: minmax(220px, 1fr) minmax(260px, 1fr);
    grid-template-areas:
      'inventory inventory'
      'sequence recipes';
  }

  .crafting-modal__inventory {
    grid-area: inventory;
  }
}

@media (max-width: 860px) {
  .crafting-modal__grid {
    grid-template-columns: 1fr;
    grid-template-areas: none;
  }

  .crafting-search-panel {
    padding: 1.25rem;
  }
}

.crafting-modal__recipes {
  display: grid;
  gap: 0.75rem;
  align-content: start;
}

.crafting-search {
  font-size: 0.72rem;
  letter-spacing: 0.28em;
  text-transform: uppercase;
  color: rgba(73, 242, 255, 0.7);
}

.crafting-modal__recipes input[type='search'] {
  margin-top: 0.4rem;
  margin-bottom: 0.35rem;
}

.crafting-suggestions {
  list-style: none;
  display: none;
  gap: 0.4rem;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
}

.crafting-suggestions[data-visible='true'] {
  display: grid;
}

.crafting-suggestions li {
  display: contents;
}

.crafting-suggestions button {
  padding: 0.55rem 0.7rem;
  font-size: 0.75rem;
  border-radius: 12px;
  background: rgba(73, 242, 255, 0.12);
  border: 1px solid rgba(73, 242, 255, 0.25);
  text-align: left;
}

.crafting-suggestions button:hover,
.crafting-suggestions button:focus-visible {
  background: rgba(73, 242, 255, 0.25);
}

.crafting-search-panel {
  position: absolute;
  inset: 0;
  display: none;
  place-items: center;
  background: rgba(1, 4, 10, 0.82);
  backdrop-filter: blur(12px);
  z-index: 5;
  padding: clamp(1.5rem, 4vw, 3rem);
}

.crafting-search-panel[data-open='true'] {
  display: grid;
}

.crafting-search-panel__content {
  background: rgba(6, 14, 28, 0.95);
  border-radius: 24px;
  border: 1px solid rgba(73, 242, 255, 0.25);
  padding: clamp(1.5rem, 3vw, 2.5rem);
  width: min(520px, 100%);
  display: grid;
  gap: 1.25rem;
  position: relative;
  text-align: left;
}

.crafting-search-panel__header {
  display: grid;
  gap: 0.5rem;
}

.crafting-search-panel__eyebrow {
  letter-spacing: 0.28em;
  text-transform: uppercase;
  color: rgba(73, 242, 255, 0.75);
  font-size: 0.7rem;
}

.crafting-search-panel__content h3 {
  color: var(--text-primary);
  font-size: clamp(1.1rem, 2vw, 1.35rem);
}

.crafting-search-panel__content p {
  margin: 0;
  color: var(--text-secondary);
  line-height: 1.6;
}

.crafting-search-panel__input input {
  background: rgba(6, 22, 44, 0.9);
}

.crafting-search-panel__results {
  list-style: none;
  display: grid;
  gap: 0.65rem;
  max-height: min(320px, 50vh);
  overflow: auto;
}

.crafting-search-panel__results button {
  width: 100%;
  text-align: left;
  padding: 0.65rem 0.85rem;
  border-radius: 14px;
  border: 1px solid rgba(73, 242, 255, 0.2);
  background: rgba(73, 242, 255, 0.12);
  color: var(--text-primary);
}

.crafting-search-panel__results button:hover,
.crafting-search-panel__results button:focus-visible {
  border-color: rgba(73, 242, 255, 0.45);
  background: rgba(73, 242, 255, 0.22);
}

.crafting-search-panel__result-subtitle {
  display: block;
  font-size: 0.72rem;
  margin-top: 0.15rem;
  color: rgba(73, 242, 255, 0.75);
}

.crafting-search-panel__result-output {
  display: block;
  font-size: 0.7rem;
  margin-top: 0.1rem;
  color: var(--text-secondary);
}

.crafting-search-panel__actions {
  display: flex;
  justify-content: flex-end;
}

.crafting-search-panel__empty {
  font-size: 0.78rem;
  color: var(--text-secondary);
}

.crafting-drag-ghost {
  position: fixed;
  pointer-events: none;
  z-index: 160;
  padding: 0.65rem 0.85rem;
  border-radius: 14px;
  border: 1px solid rgba(73, 242, 255, 0.55);
  background: rgba(6, 14, 28, 0.95);
  color: var(--text-primary);
  box-shadow: 0 18px 38px rgba(0, 0, 0, 0.45);
  transform: translate(-50%, -50%);
  min-width: 160px;
  display: grid;
  gap: 0.25rem;
  opacity: 0;
  transition: opacity 0.1s ease;
}

.crafting-drag-ghost[data-visible='true'] {
  opacity: 1;
}

.crafting-drag-ghost__title {
  font-weight: 600;
  font-size: 0.85rem;
}

.crafting-drag-ghost__quantity {
  font-size: 0.68rem;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: rgba(73, 242, 255, 0.75);
}

.crafting-drag-trail {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 150;
}

.crafting-drag-trail__particle {
  position: absolute;
  width: 14px;
  height: 14px;
  border-radius: 999px;
  background: rgba(73, 242, 255, 0.45);
  box-shadow: 0 0 12px rgba(73, 242, 255, 0.65);
  transform: translate(-50%, -50%);
  animation: drag-trail-fade 0.4s ease-out forwards;
}

body[data-crafting-drag='true'] {
  cursor: grabbing;
}

@keyframes drag-trail-fade {
  from {
    opacity: 0.9;
    transform: translate(-50%, -50%) scale(1);
  }
  to {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.3);
  }
}

@keyframes crafting-shake {
  0% {
    transform: translateX(0);
  }
  20% {
    transform: translateX(-6px);
  }
  40% {
    transform: translateX(6px);
  }
  60% {
    transform: translateX(-4px);
  }
  80% {
    transform: translateX(4px);
  }
  100% {
    transform: translateX(0);
  }
}

.recipe-list {
  display: grid;
  gap: 0.75rem;
  max-height: 280px;
  overflow: auto;
  padding-right: 0.35rem;
}

.recipe-card {
  display: grid;
  gap: 0.35rem;
  text-align: left;
  border-radius: 18px;
  border: 1px solid rgba(73, 242, 255, 0.15);
  background: rgba(6, 14, 28, 0.72);
  padding: 0.85rem 1rem;
  cursor: pointer;
  transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.recipe-card:hover,
.recipe-card:focus-visible {
  transform: translateY(-2px);
  border-color: var(--accent);
  box-shadow: 0 18px 38px rgba(73, 242, 255, 0.18);
}

.recipe-card__name {
  font-size: 0.78rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--accent);
}

.recipe-card__sequence,
.recipe-card__output {
  font-size: 0.78rem;
  color: var(--text-secondary);
}

.recipe-card__sequence {
  letter-spacing: 0.08em;
}

.recipe-card__output {
  font-weight: 600;
  color: rgba(247, 183, 51, 0.85);
}

.recipe-card.known {
  border-color: rgba(247, 183, 51, 0.45);
  background: rgba(73, 242, 255, 0.18);
}

.recipe-empty {
  border-radius: 16px;
  border: 1px dashed rgba(73, 242, 255, 0.25);
  background: rgba(6, 14, 28, 0.6);
  padding: 1rem;
  text-align: center;
  font-size: 0.8rem;
  color: var(--text-secondary);
}

.crafting-confetti {
  position: absolute;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.crafting-confetti.active {
  opacity: 1;
}

.crafting-confetti__piece {
  position: absolute;
  width: 10px;
  height: 16px;
  border-radius: 4px;
  opacity: 0;
  animation: craft-confetti-fall 1.35s ease-in forwards;
}

@keyframes craft-confetti-fall {
  0% {
    transform: translate3d(var(--offset-x, 0), -40%, 0) rotate(0deg);
    opacity: 0;
  }
  15% {
    opacity: 1;
  }
  100% {
    transform: translate3d(var(--offset-x, 0), 110%, 0) rotate(var(--spin, 1turn));
    opacity: 0;
  }
}

.log-panel ul {
  list-style: none;
  display: grid;
  gap: 0.45rem;
  max-height: 180px;
  overflow: auto;
  padding-right: 0.25rem;
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.log-panel li {
  background: rgba(4, 11, 22, 0.6);
  border-radius: 12px;
  padding: 0.5rem 0.7rem;
  border: 1px solid rgba(73, 242, 255, 0.08);
}

.footer {
  padding: 1.5rem 2.5rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  font-size: 0.85rem;
  color: var(--text-secondary);
  background: linear-gradient(0deg, rgba(5, 10, 20, 0.85), rgba(5, 10, 20, 0));
  border-top: 1px solid rgba(73, 242, 255, 0.1);
}

.footer .controls {
  display: flex;
  gap: 2rem;
}

button {
  background: rgba(73, 242, 255, 0.1);
  border: 1px solid rgba(73, 242, 255, 0.3);
  color: var(--text-primary);
  border-radius: 14px;
  padding: 0.55rem 0.9rem;
  font-size: 0.85rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  cursor: pointer;
  transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
}

button:hover {
  transform: translateY(-1px);
  background: rgba(73, 242, 255, 0.18);
  box-shadow: 0 12px 24px rgba(73, 242, 255, 0.12);
}

button.primary {
  background: linear-gradient(135deg, var(--accent), rgba(73, 242, 255, 0.6));
  color: #04111d;
  border: none;
}

button.primary:hover {
  background: linear-gradient(135deg, rgba(73, 242, 255, 0.85), rgba(73, 242, 255, 0.6));
  box-shadow: 0 12px 32px rgba(73, 242, 255, 0.35);
}

button.ghost {
  background: rgba(73, 242, 255, 0.05);
  border-color: rgba(73, 242, 255, 0.25);
}

button.ghost:hover {
  background: rgba(73, 242, 255, 0.15);
}

button.small {
  font-size: 0.7rem;
  padding: 0.45rem 0.7rem;
  letter-spacing: 0.1em;
}

input[type='search'] {
  background: rgba(6, 14, 28, 0.85);
  border: 1px solid rgba(73, 242, 255, 0.25);
  border-radius: 12px;
  padding: 0.45rem 0.65rem;
  color: var(--text-primary);
  font-size: 0.8rem;
  width: 100%;
}

.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.modal {
  position: fixed;
  inset: 0;
  background: rgba(1, 4, 10, 0.9);
  display: grid;
  place-items: center;
  padding: 2rem;
  z-index: 100;
}

.modal-content {
  max-width: 540px;
  background: rgba(6, 14, 28, 0.95);
  border-radius: 24px;
  padding: 2rem;
  border: 1px solid rgba(73, 242, 255, 0.2);
  box-shadow: 0 40px 80px rgba(0, 0, 0, 0.45);
  text-align: center;
}

.modal-content h2 {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.25em;
  color: var(--accent);
  margin-bottom: 1rem;
}

.modal-content p {
  color: var(--text-secondary);
  margin-bottom: 1rem;
  line-height: 1.6;
}

.modal-error {
  color: var(--accent-strong);
  font-weight: 600;
  margin-top: 1.25rem;
  line-height: 1.6;
}

.modal-highlights {
  list-style: none;
  display: grid;
  gap: 0.65rem;
  color: var(--text-secondary);
  text-align: left;
  margin-bottom: 1.5rem;
}

.modal-highlights li::before {
  content: '✦';
  margin-right: 0.75rem;
  color: var(--accent-strong);
}

.signin-callout {
  margin: 1.75rem 0 2rem;
  padding: 1.5rem 1.75rem 1.75rem;
  border-radius: 20px;
  border: 1px solid rgba(73, 242, 255, 0.24);
  background: linear-gradient(160deg, rgba(6, 22, 44, 0.95), rgba(6, 22, 44, 0.75));
  box-shadow: 0 24px 60px rgba(0, 0, 0, 0.4);
  display: grid;
  gap: 1rem;
  justify-items: center;
  text-align: center;
}

.signin-callout h3 {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--accent);
  font-size: clamp(1.1rem, 1.6vw, 1.35rem);
}

.settings-modal__content {
  max-width: 420px;
  text-align: left;
  padding: 2.25rem 2.5rem;
}

.settings-modal__header {
  display: grid;
  gap: 0.5rem;
  margin-bottom: 1.75rem;
}

.settings-modal__header p {
  margin: 0;
  color: var(--text-secondary);
}

.settings-modal__form {
  display: grid;
  gap: 1.5rem;
}

.settings-modal__legend {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  font-size: 0.78rem;
  color: var(--accent);
  margin-bottom: 0.35rem;
}

.settings-modal__fieldset {
  border: 0;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 1.25rem;
}

.settings-modal__fieldset--toggles {
  gap: 1rem;
}

.settings-modal__fieldset--keybindings {
  gap: 1rem;
}

.settings-modal__hint--keys {
  margin: 0;
}

.keybinding-groups {
  display: grid;
  gap: 1rem;
}

.keybinding-group {
  display: grid;
  gap: 0.65rem;
}

.keybinding-group__title {
  margin: 0;
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-family: 'Chakra Petch', sans-serif;
  color: var(--accent);
}

.keybinding-group__list {
  display: grid;
  gap: 0.75rem;
}

.keybinding-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  padding: 0.75rem 1rem;
  border-radius: 14px;
  border: 1px solid rgba(73, 242, 255, 0.18);
  background: rgba(6, 18, 34, 0.65);
}

.keybinding-row__info {
  display: grid;
  gap: 0.25rem;
}

.keybinding-row__label {
  font-weight: 600;
  color: var(--text-primary);
}

.keybinding-row__default {
  font-size: 0.78rem;
  color: var(--text-secondary);
}

.keybinding-row__button {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  border-radius: 999px;
  border: 1px solid rgba(73, 242, 255, 0.38);
  background: rgba(9, 24, 43, 0.7);
  color: var(--accent);
  font-weight: 600;
  padding: 0.4rem 0.85rem;
  cursor: pointer;
  transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
}

.keybinding-row__button:hover {
  background: rgba(73, 242, 255, 0.16);
  border-color: rgba(73, 242, 255, 0.55);
}

.keybinding-row__button:focus-visible {
  outline: 2px solid rgba(73, 242, 255, 0.65);
  outline-offset: 3px;
}

.keybinding-row__button--listening {
  background: rgba(73, 242, 255, 0.24);
  border-color: rgba(73, 242, 255, 0.7);
  color: var(--text-primary);
}

.keybinding-row__keys {
  font-variant-numeric: tabular-nums;
}

.keybinding-row__cta {
  font-size: 0.72rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-secondary);
}

.keybinding-row__button--listening .keybinding-row__cta {
  color: var(--text-primary);
}

.keybinding-row__button--listening .keybinding-row__keys {
  font-weight: 700;
}

.settings-modal__key-actions {
  display: flex;
  justify-content: flex-end;
}

.settings-modal__fieldset--account {
  justify-items: flex-start;
  gap: 0.85rem;
}

.settings-modal__field {
  display: grid;
  gap: 0.5rem;
}

.settings-modal__label-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 600;
  color: var(--text-primary);
}

.settings-modal__value {
  font-variant-numeric: tabular-nums;
  color: var(--accent);
}

.settings-modal__range {
  width: 100%;
  accent-color: var(--accent);
}

.settings-modal__range::-webkit-slider-runnable-track {
  height: 6px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(73, 242, 255, 0.75), rgba(73, 242, 255, 0.3));
}

.settings-modal__range::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  height: 18px;
  width: 18px;
  border-radius: 50%;
  background: var(--accent);
  box-shadow: 0 0 0 4px rgba(73, 242, 255, 0.18);
  margin-top: -6px;
  cursor: pointer;
}

.settings-modal__range::-moz-range-track {
  height: 6px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(73, 242, 255, 0.75), rgba(73, 242, 255, 0.3));
}

.settings-modal__range::-moz-range-thumb {
  height: 18px;
  width: 18px;
  border-radius: 50%;
  background: var(--accent);
  box-shadow: 0 0 0 4px rgba(73, 242, 255, 0.18);
  border: 0;
  cursor: pointer;
}

.settings-modal__hint {
  margin: 0;
  color: var(--text-secondary);
  font-size: 0.9rem;
}

.settings-modal__actions {
  display: flex;
  justify-content: flex-end;
}

.settings-modal__toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1.25rem;
  padding: 0.85rem 1rem;
  border-radius: 16px;
  border: 1px solid rgba(73, 242, 255, 0.18);
  background: rgba(6, 18, 34, 0.72);
  cursor: pointer;
}

.settings-modal__toggle:focus-within {
  outline: 2px solid rgba(73, 242, 255, 0.45);
  outline-offset: 3px;
}

.settings-modal__toggle-copy {
  display: grid;
  gap: 0.35rem;
  text-align: left;
}

.settings-modal__toggle-title {
  font-weight: 600;
}

.settings-modal__toggle-description {
  margin: 0;
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.settings-modal__toggle-control {
  position: relative;
  width: 56px;
  height: 32px;
  flex-shrink: 0;
}

.toggle-switch__input {
  position: absolute;
  inset: 0;
  margin: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
}

.toggle-switch {
  position: absolute;
  inset: 0;
  border-radius: 999px;
  background: rgba(73, 242, 255, 0.2);
  transition: background 0.25s ease, box-shadow 0.25s ease;
}

.toggle-switch::after {
  content: '';
  position: absolute;
  top: 4px;
  left: 4px;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: rgba(242, 245, 250, 0.8);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
  transition: transform 0.25s ease, background 0.25s ease;
}

.toggle-switch__input:checked + .toggle-switch {
  background: linear-gradient(135deg, var(--accent), rgba(247, 183, 51, 0.65));
  box-shadow: 0 12px 28px rgba(73, 242, 255, 0.25);
}

.toggle-switch__input:checked + .toggle-switch::after {
  transform: translateX(24px);
  background: #04111d;
}

.toggle-switch__input:focus-visible + .toggle-switch {
  box-shadow: 0 0 0 3px rgba(73, 242, 255, 0.35);
}

.settings-modal__note {
  margin: 0;
  color: var(--text-secondary);
  font-size: 0.85rem;
}

.settings-modal__logout {
  min-width: 0;
}

body.colorblind-assist {
  --accent: #ffd166;
  --accent-strong: #073b4c;
  --accent-soft: rgba(255, 209, 102, 0.35);
  --text-secondary: rgba(255, 255, 255, 0.85);
}

body.colorblind-assist .score-overlay__label,
body.colorblind-assist .score-overlay__value,
body.colorblind-assist .score-overlay__metric-value {
  color: #ffd166;
}

body.colorblind-assist .portal-progress .bar {
  background: linear-gradient(90deg, #ffd166, #118ab2);
}

.subtitle-overlay {
  position: absolute;
  bottom: clamp(48px, 12vh, 120px);
  left: 50%;
  transform: translateX(-50%);
  max-width: min(640px, 80vw);
  padding: 0.9rem 1.4rem;
  border-radius: 18px;
  border: 1px solid rgba(73, 242, 255, 0.25);
  background: rgba(6, 14, 28, 0.82);
  box-shadow: 0 22px 40px rgba(0, 0, 0, 0.45);
  font-size: clamp(1rem, 2.35vw, 1.4rem);
  line-height: 1.45;
  text-align: center;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.25s ease;
}

.subtitle-overlay[data-visible='true'] {
  opacity: 1;
}

body:not(.subtitles-enabled) .subtitle-overlay {
  display: none !important;
}

body.colorblind-assist .subtitle-overlay {
  border-color: rgba(255, 209, 102, 0.35);
  box-shadow: 0 22px 40px rgba(17, 138, 178, 0.25);
}

.signin-callout__summary {
  color: var(--text-secondary);
  margin: 0 auto;
  max-width: 28rem;
  line-height: 1.6;
}

.signin-callout__actions {
  display: grid;
  gap: 0.75rem;
  justify-items: center;
  width: 100%;
}

.signin-callout__actions .primary {
  min-width: clamp(200px, 60%, 260px);
}

.signin-callout__note {
  color: rgba(242, 245, 250, 0.65);
  font-size: 0.875rem;
  margin: 0;
  max-width: 26rem;
}

.guide-modal {
  align-items: flex-start;
  overflow-y: auto;
  padding: clamp(2rem, 5vw, 3rem);
}

.guide-content {
  width: min(70vw, 1100px);
  max-height: min(90vh, 960px);
  overflow-y: auto;
  background: rgba(6, 14, 28, 0.92);
  border-radius: 32px;
  border: 1px solid rgba(73, 242, 255, 0.18);
  box-shadow: 0 50px 120px rgba(0, 0, 0, 0.45);
  padding: clamp(1.5rem, 3vw, 2.75rem);
  display: grid;
  gap: clamp(1.75rem, 2.5vw, 2.5rem);
  color: var(--text-secondary);
}

.guide-carousel {
  background: radial-gradient(circle at top left, rgba(73, 242, 255, 0.16), transparent 55%),
    radial-gradient(circle at bottom right, rgba(247, 183, 51, 0.12), transparent 50%);
  border: 1px solid rgba(73, 242, 255, 0.22);
  border-radius: 28px;
  padding: clamp(1.25rem, 3vw, 2rem);
  gap: clamp(1.25rem, 2vw, 1.75rem);
}

.guide-carousel__viewport {
  position: relative;
}

.guide-card {
  background: rgba(8, 18, 36, 0.92);
  border-radius: 24px;
  border: 1px solid rgba(73, 242, 255, 0.18);
  padding: clamp(1.25rem, 2.5vw, 2.25rem);
  display: grid;
  gap: clamp(1.25rem, 2vw, 1.75rem);
}

.guide-card__header {
  display: grid;
  gap: 0.85rem;
}

.guide-card__icon {
  width: clamp(3.25rem, 4vw, 3.75rem);
  height: clamp(3.25rem, 4vw, 3.75rem);
  border-radius: 18px;
  background: linear-gradient(135deg, rgba(73, 242, 255, 0.25), rgba(47, 125, 255, 0.45));
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(73, 242, 255, 0.3);
  box-shadow: 0 18px 30px rgba(6, 16, 31, 0.45);
}

.guide-card__icon span {
  font-size: clamp(1.85rem, 4vw, 2.2rem);
  line-height: 1;
}

.guide-card__label {
  text-transform: uppercase;
  letter-spacing: 0.35em;
  font-size: 0.7rem;
  color: rgba(247, 183, 51, 0.8);
}

.guide-card__title {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.18em;
  color: var(--accent);
  font-size: clamp(1.1rem, 2.3vw, 1.6rem);
  margin: 0;
}

.guide-card__description {
  margin: 0;
  line-height: 1.6;
}

.guide-card__demo {
  display: grid;
  gap: 0.75rem;
  padding: clamp(0.75rem, 2vw, 1.25rem);
  border-radius: 18px;
  background: rgba(12, 26, 49, 0.92);
  border: 1px solid rgba(73, 242, 255, 0.16);
}

.guide-card__canvas {
  display: none;
  margin-top: 0.5rem;
  padding: 0.75rem;
  border-radius: 16px;
  border: 1px solid rgba(73, 242, 255, 0.22);
  background: rgba(5, 14, 28, 0.9);
  box-shadow: inset 0 0 0 1px rgba(73, 242, 255, 0.06);
  justify-items: center;
}

.guide-card__canvas[data-active='true'] {
  display: grid;
}

.guide-demo-surface {
  width: 100%;
  height: auto;
  image-rendering: pixelated;
  border-radius: 12px;
  border: 1px solid rgba(73, 242, 255, 0.12);
  background: radial-gradient(circle at top, rgba(73, 242, 255, 0.08), transparent 65%);
  outline: none;
}

.guide-demo-surface:focus-visible {
  outline: 3px solid rgba(73, 242, 255, 0.55);
  outline-offset: 4px;
}

.guide-card__steps {
  display: grid;
  gap: 0.65rem;
}

.guide-card__step {
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: center;
  gap: 0.75rem;
  padding: 0.65rem 0.9rem;
  background: rgba(10, 22, 42, 0.85);
  border: 1px solid rgba(73, 242, 255, 0.12);
  border-radius: 14px;
  color: inherit;
  font: inherit;
  text-align: left;
  cursor: pointer;
  transition: border-color 160ms ease, background-color 160ms ease, transform 160ms ease;
}

.guide-card__step:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

.guide-card__step:hover {
  border-color: rgba(73, 242, 255, 0.35);
}

.guide-card__step.is-active {
  background: rgba(73, 242, 255, 0.18);
  border-color: rgba(73, 242, 255, 0.45);
}

.guide-card__step.is-animating {
  animation: guide-step-pulse 620ms ease;
}

.guide-card__step-label {
  text-transform: uppercase;
  letter-spacing: 0.18em;
  font-size: 0.65rem;
  color: rgba(247, 183, 51, 0.9);
}

.guide-card__step-keys {
  display: inline-flex;
  gap: 0.35rem;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.guide-card__step-keys kbd {
  font-size: 0.75rem;
}

.guide-card__play {
  justify-self: flex-start;
  border: 1px solid rgba(247, 183, 51, 0.6);
  background: rgba(247, 183, 51, 0.16);
  color: rgba(247, 183, 51, 0.95);
  border-radius: 999px;
  padding: 0.45rem 1.05rem;
  font-size: 0.8rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  cursor: pointer;
  transition: transform 180ms ease, background-color 180ms ease, border-color 180ms ease;
}

.guide-card__play:hover {
  background: rgba(247, 183, 51, 0.22);
  transform: translateY(-1px);
}

.guide-card__play:focus-visible {
  outline: 2px solid rgba(247, 183, 51, 0.8);
  outline-offset: 2px;
}

.guide-card__caption {
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.5;
  color: rgba(215, 226, 245, 0.85);
}

.guide-card__columns {
  display: grid;
  gap: 1.15rem;
  grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
}

.guide-card__list h4 {
  margin-bottom: 0.6rem;
}

.guide-card__list ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.65rem;
}

.guide-card__control {
  display: grid;
  gap: 0.35rem;
}

.guide-card__control-keys {
  display: inline-flex;
  gap: 0.4rem;
  flex-wrap: wrap;
}

.guide-card__control-keys kbd {
  font-size: 0.75rem;
}

.guide-card__tip {
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.5;
  color: rgba(109, 212, 255, 0.85);
}

.guide-close {
  align-self: flex-start;
  border: 1px solid rgba(73, 242, 255, 0.25);
  background: rgba(8, 18, 36, 0.85);
  color: var(--accent);
  width: 44px;
  height: 44px;
  border-radius: 12px;
  font-size: 1.75rem;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: border-color 160ms ease, background-color 160ms ease, transform 160ms ease;
}

.guide-close:hover {
  border-color: rgba(73, 242, 255, 0.45);
  background: rgba(8, 18, 36, 0.95);
  transform: translateY(-1px);
}

.guide-close:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 3px;
}

.guide-carousel__controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
}

.guide-carousel__arrow {
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  border: 1px solid rgba(73, 242, 255, 0.3);
  background: rgba(11, 26, 48, 0.9);
  color: var(--accent);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform 160ms ease, border-color 160ms ease, background-color 160ms ease;
}

.guide-carousel__arrow:hover {
  border-color: rgba(73, 242, 255, 0.55);
  background: rgba(16, 36, 67, 0.95);
  transform: translateY(-1px);
}

.guide-carousel__arrow:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

.guide-carousel__dots {
  display: inline-flex;
  gap: 0.5rem;
}

.guide-carousel__dots button {
  width: 0.65rem;
  height: 0.65rem;
  border-radius: 50%;
  border: 1px solid rgba(73, 242, 255, 0.35);
  background: transparent;
  padding: 0;
  cursor: pointer;
  transition: transform 160ms ease, background-color 160ms ease, border-color 160ms ease;
}

.guide-carousel__dots button[data-active='true'] {
  background: var(--accent);
  border-color: var(--accent);
  transform: scale(1.1);
}

.guide-carousel__dots button:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

@keyframes guide-step-pulse {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(73, 242, 255, 0.45);
  }
  50% {
    transform: scale(1.02);
    box-shadow: 0 0 20px 0 rgba(73, 242, 255, 0.35);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(73, 242, 255, 0.2);
  }
}

.guide-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1.5rem;
}

.guide-header h2 {
  font-family: 'Chakra Petch', sans-serif;
  font-size: clamp(1.75rem, 3vw, 2.35rem);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--accent);
}

.guide-eyebrow {
  text-transform: uppercase;
  letter-spacing: 0.4em;
  font-size: 0.75rem;
  color: rgba(247, 183, 51, 0.85);
  margin-bottom: 0.65rem;
}

.guide-section {
  display: grid;
  gap: 0.85rem;
}

.guide-section h3,
.guide-section h4 {
  font-family: 'Chakra Petch', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--accent);
  font-size: clamp(1rem, 2vw, 1.3rem);
}

.guide-section h4 {
  font-size: clamp(0.9rem, 1.8vw, 1.15rem);
  color: var(--accent-strong);
}

.guide-section ul,
.guide-section ol {
  display: grid;
  gap: 0.45rem;
  padding-left: 1.1rem;
}

.guide-section li {
  line-height: 1.6;
}

.guide-section kbd {
  font-family: 'Chakra Petch', sans-serif;
  background: rgba(73, 242, 255, 0.12);
  border: 1px solid rgba(73, 242, 255, 0.3);
  border-radius: 6px;
  padding: 0.1rem 0.35rem;
  font-size: 0.75rem;
  letter-spacing: 0.04em;
}

.guide-section__demo {
  display: grid;
  gap: 0.75rem;
  justify-items: start;
}

.guide-section__demo-surface {
  display: grid;
  gap: 0.5rem;
  padding: 0.75rem;
  border-radius: 16px;
  border: 1px solid rgba(73, 242, 255, 0.16);
  background: rgba(5, 14, 28, 0.88);
  box-shadow: inset 0 0 0 1px rgba(73, 242, 255, 0.04);
  max-width: 260px;
}

.guide-section__demo-surface canvas {
  width: 250px;
  height: 250px;
}

.guide-demo-caption {
  font-size: 0.78rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(206, 227, 255, 0.88);
}

.guide-demo-toast {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  padding: 0.4rem 0.7rem;
  border-radius: 12px;
  border: 1px solid rgba(73, 242, 255, 0.4);
  background: rgba(73, 242, 255, 0.18);
  color: var(--accent-strong);
  font-size: 0.75rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  box-shadow: 0 6px 16px rgba(73, 242, 255, 0.15);
}

.guide-section.two-column {
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1.5rem;
}

.guide-controls-table {
  width: 100%;
  border-collapse: collapse;
  background: rgba(12, 26, 49, 0.92);
  border: 1px solid rgba(73, 242, 255, 0.2);
  border-radius: 16px;
  overflow: hidden;
  font-size: 0.9rem;
}

.guide-controls-table th,
.guide-controls-table td {
  padding: 0.75rem 1rem;
  text-align: left;
  border-bottom: 1px solid rgba(73, 242, 255, 0.12);
}

.guide-controls-table thead th {
  background: rgba(73, 242, 255, 0.14);
  color: var(--accent-strong);
  text-transform: uppercase;
  letter-spacing: 0.18em;
  font-size: 0.75rem;
}

.guide-controls-table tbody tr:last-child th,
.guide-controls-table tbody tr:last-child td {
  border-bottom: none;
}

.guide-controls-table td {
  color: var(--text-secondary);
}

.guide-controls-table kbd {
  margin-right: 0.3rem;
}

.guide-section--tips .guide-tips {
  list-style: none;
  padding: 0;
  gap: 0.75rem;
}

.guide-section--tips .guide-tips li {
  padding-left: 1.75rem;
  position: relative;
}

.guide-section--tips .guide-tips li::before {
  content: '✦';
  position: absolute;
  left: 0;
  top: 0;
  color: rgba(247, 183, 51, 0.85);
}

.guide-section--diagram {
  gap: 1.1rem;
}

.guide-portal-diagram {
  background: rgba(8, 18, 36, 0.9);
  border-radius: 20px;
  border: 1px solid rgba(73, 242, 255, 0.2);
  padding: 1rem;
  display: grid;
  gap: 0.5rem;
  justify-items: center;
}

.guide-portal-diagram svg {
  width: min(320px, 100%);
  height: auto;
}

.guide-portal-diagram figcaption {
  font-size: 0.85rem;
  color: var(--text-secondary);
  text-align: center;
}

.dimension-list {
  display: grid;
  gap: 1.1rem;
}

.dimension-list dt {
  font-weight: 700;
  color: var(--accent-strong);
  text-transform: uppercase;
  letter-spacing: 0.18em;
}

.dimension-list dd {
  margin-left: 0;
  line-height: 1.6;
}

.mobile-controls {
  position: fixed;
  bottom: 1.25rem;
  left: 50%;
  transform: translateX(-50%);
  display: none;
  gap: 0.5rem;
  background: rgba(6, 12, 24, 0.9);
  padding: 0.75rem 1rem;
  border-radius: 20px;
  border: 1px solid rgba(73, 242, 255, 0.2);
  box-shadow: var(--card-shadow);
  z-index: 20;
  align-items: center;
  flex-wrap: wrap;
  justify-content: center;
}

.virtual-joystick {
  position: relative;
  width: 96px;
  height: 96px;
  border-radius: 50%;
  border: 2px solid rgba(73, 242, 255, 0.35);
  background: radial-gradient(circle at center, rgba(73, 242, 255, 0.2), rgba(6, 12, 24, 0.75));
  touch-action: none;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 0.75rem;
}

.virtual-joystick__thumb {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 48px;
  height: 48px;
  margin-left: -24px;
  margin-top: -24px;
  border-radius: 50%;
  background: linear-gradient(160deg, rgba(73, 242, 255, 0.85), rgba(73, 242, 255, 0.4));
  box-shadow: 0 0 18px rgba(73, 242, 255, 0.5);
  pointer-events: none;
  transform: translate(0, 0);
  transition: transform 0.08s ease;
}

.mobile-controls button {
  width: 48px;
  height: 48px;
  border-radius: 16px;
}

.mobile-controls button.accent {
  background: linear-gradient(135deg, rgba(73, 242, 255, 0.85), rgba(73, 242, 255, 0.4));
  color: #021521;
}

.site-footer {
  margin: 3rem auto 0;
  padding: 1.5rem 1rem 3.5rem;
  text-align: center;
  color: var(--text-secondary);
  font-size: 0.95rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  border-top: 1px solid rgba(73, 242, 255, 0.12);
  max-width: min(960px, 92vw);
}

.site-footer p {
  margin: 0;
}

@media (pointer: coarse) {
  .mobile-controls {
    display: flex;
  }
}


.player-hint {
  position: relative;
  background: linear-gradient(160deg, rgba(10, 22, 40, 0.94), rgba(8, 18, 32, 0.72));
  border-radius: 20px;
  padding: 0.95rem 1.35rem;
  border: 1px solid rgba(77, 164, 255, 0.25);
  box-shadow: 0 20px 46px rgba(4, 10, 24, 0.45);
  font-size: 0.95rem;
  line-height: 1.5;
  letter-spacing: 0.02em;
  color: var(--text-primary);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
  transform: translateY(-8px);
  cursor: pointer;
}

.player-hint::after {
  content: 'Tap, click, or press Enter to dismiss';
  display: block;
  margin-top: 0.6rem;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.18em;
  color: var(--text-secondary);
}

.player-hint.visible {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.player-hint[data-variant='controls'] {
  text-align: left;
}

.player-hint[data-variant='controls']::after {
  margin-top: 0.75rem;
}

.player-hint__controls {
  display: flex;
  flex-direction: column;
  gap: 0.65rem;
}

.player-hint__title {
  margin: 0;
  font-size: 1.05rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--accent-strong);
}

.player-hint__intro {
  margin: 0;
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.player-hint__note {
  margin: 0;
  margin-top: 0.35rem;
  font-size: 0.78rem;
  color: var(--accent-strong);
  opacity: 0.85;
  line-height: 1.45;
}

.player-hint__columns {
  display: grid;
  gap: 0.65rem;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.player-hint__column {
  background: linear-gradient(135deg, rgba(12, 26, 44, 0.85), rgba(8, 18, 34, 0.65));
  border-radius: 16px;
  border: 1px solid rgba(73, 242, 255, 0.18);
  padding: 0.75rem 0.9rem;
  display: flex;
  flex-direction: column;
  gap: 0.55rem;
  min-height: 0;
  transition: border-color 0.25s ease, box-shadow 0.25s ease;
}

.player-hint__column.is-active {
  border-color: rgba(73, 242, 255, 0.6);
  box-shadow: 0 0 0 1px rgba(73, 242, 255, 0.25), 0 16px 30px rgba(0, 0, 0, 0.28);
}

.player-hint__column-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.35rem;
}

.player-hint__label {
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.22em;
  color: var(--text-secondary);
}

.player-hint__badge {
  font-size: 0.65rem;
  text-transform: uppercase;
  letter-spacing: 0.18em;
  padding: 0.2rem 0.5rem;
  border-radius: 999px;
  background: rgba(73, 242, 255, 0.18);
  color: var(--accent);
}

.player-hint__key-row {
  display: flex;
  justify-content: center;
  gap: 0.4rem;
  flex-wrap: wrap;
}

.player-hint__key {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 2.2rem;
  min-height: 2.2rem;
  padding: 0.35rem;
  border-radius: 12px;
  border: 1px solid rgba(73, 242, 255, 0.35);
  background: rgba(4, 12, 26, 0.55);
  font-weight: 600;
  letter-spacing: 0.08em;
  color: var(--text-primary);
  box-shadow: inset 0 0 0 1px rgba(73, 242, 255, 0.18);
}

.player-hint__key--arrow {
  font-size: 1.1rem;
}

.player-hint__list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.35rem;
  font-size: 0.82rem;
  color: var(--text-secondary);
}

.player-hint__list li {
  line-height: 1.45;
}

.player-hint__column.is-active .player-hint__label,
.player-hint__column.is-active .player-hint__badge {
  color: var(--accent-strong);
}

.player-hint__column.is-active .player-hint__badge {
  background: rgba(73, 242, 255, 0.3);
}

.player-hint__key-row--mobile .player-hint__key {
  min-width: 2.4rem;
}

.drowning-vignette {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(circle at 50% 35%, rgba(63, 132, 255, 0.15), rgba(3, 9, 18, 0.92) 80%);
  mix-blend-mode: screen;
  opacity: 0;
  transition: opacity 0.45s ease;
  z-index: 24;
}

.drowning-vignette[data-active='true'] {
  opacity: 0.55;
}

.drowning-vignette.drowning-vignette--flash {
  animation: drowning-flash 0.7s ease-out;
}

.tar-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 25;
  opacity: 0;
  --tar-overlay-strength: 0;
  mix-blend-mode: multiply;
  background:
    radial-gradient(circle at 20% 25%, rgba(12, 4, 18, 0.75), transparent 62%),
    radial-gradient(circle at 78% 28%, rgba(8, 2, 12, 0.7), transparent 60%),
    radial-gradient(circle at 48% 76%, rgba(5, 1, 8, 0.65), transparent 58%);
  transform: scale(calc(1.015 + var(--tar-overlay-strength) * 0.08));
  filter: contrast(calc(0.8 + var(--tar-overlay-strength) * 0.4))
    brightness(calc(0.72 + var(--tar-overlay-strength) * 0.18));
  transition: opacity 0.45s ease, transform 0.6s ease, filter 0.6s ease;
}

.tar-overlay::before,
.tar-overlay::after {
  content: '';
  position: absolute;
  inset: -12%;
  background-repeat: no-repeat;
  mix-blend-mode: multiply;
  opacity: calc(0.18 + var(--tar-overlay-strength) * 0.6);
  filter: blur(calc(14px + var(--tar-overlay-strength) * 18px));
  transition: opacity 0.45s ease;
}

.tar-overlay::before {
  background-image:
    radial-gradient(ellipse at 32% 38%, rgba(22, 10, 24, 0.85) 0%, rgba(8, 3, 12, 0) 62%),
    radial-gradient(ellipse at 68% 62%, rgba(16, 7, 18, 0.75) 0%, rgba(5, 2, 9, 0) 60%);
  animation: tar-overlay-pulse 12s ease-in-out infinite;
}

.tar-overlay::after {
  background-image:
    radial-gradient(ellipse at 44% 28%, rgba(10, 4, 16, 0.7) 0%, rgba(3, 1, 6, 0) 64%),
    radial-gradient(ellipse at 58% 74%, rgba(14, 5, 18, 0.82) 0%, rgba(4, 1, 6, 0) 66%);
  animation: tar-overlay-drift 16s linear infinite;
}

.tar-overlay[data-active='true'] {
  opacity: calc(0.22 + var(--tar-overlay-strength) * 0.78);
}

@keyframes tar-overlay-pulse {
  0% {
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% {
    transform: translate3d(-2.5%, 3%, 0) scale(1.05);
  }
  100% {
    transform: translate3d(0, 0, 0) scale(1);
  }
}

@keyframes tar-overlay-drift {
  0% {
    transform: translate3d(0, 0, 0) scale(1.04) rotate(0deg);
  }
  50% {
    transform: translate3d(2.5%, -2.5%, 0) scale(1.08) rotate(2deg);
  }
  100% {
    transform: translate3d(0, 0, 0) scale(1.04) rotate(0deg);
  }
}

.dimension-transition {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 30;
  opacity: 1;
  visibility: hidden;
  --build: 0;
  --fade: 0;
}

.dimension-transition::before,
.dimension-transition::after {
  content: '';
  position: absolute;
  inset: 0;
  opacity: 0;
}

.dimension-transition::before {
  background: radial-gradient(circle at 50% 42%, var(--dimension-glow, rgba(73, 242, 255, 0.4)), transparent 60%);
  mix-blend-mode: screen;
  filter: blur(0px);
  transform: scale(1);
}

.dimension-transition::after {
  background: radial-gradient(circle at 50% 40%, rgba(6, 12, 24, 0.35), rgba(2, 5, 12, 0.95));
}

.dimension-transition[data-active='true'] {
  visibility: visible;
}

.dimension-transition[data-active='true']::before {
  opacity: calc(0.05 + 0.95 * var(--build));
  filter: blur(calc(40px * (0.2 + var(--build))));
  transform: scale(calc(1 + var(--build) * 0.12));
  transition: opacity 0.4s ease, filter 0.4s ease, transform 0.4s ease;
}

.dimension-transition[data-active='true']::after {
  opacity: var(--fade);
  transition: opacity 0.45s ease;
}

.defeat-overlay {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.45s ease;
  z-index: 40;
}

.defeat-overlay::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(160deg, rgba(3, 8, 18, 0.9), rgba(16, 35, 60, 0.65));
  opacity: 0;
  transition: opacity 0.45s ease;
}

.defeat-overlay[data-visible='true'] {
  opacity: 1;
  pointer-events: auto;
}

.defeat-overlay[data-visible='true']::before {
  opacity: 0.9;
}

.defeat-overlay__content {
  position: relative;
  z-index: 1;
  padding: 2rem 2.4rem;
  border-radius: 20px;
  background: linear-gradient(160deg, rgba(6, 14, 30, 0.96), rgba(6, 14, 30, 0.82));
  border: 1px solid rgba(73, 242, 255, 0.25);
  box-shadow: 0 26px 60px rgba(0, 0, 0, 0.6);
  transform: translateY(26px) scale(0.96);
  transition: transform 0.45s ease, opacity 0.45s ease;
  display: grid;
  gap: 0.85rem;
  text-align: center;
  max-width: min(92%, 420px);
}

.defeat-overlay[data-visible='true'] .defeat-overlay__content {
  transform: translateY(0) scale(1);
}

.defeat-overlay__message {
  font-size: 1rem;
  color: var(--text-secondary);
  line-height: 1.6;
}

.defeat-overlay__inventory {
  background: rgba(12, 22, 42, 0.75);
  border: 1px solid rgba(73, 242, 255, 0.18);
  border-radius: 16px;
  padding: 0.85rem 1.25rem;
  max-height: 200px;
  overflow: auto;
}

.defeat-overlay__inventory-label {
  margin: 0 0 0.45rem;
  font-size: 0.75rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--text-secondary);
}

.defeat-overlay__inventory[data-empty='true'] {
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
  font-size: 0.85rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.defeat-overlay__inventory-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 0.45rem;
}

.defeat-overlay__inventory-item {
  display: flex;
  justify-content: space-between;
  gap: 0.75rem;
  font-size: 0.9rem;
  color: var(--text-primary);
}

.defeat-overlay__inventory-item span:last-child {
  color: var(--accent);
  font-weight: 600;
}

.defeat-overlay__countdown {
  font-weight: 700;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--accent-strong);
}

.defeat-overlay__actions {
  display: flex;
  justify-content: center;
  margin-top: 0.35rem;
}

.defeat-overlay__respawn-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.45rem;
  padding: 0.75rem 1.8rem;
  border-radius: 999px;
  border: none;
  font-family: inherit;
  font-size: 0.95rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--bg-primary);
  background: linear-gradient(120deg, var(--accent), var(--accent-strong));
  cursor: pointer;
  box-shadow: 0 14px 32px rgba(73, 242, 255, 0.28);
  transition: transform 0.25s ease, box-shadow 0.25s ease, opacity 0.2s ease;
}

.defeat-overlay__respawn-button:hover,
.defeat-overlay__respawn-button:focus-visible {
  transform: translateY(-1px);
  box-shadow: 0 18px 40px rgba(73, 242, 255, 0.34);
}

.defeat-overlay__respawn-button:focus-visible {
  outline: 2px solid rgba(255, 255, 255, 0.55);
  outline-offset: 3px;
}

.defeat-overlay__respawn-button:disabled {
  cursor: default;
  opacity: 0.65;
  box-shadow: none;
}

@media (max-width: 1180px) {
  .main-layout {
    grid-template-columns: 1fr;
    gap: clamp(1rem, 3vw, 1.5rem);
  }

  .objectives-panel {
    position: relative;
    top: auto;
    max-height: none;
    overflow: visible;
  }

  #gameHud .hud-card {
    min-width: clamp(200px, 60vw, 320px);
  }
}

@media (max-width: 860px) {
  :root {
    font-size: 15px;
  }

  .manu-logo {
    inset: auto clamp(10px, 4vw, 18px) clamp(10px, 4vw, 18px) auto;
    gap: 0.4rem;
    padding: 0.25rem 0.4rem;
  }

  .manu-logo__glyph {
    width: clamp(36px, 12vw, 54px);
  }

  .manu-logo__label {
    display: none;
  }

  .main-layout {
    grid-template-columns: 1fr;
    padding: clamp(0.75rem, 5vw, 1.5rem);
    gap: clamp(0.85rem, 4vw, 1.35rem);
  }

  .settings-toggle {
    padding-inline: 0.75rem;
  }

  .settings-toggle__label {
    display: none;
  }

  .objectives-panel {
    order: -1;
    padding: clamp(1rem, 4vw, 1.5rem);
    border-radius: 22px;
  }

  .primary-panel {
    border-radius: 20px;
  }

  .hud-layer__corner--top-left {
    left: clamp(0.75rem, 4vw, 1.1rem);
    top: clamp(0.75rem, 4vw, 1.1rem);
  }

  .hud-layer__corner--top-right {
    right: clamp(0.75rem, 4vw, 1.1rem);
    top: clamp(0.75rem, 4vw, 1.1rem);
    align-items: stretch;
  }

  #gameHud .score-overlay {
    width: min(90vw, 320px);
    margin: 0 0 clamp(0.55rem, 2vw, 0.85rem) auto;
  }

  .hud-card {
    min-width: min(85vw, 320px);
  }

  .hud-card--actions {
    text-align: left;
    align-items: flex-start;
  }

  .hud-actions {
    justify-content: flex-start;
    width: 100%;
  }

  .hud-actions .ghost {
    flex: 1 1 calc(50% - 0.4rem);
    justify-content: center;
  }

  #gameHud .leaderboard-toggle {
    flex: 1 1 100%;
    justify-content: center;
  }

  #gameHud .user-identity {
    text-align: left;
  }

  .hud-layer__bottom {
    bottom: clamp(0.85rem, 4vw, 1.25rem);
  }

  .portal-progress {
    width: min(94%, 520px);
  }

  .player-hint {
    font-size: 0.92rem;
  }

  .side-panel {
    left: 0;
    right: 0;
    bottom: 0;
    top: auto;
    transform: translateY(calc(100% + 2rem));
    max-height: min(80vh, 720px);
    border-radius: 28px 28px 0 0;
    padding: 1.75rem clamp(1rem, 8vw, 2.25rem) calc(2.75rem + env(safe-area-inset-bottom, 0px));
    box-shadow: 0 -18px 40px rgba(0, 0, 0, 0.45);
    backdrop-filter: blur(12px);
    z-index: 30;
  }

  .side-panel.open {
    transform: translateY(0);
  }

  .side-panel section {
    margin: 0 auto;
    max-width: 640px;
  }

  .side-panel-close {
    display: inline-flex;
    margin-left: auto;
  }

  .player-panel__header {
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .footer {
    flex-direction: column;
    gap: 1rem;
  }

  .footer .controls {
    flex-direction: column;
    gap: 1rem;
  }

  .mobile-controls {
    display: flex;
    bottom: calc(1rem + env(safe-area-inset-bottom, 0px));
  }

  .victory-banner {
    position: static;
    margin: 0 0 1rem;
    text-align: left;
  }
}

@media (max-width: 640px) {
  :root {
    font-size: 14px;
  }

  .manu-logo {
    inset: auto clamp(12px, 5vw, 20px) calc(12px + env(safe-area-inset-bottom, 0px)) auto;
    padding: 0.2rem 0.35rem;
    border-radius: 12px;
  }

  .manu-logo__glyph {
    width: clamp(32px, 14vw, 48px);
  }

  .main-layout {
    padding: 1rem;
  }

  #gameHud .score-overlay {
    width: min(94vw, 320px);
    margin: 0 auto clamp(0.55rem, 5vw, 0.85rem);
    padding: 0.75rem 0.9rem;
  }

  #gameHud .score-overlay__value {
    font-size: clamp(1.4rem, 6vw, 1.8rem);
  }

  .hud-card {
    min-width: min(90vw, 320px);
  }

  .hud-actions .ghost {
    flex-basis: 100%;
  }

  #gameHud .leaderboard-toggle {
    width: 100%;
  }

  .leaderboard-table {
    min-width: 560px;
  }

  .leaderboard-modal__content {
    padding: 1.5rem;
  }

  .footer {
    padding: 1.25rem 1rem 1.75rem;
  }
}

.dimension-intro {
  position: absolute;
  top: clamp(1.8rem, 4vw, 3rem);
  left: 50%;
  transform: translate3d(-50%, -28px, 0);
  padding: 1.2rem 1.8rem;
  border-radius: 18px;
  background: linear-gradient(160deg, rgba(10, 12, 26, 0.82), rgba(14, 18, 36, 0.78));
  color: #f4f7ff;
  text-align: center;
  max-width: min(92vw, 30rem);
  box-shadow: 0 26px 48px rgba(0, 0, 0, 0.45), 0 0 22px rgba(84, 140, 255, 0.28);
  backdrop-filter: blur(12px);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease, transform 0.4s ease;
  z-index: 34;
}

.dimension-intro.active {
  opacity: 1;
  transform: translate3d(-50%, 0, 0);
}

.dimension-intro[data-intent='preview'] {
  background: linear-gradient(170deg, rgba(6, 22, 34, 0.9), rgba(12, 40, 58, 0.82));
  box-shadow: 0 24px 46px rgba(0, 16, 28, 0.55), 0 0 26px rgba(0, 206, 255, 0.35);
}

.dimension-intro[data-intent='preview'] .dimension-intro__name {
  color: #9fe2ff;
}

.dimension-intro[data-intent='preview'] .dimension-intro__rules {
  color: rgba(202, 244, 255, 0.88);
}

.dimension-intro__name {
  margin: 0 0 0.35rem;
  font-size: clamp(1.25rem, 3.4vw, 1.6rem);
  letter-spacing: 0.18em;
  text-transform: uppercase;
}

.dimension-intro__rules {
  margin: 0;
  font-size: clamp(0.95rem, 2.6vw, 1.05rem);
  line-height: 1.5;
  color: rgba(232, 239, 255, 0.82);
}

@media (prefers-reduced-motion: reduce) {
  .dimension-intro {
    transition: none;
  }
}

@media (min-width: 861px) {
  .side-panel__scrim {
    display: none;
  }
}

.crosshair {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 28px;
  height: 28px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.18s ease;
  z-index: 35;
  filter: drop-shadow(0 0 3px rgba(8, 12, 6, 0.7));
}

.crosshair__horizontal,
.crosshair__vertical {
  position: absolute;
  background: rgba(255, 255, 255, 0.92);
  box-shadow: 0 0 0 1px rgba(18, 26, 16, 0.65);
}

.crosshair__horizontal {
  top: 50%;
  left: 0;
  width: 100%;
  height: 2px;
  transform: translateY(-50%);
}

.crosshair__vertical {
  left: 50%;
  top: 0;
  width: 2px;
  height: 100%;
  transform: translateX(-50%);
}

body.game-active .crosshair {
  opacity: 0.9;
}

.pointer-hint {
  position: absolute;
  top: 1.5rem;
  left: 50%;
  transform: translate(-50%, -10px);
  padding: 0.55rem 1.2rem;
  border-radius: 999px;
  font-size: 0.95rem;
  font-weight: 600;
  letter-spacing: 0.01em;
  color: #f8fbff;
  background: linear-gradient(145deg, rgba(15, 24, 36, 0.92), rgba(21, 35, 54, 0.88));
  box-shadow: 0 18px 42px rgba(9, 14, 24, 0.45);
  border: 1px solid rgba(120, 184, 255, 0.25);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.28s ease, transform 0.28s ease;
  z-index: 42;
  text-align: center;
  max-width: min(420px, 90vw);
  backdrop-filter: blur(6px);
}

.pointer-hint.is-visible {
  opacity: 1;
  transform: translate(-50%, 0);
}

body:not(.game-active) .pointer-hint {
  display: none;
}

body.game-active #gameCanvas {
  cursor: none !important;
}

.hand-overlay {
  position: absolute;
  right: clamp(1.8rem, 6vw, 3.5rem);
  bottom: clamp(1.5rem, 6vw, 3rem);
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: 0.65rem;
  pointer-events: none;
  opacity: 0;
  transform: translateY(12px);
  transition: opacity 0.25s ease, transform 0.25s ease;
  z-index: 40;
}

body.game-active .hand-overlay {
  opacity: 1;
  transform: translateY(0);
}

.hand-overlay__icon {
  position: relative;
  width: clamp(54px, 10vw, 72px);
  height: clamp(54px, 10vw, 72px);
  border-radius: 22px;
  background: linear-gradient(135deg, #f4c999, #c58e64);
  box-shadow: 0 18px 35px rgba(0, 0, 0, 0.45), 0 0 25px rgba(255, 255, 255, 0.15);
  transform: rotate(-6deg);
}

.hand-overlay__icon::before,
.hand-overlay__icon::after {
  content: '';
  position: absolute;
  background: rgba(0, 0, 0, 0.18);
  border-radius: 12px;
}

.hand-overlay__icon::before {
  inset: 18% 22% 52% 22%;
  border-radius: 18px 18px 8px 8px;
}

.hand-overlay__icon::after {
  width: 32%;
  height: 36%;
  right: 18%;
  bottom: 16%;
  border-radius: 12px 12px 18px 18px;
}

.hand-overlay[data-item='torch'] .hand-overlay__icon {
  background: linear-gradient(135deg, #ffcf6d, #ff6d1f);
  box-shadow: 0 18px 30px rgba(255, 109, 31, 0.32), 0 0 25px rgba(255, 203, 109, 0.35);
}

.hand-overlay[data-item='stone'] .hand-overlay__icon,
.hand-overlay[data-item='rock'] .hand-overlay__icon {
  background: linear-gradient(135deg, #7b8796, #3f4a57);
}

.hand-overlay[data-item='wood'] .hand-overlay__icon,
.hand-overlay[data-item='stick'] .hand-overlay__icon {
  background: linear-gradient(135deg, #d6a46a, #8b5a2b);
}

.hand-overlay[data-item='eternal-ingot'] .hand-overlay__icon {
  background: linear-gradient(135deg, #ffd27f, #ff9249);
  box-shadow: 0 18px 36px rgba(255, 146, 73, 0.32), 0 0 30px rgba(255, 210, 127, 0.35);
}

.hand-overlay__label {
  font-size: clamp(0.75rem, 1.6vw, 0.9rem);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.85);
  text-shadow: 0 0 8px rgba(0, 0, 0, 0.5);
}

.made-by-manu {
  position: fixed;
  inset: auto 0 0;
  z-index: 40;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.9rem clamp(1.2rem, 4vw, 2.5rem);
  background: linear-gradient(90deg, rgba(20, 30, 40, 0.92), rgba(10, 15, 25, 0.88));
  border-top: 1px solid rgba(255, 255, 255, 0.06);
  box-shadow: 0 -14px 24px rgba(0, 0, 0, 0.45);
  color: rgba(255, 255, 255, 0.86);
  font-family: 'Chakra Petch', 'Exo 2', system-ui, sans-serif;
  font-size: clamp(0.8rem, 1.4vw, 0.95rem);
  letter-spacing: 0.05em;
  backdrop-filter: blur(6px);
}

.made-by-manu__label {
  font-weight: 700;
  text-transform: uppercase;
  font-size: clamp(0.75rem, 1.2vw, 0.9rem);
  color: rgba(173, 216, 255, 0.9);
  text-shadow: 0 0 8px rgba(0, 153, 255, 0.4);
}

.made-by-manu__summary {
  display: inline-flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.35rem 0.6rem;
}

.made-by-manu__metric {
  font-weight: 600;
  color: #ffffff;
}

.made-by-manu__status {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  padding-left: 0.65rem;
  border-left: 1px solid rgba(255, 255, 255, 0.1);
  font-size: clamp(0.75rem, 1.3vw, 0.9rem);
  color: rgba(200, 230, 255, 0.85);
}

.made-by-manu[data-state='victory'] {
  background: linear-gradient(90deg, rgba(49, 20, 12, 0.95), rgba(128, 36, 20, 0.92));
  border-top-color: rgba(255, 176, 0, 0.35);
  box-shadow: 0 -16px 32px rgba(128, 36, 20, 0.45);
}

.made-by-manu[data-state='victory'] .made-by-manu__label {
  color: rgba(255, 200, 120, 0.95);
  text-shadow: 0 0 12px rgba(255, 160, 60, 0.55);
}

.made-by-manu[data-state='victory'] .made-by-manu__status {
  color: rgba(255, 230, 204, 0.9);
}

.made-by-manu[data-state='ready'] .made-by-manu__status {
  color: rgba(144, 238, 144, 0.9);
}

.made-by-manu[data-state='transition'] .made-by-manu__status {
  color: rgba(255, 214, 153, 0.92);
}

.made-by-manu[data-state='explore'] .made-by-manu__status {
  color: rgba(200, 230, 255, 0.85);
}

@media (max-width: 900px) {
  .made-by-manu {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.4rem;
    font-size: clamp(0.78rem, 2.6vw, 0.9rem);
  }

  .made-by-manu__status {
    border-left: none;
    padding-left: 0;
  }
}

@media (max-width: 720px) {
  .hand-overlay {
    right: clamp(1rem, 5vw, 1.8rem);
    bottom: clamp(1rem, 5vw, 2rem);
  }

  .hand-overlay__icon {
    transform: rotate(-4deg) scale(0.88);
  }
}
